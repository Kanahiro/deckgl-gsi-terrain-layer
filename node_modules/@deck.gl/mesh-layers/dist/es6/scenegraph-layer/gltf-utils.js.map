{"version":3,"sources":["../../../src/scenegraph-layer/gltf-utils.js"],"names":["waitForGLTFAssets","gltfObjects","remaining","scenes","forEach","scene","traverse","model","Object","values","getUniforms","uniform","loaded","push","waitWhileCondition","some","condition","Promise","resolve","requestAnimationFrame"],"mappings":"AAEA,OAAO,eAAeA,iBAAf,CAAiCC,WAAjC,EAA8C;AACnD,QAAMC,SAAS,GAAG,EAAlB;AAEAD,EAAAA,WAAW,CAACE,MAAZ,CAAmBC,OAAnB,CAA2BC,KAAK,IAAI;AAClCA,IAAAA,KAAK,CAACC,QAAN,CAAeC,KAAK,IAAI;AACtBC,MAAAA,MAAM,CAACC,MAAP,CAAcF,KAAK,CAACA,KAAN,CAAYG,WAAZ,EAAd,EAAyCN,OAAzC,CAAiDO,OAAO,IAAI;AAC1D,YAAIA,OAAO,CAACC,MAAR,KAAmB,KAAvB,EAA8B;AAC5BV,UAAAA,SAAS,CAACW,IAAV,CAAeF,OAAf;AACD;AACF,OAJD;AAKD,KAND;AAOD,GARD;AAUA,SAAO,MAAMG,kBAAkB,CAAC,MAAMZ,SAAS,CAACa,IAAV,CAAeJ,OAAO,IAAI,CAACA,OAAO,CAACC,MAAnC,CAAP,CAA/B;AACD;;AAED,eAAeE,kBAAf,CAAkCE,SAAlC,EAA6C;AAC3C,SAAOA,SAAS,EAAhB,EAAoB;AAClB,UAAM,IAAIC,OAAJ,CAAYC,OAAO,IAAIC,qBAAqB,CAACD,OAAD,CAA5C,CAAN;AACD;AACF","sourcesContent":["/* global requestAnimationFrame */\n\nexport async function waitForGLTFAssets(gltfObjects) {\n  const remaining = [];\n\n  gltfObjects.scenes.forEach(scene => {\n    scene.traverse(model => {\n      Object.values(model.model.getUniforms()).forEach(uniform => {\n        if (uniform.loaded === false) {\n          remaining.push(uniform);\n        }\n      });\n    });\n  });\n\n  return await waitWhileCondition(() => remaining.some(uniform => !uniform.loaded));\n}\n\nasync function waitWhileCondition(condition) {\n  while (condition()) {\n    await new Promise(resolve => requestAnimationFrame(resolve));\n  }\n}\n"],"file":"gltf-utils.js"}