{"version":3,"sources":["../../../../src/effects/lighting/point-light.js"],"names":["projectPosition","COORDINATE_SYSTEM","DEFAULT_LIGHT_COLOR","DEFAULT_LIGHT_INTENSITY","DEFAULT_ATTENUATION","DEFAULT_LIGHT_POSITION","idCount","PointLight","constructor","props","color","intensity","position","id","type","attenuation","getAttenuation","projectedLight","Object","assign","getProjectedLight","layer","viewport","context","coordinateSystem","coordinateOrigin","fromCoordinateSystem","isGeospatial","LNGLAT","CARTESIAN","fromCoordinateOrigin"],"mappings":"AAAA,SAAQA,eAAR,QAA8B,2CAA9B;AACA,SAAQC,iBAAR,QAAgC,WAAhC;AAEA,MAAMC,mBAAmB,GAAG,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,CAA5B;AACA,MAAMC,uBAAuB,GAAG,GAAhC;AACA,MAAMC,mBAAmB,GAAG,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,CAA5B;AACA,MAAMC,sBAAsB,GAAG,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,CAA/B;AAEA,IAAIC,OAAO,GAAG,CAAd;AAEA,OAAO,MAAMC,UAAN,CAAiB;AACtBC,EAAAA,WAAW,CAACC,KAAK,GAAG,EAAT,EAAa;AACtB,UAAM;AAACC,MAAAA,KAAK,GAAGR;AAAT,QAAgCO,KAAtC;AACA,UAAM;AAACE,MAAAA,SAAS,GAAGR;AAAb,QAAwCM,KAA9C;AACA,UAAM;AAACG,MAAAA,QAAQ,GAAGP;AAAZ,QAAsCI,KAA5C;AAEA,SAAKI,EAAL,GAAUJ,KAAK,CAACI,EAAN,oBAAqBP,OAAO,EAA5B,CAAV;AACA,SAAKI,KAAL,GAAaA,KAAb;AACA,SAAKC,SAAL,GAAiBA,SAAjB;AACA,SAAKG,IAAL,GAAY,OAAZ;AACA,SAAKF,QAAL,GAAgBA,QAAhB;AACA,SAAKG,WAAL,GAAmBC,cAAc,CAACP,KAAD,CAAjC;AACA,SAAKQ,cAAL,GAAsBC,MAAM,CAACC,MAAP,CAAc,EAAd,EAAkB,IAAlB,CAAtB;AACD;;AAEDC,EAAAA,iBAAiB,CAAC;AAACC,IAAAA;AAAD,GAAD,EAAU;AACzB,UAAM;AAACJ,MAAAA;AAAD,QAAmB,IAAzB;AACA,UAAMK,QAAQ,GAAGD,KAAK,CAACE,OAAN,CAAcD,QAA/B;AACA,UAAM;AAACE,MAAAA,gBAAD;AAAmBC,MAAAA;AAAnB,QAAuCJ,KAAK,CAACZ,KAAnD;AACA,UAAMG,QAAQ,GAAGZ,eAAe,CAAC,KAAKY,QAAN,EAAgB;AAC9CU,MAAAA,QAD8C;AAE9CE,MAAAA,gBAF8C;AAG9CC,MAAAA,gBAH8C;AAI9CC,MAAAA,oBAAoB,EAAEJ,QAAQ,CAACK,YAAT,GAClB1B,iBAAiB,CAAC2B,MADA,GAElB3B,iBAAiB,CAAC4B,SANwB;AAO9CC,MAAAA,oBAAoB,EAAE,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP;AAPwB,KAAhB,CAAhC;AASAb,IAAAA,cAAc,CAACP,KAAf,GAAuB,KAAKA,KAA5B;AACAO,IAAAA,cAAc,CAACN,SAAf,GAA2B,KAAKA,SAAhC;AACAM,IAAAA,cAAc,CAACL,QAAf,GAA0BA,QAA1B;AACA,WAAOK,cAAP;AACD;;AAhCqB;;AAmCxB,SAASD,cAAT,CAAwBP,KAAxB,EAA+B;AAC7B,MAAI,iBAAiBA,KAArB,EAA4B;AAC1B,WAAOA,KAAK,CAACM,WAAb;AACD;;AACD,MAAI,eAAeN,KAAnB,EAA0B;AACxB,WAAO,CAAC,CAAD,EAAI,CAAJ,EAAOA,KAAK,CAACE,SAAb,CAAP;AACD;;AACD,SAAOP,mBAAP;AACD","sourcesContent":["import {projectPosition} from '../../shaderlib/project/project-functions';\nimport {COORDINATE_SYSTEM} from '../../lib';\n\nconst DEFAULT_LIGHT_COLOR = [255, 255, 255];\nconst DEFAULT_LIGHT_INTENSITY = 1.0;\nconst DEFAULT_ATTENUATION = [0, 0, 1];\nconst DEFAULT_LIGHT_POSITION = [0.0, 0.0, 1.0];\n\nlet idCount = 0;\n\nexport class PointLight {\n  constructor(props = {}) {\n    const {color = DEFAULT_LIGHT_COLOR} = props;\n    const {intensity = DEFAULT_LIGHT_INTENSITY} = props;\n    const {position = DEFAULT_LIGHT_POSITION} = props;\n\n    this.id = props.id || `point-${idCount++}`;\n    this.color = color;\n    this.intensity = intensity;\n    this.type = 'point';\n    this.position = position;\n    this.attenuation = getAttenuation(props);\n    this.projectedLight = Object.assign({}, this);\n  }\n\n  getProjectedLight({layer}) {\n    const {projectedLight} = this;\n    const viewport = layer.context.viewport;\n    const {coordinateSystem, coordinateOrigin} = layer.props;\n    const position = projectPosition(this.position, {\n      viewport,\n      coordinateSystem,\n      coordinateOrigin,\n      fromCoordinateSystem: viewport.isGeospatial\n        ? COORDINATE_SYSTEM.LNGLAT\n        : COORDINATE_SYSTEM.CARTESIAN,\n      fromCoordinateOrigin: [0, 0, 0]\n    });\n    projectedLight.color = this.color;\n    projectedLight.intensity = this.intensity;\n    projectedLight.position = position;\n    return projectedLight;\n  }\n}\n\nfunction getAttenuation(props) {\n  if ('attenuation' in props) {\n    return props.attenuation;\n  }\n  if ('intensity' in props) {\n    return [0, 0, props.intensity];\n  }\n  return DEFAULT_ATTENUATION;\n}\n"],"file":"point-light.js"}