{"version":3,"sources":["../../../src/features/limits.js"],"names":["getContextLimits","gl","luma","limits","webgl1MinLimits","webgl2MinLimits","isWebgl2","parameter","WEBGL_LIMITS","limit","webgl1MinLimit","gl1","webgl2MinLimit","gl2","minLimit","limitNotAvailable","getExtension","extension","value","getParameter","getGLContextInfo","info","vendor","renderer","vendorMasked","rendererMasked","version","shadingLanguageVersion","getContextInfo","Object","assign"],"mappings":";;;;;;;;;;;;;AAEA;;AACA;;AAEO,SAASA,gBAAT,CAA0BC,EAA1B,EAA8B;AACnCA,EAAAA,EAAE,CAACC,IAAH,GAAUD,EAAE,CAACC,IAAH,IAAW,EAArB;;AAEA,MAAI,CAACD,EAAE,CAACC,IAAH,CAAQC,MAAb,EAAqB;AACnBF,IAAAA,EAAE,CAACC,IAAH,CAAQC,MAAR,GAAiB,EAAjB;AACAF,IAAAA,EAAE,CAACC,IAAH,CAAQE,eAAR,GAA0B,EAA1B;AACAH,IAAAA,EAAE,CAACC,IAAH,CAAQG,eAAR,GAA0B,EAA1B;AAEA,QAAMC,QAAQ,GAAG,uBAASL,EAAT,CAAjB;;AAGA,SAAK,IAAMM,SAAX,IAAwBC,4BAAxB,EAAsC;AACpC,UAAMC,KAAK,GAAGD,6BAAaD,SAAb,CAAd;AAEA,UAAMG,cAAc,GAAGD,KAAK,CAACE,GAA7B;AACA,UAAMC,cAAc,GAAG,SAASH,KAAT,GAAiBA,KAAK,CAACI,GAAvB,GAA6BJ,KAAK,CAACE,GAA1D;AACA,UAAMG,QAAQ,GAAGR,QAAQ,GAAGM,cAAH,GAAoBF,cAA7C;AAGA,UAAMK,iBAAiB,GACpB,SAASN,KAAT,IAAkB,CAACH,QAApB,IAEC,eAAeG,KAAf,IAAwB,CAACR,EAAE,CAACe,YAAH,CAAgBP,KAAK,CAACQ,SAAtB,CAH5B;AAKA,UAAMC,KAAK,GAAGH,iBAAiB,GAAGD,QAAH,GAAcb,EAAE,CAACkB,YAAH,CAAgBZ,SAAhB,CAA7C;AACAN,MAAAA,EAAE,CAACC,IAAH,CAAQC,MAAR,CAAeI,SAAf,IAA4BW,KAA5B;AACAjB,MAAAA,EAAE,CAACC,IAAH,CAAQE,eAAR,CAAwBG,SAAxB,IAAqCG,cAArC;AACAT,MAAAA,EAAE,CAACC,IAAH,CAAQG,eAAR,CAAwBE,SAAxB,IAAqCK,cAArC;AACD;AACF;;AAED,SAAOX,EAAE,CAACC,IAAH,CAAQC,MAAf;AACD;;AAEM,SAASiB,gBAAT,CAA0BnB,EAA1B,EAA8B;AACnCA,EAAAA,EAAE,CAACC,IAAH,GAAUD,EAAE,CAACC,IAAH,IAAW,EAArB;AAEA,MAAMmB,IAAI,GAAG,kCAAoBpB,EAApB,CAAb;;AACA,MAAI,CAACA,EAAE,CAACC,IAAH,CAAQmB,IAAb,EAAmB;AAAA;;AACjBpB,IAAAA,EAAE,CAACC,IAAH,CAAQmB,IAAR,+EAC8BA,IAAI,CAACC,MADnC,0DAEgCD,IAAI,CAACE,QAFrC,yDAGeF,IAAI,CAACG,YAHpB,yDAIiBH,IAAI,CAACI,cAJtB,yDAKgBJ,IAAI,CAACK,OALrB,0DAMiCL,IAAI,CAACM,sBANtC;AAQD;;AAED,SAAO1B,EAAE,CAACC,IAAH,CAAQmB,IAAf;AACD;;AAEM,SAASO,cAAT,CAAwB3B,EAAxB,EAA4B;AACjC,SAAO4B,MAAM,CAACC,MAAP,CAAc,kCAAoB7B,EAApB,CAAd,EAAuC;AAC5CE,IAAAA,MAAM,EAAEH,gBAAgB,CAACC,EAAD,CADoB;AAE5CoB,IAAAA,IAAI,EAAED,gBAAgB,CAACnB,EAAD,CAFsB;AAG5CG,IAAAA,eAAe,EAAEH,EAAE,CAACC,IAAH,CAAQE,eAHmB;AAI5CC,IAAAA,eAAe,EAAEJ,EAAE,CAACC,IAAH,CAAQG;AAJmB,GAAvC,CAAP;AAMD","sourcesContent":["import GL from '@luma.gl/constants';\n\nimport WEBGL_LIMITS from './webgl-limits-table';\nimport {isWebGL2, getContextDebugInfo} from '@luma.gl/gltools';\n\nexport function getContextLimits(gl) {\n  gl.luma = gl.luma || {};\n\n  if (!gl.luma.limits) {\n    gl.luma.limits = {};\n    gl.luma.webgl1MinLimits = {};\n    gl.luma.webgl2MinLimits = {};\n\n    const isWebgl2 = isWebGL2(gl);\n\n    // WEBGL limits\n    for (const parameter in WEBGL_LIMITS) {\n      const limit = WEBGL_LIMITS[parameter];\n\n      const webgl1MinLimit = limit.gl1;\n      const webgl2MinLimit = 'gl2' in limit ? limit.gl2 : limit.gl1;\n      const minLimit = isWebgl2 ? webgl2MinLimit : webgl1MinLimit;\n\n      // Check if we can query for this limit\n      const limitNotAvailable =\n        ('gl2' in limit && !isWebgl2) ||\n        // @ts-ignore\n        ('extension' in limit && !gl.getExtension(limit.extension));\n\n      const value = limitNotAvailable ? minLimit : gl.getParameter(parameter);\n      gl.luma.limits[parameter] = value;\n      gl.luma.webgl1MinLimits[parameter] = webgl1MinLimit;\n      gl.luma.webgl2MinLimits[parameter] = webgl2MinLimit;\n    }\n  }\n\n  return gl.luma.limits;\n}\n\nexport function getGLContextInfo(gl) {\n  gl.luma = gl.luma || {};\n\n  const info = getContextDebugInfo(gl);\n  if (!gl.luma.info) {\n    gl.luma.info = {\n      [GL.UNMASKED_VENDOR_WEBGL]: info.vendor,\n      [GL.UNMASKED_RENDERER_WEBGL]: info.renderer,\n      [GL.VENDOR]: info.vendorMasked,\n      [GL.RENDERER]: info.rendererMasked,\n      [GL.VERSION]: info.version,\n      [GL.SHADING_LANGUAGE_VERSION]: info.shadingLanguageVersion\n    };\n  }\n\n  return gl.luma.info;\n}\n\nexport function getContextInfo(gl) {\n  return Object.assign(getContextDebugInfo(gl), {\n    limits: getContextLimits(gl),\n    info: getGLContextInfo(gl),\n    webgl1MinLimits: gl.luma.webgl1MinLimits,\n    webgl2MinLimits: gl.luma.webgl2MinLimits\n  });\n}\n"],"file":"limits.js"}