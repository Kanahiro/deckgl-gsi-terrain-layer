{"version":3,"sources":["../../../../src/modules/blur-filters/triangleblur.js"],"names":["random","fs","uniforms","radius","value","min","softMax","delta","private","name","dependencies","passes","sampler"],"mappings":"AAOA,OAAOA,MAAP,MAAmB,iBAAnB;AAEA,MAAMC,EAAE,uqBAAR;AAkCA,MAAMC,QAAQ,GAAG;AACfC,EAAAA,MAAM,EAAE;AAACC,IAAAA,KAAK,EAAE,EAAR;AAAYC,IAAAA,GAAG,EAAE,CAAjB;AAAoBC,IAAAA,OAAO,EAAE;AAA7B,GADO;AAEfC,EAAAA,KAAK,EAAE;AAACH,IAAAA,KAAK,EAAE,CAAC,CAAD,EAAI,CAAJ,CAAR;AAAgBI,IAAAA,OAAO,EAAE;AAAzB;AAFQ,CAAjB;AAKA,eAAe;AACbC,EAAAA,IAAI,EAAE,cADO;AAEbP,EAAAA,QAFa;AAGbD,EAAAA,EAHa;AAIbS,EAAAA,YAAY,EAAE,CAACV,MAAD,CAJD;AAKbW,EAAAA,MAAM,EAAE,CAAC;AAACC,IAAAA,OAAO,EAAE,IAAV;AAAgBV,IAAAA,QAAQ,EAAE;AAACK,MAAAA,KAAK,EAAE,CAAC,CAAD,EAAI,CAAJ;AAAR;AAA1B,GAAD,EAA6C;AAACK,IAAAA,OAAO,EAAE,IAAV;AAAgBV,IAAAA,QAAQ,EAAE;AAACK,MAAAA,KAAK,EAAE,CAAC,CAAD,EAAI,CAAJ;AAAR;AAA1B,GAA7C;AALK,CAAf","sourcesContent":["/**\n * @filter       Triangle Blur\n * @description  This is the most basic blur filter, which convolves the image with a\n *               pyramid filter. The pyramid filter is separable and is applied as two\n *               perpendicular triangle filters.\n * @param radius The radius of the pyramid convolved with the image.\n */\nimport random from '../utils/random';\n\nconst fs = `\\\nuniform float radius;\nuniform vec2 delta;\n\nvec4 triangleBlur_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {\n  vec2 adjustedDelta = delta * radius / texSize;\n\n  vec4 color = vec4(0.0);\n  float total = 0.0;\n\n  /* randomize the lookup values to hide the fixed number of samples */\n  float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);\n\n  for (float t = -30.0; t <= 30.0; t++) {\n    float percent = (t + offset - 0.5) / 30.0;\n    float weight = 1.0 - abs(percent);\n    vec4 sample = texture2D(texture, texCoord + adjustedDelta * percent);\n\n    /* switch to pre-multiplied alpha to correctly blur transparent images */\n    sample.rgb *= sample.a;\n\n    color += sample * weight;\n    total += weight;\n  }\n\n  color = color / total;\n\n  /* switch back from pre-multiplied alpha */\n  color.rgb /= color.a + 0.00001;\n\n  return color;\n}\n`;\n\nconst uniforms = {\n  radius: {value: 20, min: 0, softMax: 100},\n  delta: {value: [1, 0], private: true}\n};\n\nexport default {\n  name: 'triangleBlur',\n  uniforms,\n  fs,\n  dependencies: [random],\n  passes: [{sampler: true, uniforms: {delta: [1, 0]}}, {sampler: true, uniforms: {delta: [0, 1]}}]\n};\n"],"file":"triangleblur.js"}