{"version":3,"sources":["../../../../src/lib/gltf-utils/gltf-utils.js"],"names":["assert","TYPES","ARRAY_TO_COMPONENT_TYPE","Map","Int8Array","Uint8Array","Int16Array","Uint16Array","Uint32Array","Float32Array","ATTRIBUTE_TYPE_TO_COMPONENTS","SCALAR","VEC2","VEC3","VEC4","MAT2","MAT3","MAT4","ATTRIBUTE_COMPONENT_TYPE_TO_BYTE_SIZE","ATTRIBUTE_COMPONENT_TYPE_TO_ARRAY","getAccessorTypeFromSize","size","type","getComponentTypeFromArray","typedArray","componentType","get","constructor","Error","getAccessorArrayTypeAndLength","accessor","bufferView","ArrayType","components","bytesPerComponent","length","count","byteLength"],"mappings":"AAAA,OAAOA,MAAP,MAAmB,iBAAnB;AAEA,IAAMC,KAAK,GAAG,CAAC,QAAD,EAAW,MAAX,EAAmB,MAAnB,EAA2B,MAA3B,CAAd;AAGA,IAAMC,uBAAuB,GAAG,IAAIC,GAAJ,CAAQ,CACtC,CAACC,SAAD,EAAY,IAAZ,CADsC,EAEtC,CAACC,UAAD,EAAa,IAAb,CAFsC,EAGtC,CAACC,UAAD,EAAa,IAAb,CAHsC,EAItC,CAACC,WAAD,EAAc,IAAd,CAJsC,EAKtC,CAACC,WAAD,EAAc,IAAd,CALsC,EAMtC,CAACC,YAAD,EAAe,IAAf,CANsC,CAAR,CAAhC;AASA,OAAO,IAAMC,4BAA4B,GAAG;AAC1CC,EAAAA,MAAM,EAAE,CADkC;AAE1CC,EAAAA,IAAI,EAAE,CAFoC;AAG1CC,EAAAA,IAAI,EAAE,CAHoC;AAI1CC,EAAAA,IAAI,EAAE,CAJoC;AAK1CC,EAAAA,IAAI,EAAE,CALoC;AAM1CC,EAAAA,IAAI,EAAE,CANoC;AAO1CC,EAAAA,IAAI,EAAE;AAPoC,CAArC;AAUP,OAAO,IAAMC,qCAAqC,GAAG;AACnD,QAAM,CAD6C;AAEnD,QAAM,CAF6C;AAGnD,QAAM,CAH6C;AAInD,QAAM,CAJ6C;AAKnD,QAAM,CAL6C;AAMnD,QAAM;AAN6C,CAA9C;AASP,OAAO,IAAMC,iCAAiC,GAAG;AAC/C,QAAMf,SADyC;AAE/C,QAAMC,UAFyC;AAG/C,QAAMC,UAHyC;AAI/C,QAAMC,WAJyC;AAK/C,QAAMC,WALyC;AAM/C,QAAMC;AANyC,CAA1C;AASP,OAAO,SAASW,uBAAT,CAAiCC,IAAjC,EAAuC;AAC5C,MAAMC,IAAI,GAAGrB,KAAK,CAACoB,IAAI,GAAG,CAAR,CAAlB;AACA,SAAOC,IAAI,IAAIrB,KAAK,CAAC,CAAD,CAApB;AACD;AAED,OAAO,SAASsB,yBAAT,CAAmCC,UAAnC,EAA+C;AACpD,MAAMC,aAAa,GAAGvB,uBAAuB,CAACwB,GAAxB,CAA4BF,UAAU,CAACG,WAAvC,CAAtB;;AACA,MAAI,CAACF,aAAL,EAAoB;AAClB,UAAM,IAAIG,KAAJ,CAAU,qBAAV,CAAN;AACD;;AACD,SAAOH,aAAP;AACD;AAED,OAAO,SAASI,6BAAT,CAAuCC,QAAvC,EAAiDC,UAAjD,EAA6D;AAClE,MAAMC,SAAS,GAAGb,iCAAiC,CAACW,QAAQ,CAACL,aAAV,CAAnD;AACA,MAAMQ,UAAU,GAAGvB,4BAA4B,CAACoB,QAAQ,CAACR,IAAV,CAA/C;AACA,MAAMY,iBAAiB,GAAGhB,qCAAqC,CAACY,QAAQ,CAACL,aAAV,CAA/D;AACA,MAAMU,MAAM,GAAGL,QAAQ,CAACM,KAAT,GAAiBH,UAAhC;AACA,MAAMI,UAAU,GAAGP,QAAQ,CAACM,KAAT,GAAiBH,UAAjB,GAA8BC,iBAAjD;AACAlC,EAAAA,MAAM,CAACqC,UAAU,IAAI,CAAd,IAAmBA,UAAU,IAAIN,UAAU,CAACM,UAA7C,CAAN;AACA,SAAO;AAACL,IAAAA,SAAS,EAATA,SAAD;AAAYG,IAAAA,MAAM,EAANA,MAAZ;AAAoBE,IAAAA,UAAU,EAAVA;AAApB,GAAP;AACD","sourcesContent":["import assert from '../utils/assert';\n\nconst TYPES = ['SCALAR', 'VEC2', 'VEC3', 'VEC4'];\n\n// @ts-ignore\nconst ARRAY_TO_COMPONENT_TYPE = new Map([\n  [Int8Array, 5120],\n  [Uint8Array, 5121],\n  [Int16Array, 5122],\n  [Uint16Array, 5123],\n  [Uint32Array, 5125],\n  [Float32Array, 5126]\n]);\n\nexport const ATTRIBUTE_TYPE_TO_COMPONENTS = {\n  SCALAR: 1,\n  VEC2: 2,\n  VEC3: 3,\n  VEC4: 4,\n  MAT2: 4,\n  MAT3: 9,\n  MAT4: 16\n};\n\nexport const ATTRIBUTE_COMPONENT_TYPE_TO_BYTE_SIZE = {\n  5120: 1,\n  5121: 1,\n  5122: 2,\n  5123: 2,\n  5125: 4,\n  5126: 4\n};\n\nexport const ATTRIBUTE_COMPONENT_TYPE_TO_ARRAY = {\n  5120: Int8Array,\n  5121: Uint8Array,\n  5122: Int16Array,\n  5123: Uint16Array,\n  5125: Uint32Array,\n  5126: Float32Array\n};\n\nexport function getAccessorTypeFromSize(size) {\n  const type = TYPES[size - 1];\n  return type || TYPES[0];\n}\n\nexport function getComponentTypeFromArray(typedArray) {\n  const componentType = ARRAY_TO_COMPONENT_TYPE.get(typedArray.constructor);\n  if (!componentType) {\n    throw new Error('Illegal typed array');\n  }\n  return componentType;\n}\n\nexport function getAccessorArrayTypeAndLength(accessor, bufferView) {\n  const ArrayType = ATTRIBUTE_COMPONENT_TYPE_TO_ARRAY[accessor.componentType];\n  const components = ATTRIBUTE_TYPE_TO_COMPONENTS[accessor.type];\n  const bytesPerComponent = ATTRIBUTE_COMPONENT_TYPE_TO_BYTE_SIZE[accessor.componentType];\n  const length = accessor.count * components;\n  const byteLength = accessor.count * components * bytesPerComponent;\n  assert(byteLength >= 0 && byteLength <= bufferView.byteLength);\n  return {ArrayType, length, byteLength};\n}\n"],"file":"gltf-utils.js"}