{"version":3,"sources":["../../../src/node/read-file-sync.node.js"],"names":["fs","toArrayBuffer","DEFAULT_OPTIONS","dataType","nothrow","readFileSync","url","options","getReadFileOptions","buffer","Buffer","responseType","encoding"],"mappings":"AACA,OAAOA,EAAP,MAAe,IAAf;AACA,SAAQC,aAAR,QAA4B,0BAA5B;AAEA,MAAMC,eAAe,GAAG;AACtBC,EAAAA,QAAQ,EAAE,aADY;AAGtBC,EAAAA,OAAO,EAAE;AAHa,CAAxB;AAOA,OAAO,SAASC,YAAT,CAAsBC,GAAtB,EAA2BC,OAAO,GAAG,EAArC,EAAyC;AAC9CA,EAAAA,OAAO,GAAGC,kBAAkB,CAACD,OAAD,CAA5B;;AAOA,MAAI,CAACP,EAAD,IAAO,CAACA,EAAE,CAACK,YAAf,EAA6B;AAC3B,WAAO,IAAP;AACD;;AAED,QAAMI,MAAM,GAAGT,EAAE,CAACK,YAAH,CAAgBC,GAAhB,EAAqBC,OAArB,CAAf;AACA,SAAOE,MAAM,YAAYC,MAAlB,GAA2BT,aAAa,CAACQ,MAAD,CAAxC,GAAmDA,MAA1D;AACD;;AAID,SAASD,kBAAT,CAA4BD,OAAO,GAAG,EAAtC,EAA0C;AACxCA,EAAAA,OAAO,GAAG,EAAC,GAAGL,eAAJ;AAAqB,OAAGK;AAAxB,GAAV;;AACA,MAAIA,OAAO,CAACI,YAAR,KAAyB,MAAzB,IAAmCJ,OAAO,CAACJ,QAAR,KAAqB,MAA5D,EAAoE;AAClEI,IAAAA,OAAO,CAACK,QAAR,GAAmBL,OAAO,CAACK,QAAR,IAAoB,MAAvC;AACD;;AACD,SAAOL,OAAP;AACD","sourcesContent":["/* global Buffer */\nimport fs from 'fs';\nimport {toArrayBuffer} from '@loaders.gl/loader-utils';\n\nconst DEFAULT_OPTIONS = {\n  dataType: 'arraybuffer',\n  // TODO - this was mostly set to true to make test cases work\n  nothrow: true\n};\n\n// In a few cases (data URIs, node.js) \"files\" can be read synchronously\nexport function readFileSync(url, options = {}) {\n  options = getReadFileOptions(options);\n\n  // Only support this if we can also support sync data URL decoding in browser\n  // if (isDataURL(url)) {\n  //   return decodeDataUri(url);\n  // }\n\n  if (!fs || !fs.readFileSync) {\n    return null; // throw new Error('Cant load URI synchronously');\n  }\n\n  const buffer = fs.readFileSync(url, options);\n  return buffer instanceof Buffer ? toArrayBuffer(buffer) : buffer;\n}\n\n// HELPER FUNCTIONS\n\nfunction getReadFileOptions(options = {}) {\n  options = {...DEFAULT_OPTIONS, ...options};\n  if (options.responseType === 'text' || options.dataType === 'text') {\n    options.encoding = options.encoding || 'utf8';\n  }\n  return options;\n}\n"],"file":"read-file-sync.node.js"}