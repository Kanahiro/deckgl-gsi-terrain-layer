!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var r=e();for(var n in r)("object"==typeof exports?exports:t)[n]=r[n]}}(window,(function(){return function(t){var e={};function r(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(n,i,function(e){return t[e]}.bind(null,i));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=37)}([function(t,e,r){"use strict";r.d(e,"b",(function(){return n})),r.d(e,"a",(function(){return i})),r.d(e,"c",(function(){return s}));var n=1e-6,i="undefined"!=typeof Float32Array?Float32Array:Array,s=Math.random;Math.PI;Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)})},function(t,e,r){"use strict";r.d(e,"a",(function(){return s})),r.d(e,"b",(function(){return o})),r.d(e,"c",(function(){return u}));var n=r(6);function i(t,e){if(t.length!==e)return!1;for(var r=0;r<t.length;++r)if(!Number.isFinite(t[r]))return!1;return!0}function s(t){if(!Number.isFinite(t))throw new Error("Invalid number ".concat(t));return t}function o(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if(n.b.debug&&!i(t,e))throw new Error("math.gl: ".concat(r," some fields set to invalid numbers'"));return t}var a={};function u(t,e){a[t]||(a[t]=!0,console.warn("".concat(t," has been removed in version ").concat(e,", see upgrade guide for more information")))}},function(t,e,r){"use strict";r.d(e,"b",(function(){return i})),r.d(e,"g",(function(){return s})),r.d(e,"e",(function(){return o})),r.d(e,"h",(function(){return a})),r.d(e,"d",(function(){return u})),r.d(e,"c",(function(){return c})),r.d(e,"m",(function(){return f})),r.d(e,"l",(function(){return h})),r.d(e,"n",(function(){return l})),r.d(e,"i",(function(){return d})),r.d(e,"j",(function(){return y})),r.d(e,"k",(function(){return p})),r.d(e,"a",(function(){return b})),r.d(e,"f",(function(){return m}));var n=r(0);function i(){var t=new n.a(3);return n.a!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function s(t){var e=t[0],r=t[1],n=t[2];return Math.hypot(e,r,n)}function o(t,e,r){var i=new n.a(3);return i[0]=t,i[1]=e,i[2]=r,i}function a(t,e){var r=e[0],n=e[1],i=e[2],s=r*r+n*n+i*i;return s>0&&(s=1/Math.sqrt(s)),t[0]=e[0]*s,t[1]=e[1]*s,t[2]=e[2]*s,t}function u(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function c(t,e,r){var n=e[0],i=e[1],s=e[2],o=r[0],a=r[1],u=r[2];return t[0]=i*u-s*a,t[1]=s*o-n*u,t[2]=n*a-i*o,t}function f(t,e,r){var n=e[0],i=e[1],s=e[2],o=r[3]*n+r[7]*i+r[11]*s+r[15];return o=o||1,t[0]=(r[0]*n+r[4]*i+r[8]*s+r[12])/o,t[1]=(r[1]*n+r[5]*i+r[9]*s+r[13])/o,t[2]=(r[2]*n+r[6]*i+r[10]*s+r[14])/o,t}function h(t,e,r){var n=e[0],i=e[1],s=e[2];return t[0]=n*r[0]+i*r[3]+s*r[6],t[1]=n*r[1]+i*r[4]+s*r[7],t[2]=n*r[2]+i*r[5]+s*r[8],t}function l(t,e,r){var n=r[0],i=r[1],s=r[2],o=r[3],a=e[0],u=e[1],c=e[2],f=i*c-s*u,h=s*a-n*c,l=n*u-i*a,d=i*l-s*h,y=s*f-n*l,p=n*h-i*f,b=2*o;return f*=b,h*=b,l*=b,d*=2,y*=2,p*=2,t[0]=a+f+d,t[1]=u+h+y,t[2]=c+l+p,t}function d(t,e,r,n){var i=[],s=[];return i[0]=e[0]-r[0],i[1]=e[1]-r[1],i[2]=e[2]-r[2],s[0]=i[0],s[1]=i[1]*Math.cos(n)-i[2]*Math.sin(n),s[2]=i[1]*Math.sin(n)+i[2]*Math.cos(n),t[0]=s[0]+r[0],t[1]=s[1]+r[1],t[2]=s[2]+r[2],t}function y(t,e,r,n){var i=[],s=[];return i[0]=e[0]-r[0],i[1]=e[1]-r[1],i[2]=e[2]-r[2],s[0]=i[2]*Math.sin(n)+i[0]*Math.cos(n),s[1]=i[1],s[2]=i[2]*Math.cos(n)-i[0]*Math.sin(n),t[0]=s[0]+r[0],t[1]=s[1]+r[1],t[2]=s[2]+r[2],t}function p(t,e,r,n){var i=[],s=[];return i[0]=e[0]-r[0],i[1]=e[1]-r[1],i[2]=e[2]-r[2],s[0]=i[0]*Math.cos(n)-i[1]*Math.sin(n),s[1]=i[0]*Math.sin(n)+i[1]*Math.cos(n),s[2]=i[2],t[0]=s[0]+r[0],t[1]=s[1]+r[1],t[2]=s[2]+r[2],t}function b(t,e){var r=t[0],n=t[1],i=t[2],s=e[0],o=e[1],a=e[2],c=Math.sqrt(r*r+n*n+i*i)*Math.sqrt(s*s+o*o+a*a),f=c&&u(t,e)/c;return Math.acos(Math.min(Math.max(f,-1),1))}var g,m=s;g=i()},function(t,e,r){"use strict";function n(t){return(n=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}r.d(e,"a",(function(){return n}))},function(t,e,r){"use strict";function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function i(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),t}r.d(e,"a",(function(){return i}))},function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}r.d(e,"a",(function(){return n}))},function(t,e,r){"use strict";r.d(e,"b",(function(){return s})),r.d(e,"d",(function(){return a})),r.d(e,"e",(function(){return u})),r.d(e,"g",(function(){return f})),r.d(e,"f",(function(){return h})),r.d(e,"a",(function(){return l})),r.d(e,"c",(function(){return d}));r(22),r(29),r(36),r(13);var n=1/Math.PI*180,i=1/180*Math.PI,s={};function o(t){return Math.round(t/s.EPSILON)*s.EPSILON}function a(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.precision,n=void 0===r?s.precision||4:r;return t=o(t),"".concat(parseFloat(t.toPrecision(n)))}function u(t){return Array.isArray(t)||ArrayBuffer.isView(t)&&!(t instanceof DataView)}function c(t,e,r){if(u(t)){r=r||((i=t).clone?i.clone():new Array(i.length));for(var n=0;n<r.length&&n<t.length;++n)r[n]=e(t[n],n,r);return r}var i;return e(t)}function f(t){return function(t,e){return c(t,(function(t){return t*i}),e)}(t)}function h(t){return function(t,e){return c(t,(function(t){return t*n}),e)}(t)}function l(t,e,r){return c(t,(function(t){return Math.max(e,Math.min(r,t))}))}function d(t,e,r){var n=s.EPSILON;r&&(s.EPSILON=r);try{if(t===e)return!0;if(u(t)&&u(e)){if(t.length!==e.length)return!1;for(var i=0;i<t.length;++i)if(!d(t[i],e[i]))return!1;return!0}return t&&t.equals?t.equals(e):e&&e.equals?e.equals(t):!(!Number.isFinite(t)||!Number.isFinite(e))&&Math.abs(t-e)<=s.EPSILON*Math.max(1,Math.abs(t),Math.abs(e))}finally{s.EPSILON=n}}s.EPSILON=1e-12,s.debug=!1,s.precision=4,s.printTypes=!1,s.printDegrees=!1,s.printRowMajor=!0},function(t,e,r){"use strict";r.d(e,"b",(function(){return i})),r.d(e,"g",(function(){return s})),r.d(e,"c",(function(){return o})),r.d(e,"l",(function(){return a})),r.d(e,"a",(function(){return u})),r.d(e,"k",(function(){return c})),r.d(e,"h",(function(){return f})),r.d(e,"m",(function(){return h})),r.d(e,"j",(function(){return l})),r.d(e,"d",(function(){return d})),r.d(e,"i",(function(){return y})),r.d(e,"n",(function(){return p})),r.d(e,"o",(function(){return b})),r.d(e,"f",(function(){return g})),r.d(e,"e",(function(){return m}));var n=r(0);function i(t){var e=new n.a(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function s(t,e,r,i){var s=new n.a(4);return s[0]=t,s[1]=e,s[2]=r,s[3]=i,s}function o(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function a(t,e,r,n,i){return t[0]=e,t[1]=r,t[2]=n,t[3]=i,t}function u(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t}function c(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t}function f(t){var e=t[0],r=t[1],n=t[2],i=t[3];return Math.hypot(e,r,n,i)}function h(t){var e=t[0],r=t[1],n=t[2],i=t[3];return e*e+r*r+n*n+i*i}function l(t,e){var r=e[0],n=e[1],i=e[2],s=e[3],o=r*r+n*n+i*i+s*s;return o>0&&(o=1/Math.sqrt(o)),t[0]=r*o,t[1]=n*o,t[2]=i*o,t[3]=s*o,t}function d(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function y(t,e,r,n){var i=e[0],s=e[1],o=e[2],a=e[3];return t[0]=i+n*(r[0]-i),t[1]=s+n*(r[1]-s),t[2]=o+n*(r[2]-o),t[3]=a+n*(r[3]-a),t}function p(t,e,r){var n=e[0],i=e[1],s=e[2],o=e[3];return t[0]=r[0]*n+r[4]*i+r[8]*s+r[12]*o,t[1]=r[1]*n+r[5]*i+r[9]*s+r[13]*o,t[2]=r[2]*n+r[6]*i+r[10]*s+r[14]*o,t[3]=r[3]*n+r[7]*i+r[11]*s+r[15]*o,t}function b(t,e,r){var n=e[0],i=e[1],s=e[2],o=r[0],a=r[1],u=r[2],c=r[3],f=c*n+a*s-u*i,h=c*i+u*n-o*s,l=c*s+o*i-a*n,d=-o*n-a*i-u*s;return t[0]=f*c+d*-o+h*-u-l*-a,t[1]=h*c+d*-a+l*-o-f*-u,t[2]=l*c+d*-u+f*-a-h*-o,t[3]=e[3],t}function g(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]}function m(t,e){var r=t[0],i=t[1],s=t[2],o=t[3],a=e[0],u=e[1],c=e[2],f=e[3];return Math.abs(r-a)<=n.b*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(i-u)<=n.b*Math.max(1,Math.abs(i),Math.abs(u))&&Math.abs(s-c)<=n.b*Math.max(1,Math.abs(s),Math.abs(c))&&Math.abs(o-f)<=n.b*Math.max(1,Math.abs(o),Math.abs(f))}var v,w;v=new n.a(4),n.a!=Float32Array&&(v[0]=0,v[1]=0,v[2]=0,v[3]=0),w=v},function(t,e,r){"use strict";r.d(e,"o",(function(){return i})),r.d(e,"d",(function(){return s})),r.d(e,"a",(function(){return o})),r.d(e,"f",(function(){return a})),r.d(e,"n",(function(){return u})),r.d(e,"m",(function(){return c})),r.d(e,"i",(function(){return f})),r.d(e,"j",(function(){return h})),r.d(e,"k",(function(){return l})),r.d(e,"l",(function(){return d})),r.d(e,"b",(function(){return y})),r.d(e,"c",(function(){return p})),r.d(e,"h",(function(){return b})),r.d(e,"g",(function(){return g})),r.d(e,"e",(function(){return m}));var n=r(0);function i(t,e){if(t===e){var r=e[1],n=e[2],i=e[3],s=e[6],o=e[7],a=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=r,t[6]=e[9],t[7]=e[13],t[8]=n,t[9]=s,t[11]=e[14],t[12]=i,t[13]=o,t[14]=a}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function s(t,e){var r=e[0],n=e[1],i=e[2],s=e[3],o=e[4],a=e[5],u=e[6],c=e[7],f=e[8],h=e[9],l=e[10],d=e[11],y=e[12],p=e[13],b=e[14],g=e[15],m=r*a-n*o,v=r*u-i*o,w=r*c-s*o,O=n*u-i*a,T=n*c-s*a,E=i*c-s*u,A=f*p-h*y,_=f*b-l*y,I=f*g-d*y,k=h*b-l*p,S=h*g-d*p,N=l*g-d*b,j=m*N-v*S+w*k+O*I-T*_+E*A;return j?(j=1/j,t[0]=(a*N-u*S+c*k)*j,t[1]=(i*S-n*N-s*k)*j,t[2]=(p*E-b*T+g*O)*j,t[3]=(l*T-h*E-d*O)*j,t[4]=(u*I-o*N-c*_)*j,t[5]=(r*N-i*I+s*_)*j,t[6]=(b*w-y*E-g*v)*j,t[7]=(f*E-l*w+d*v)*j,t[8]=(o*S-a*I+c*A)*j,t[9]=(n*I-r*S-s*A)*j,t[10]=(y*T-p*w+g*m)*j,t[11]=(h*w-f*T-d*m)*j,t[12]=(a*_-o*k-u*A)*j,t[13]=(r*k-n*_+i*A)*j,t[14]=(p*v-y*O-b*m)*j,t[15]=(f*O-h*v+l*m)*j,t):null}function o(t){var e=t[0],r=t[1],n=t[2],i=t[3],s=t[4],o=t[5],a=t[6],u=t[7],c=t[8],f=t[9],h=t[10],l=t[11],d=t[12],y=t[13],p=t[14],b=t[15];return(e*o-r*s)*(h*b-l*p)-(e*a-n*s)*(f*b-l*y)+(e*u-i*s)*(f*p-h*y)+(r*a-n*o)*(c*b-l*d)-(r*u-i*o)*(c*p-h*d)+(n*u-i*a)*(c*y-f*d)}function a(t,e,r){var n=e[0],i=e[1],s=e[2],o=e[3],a=e[4],u=e[5],c=e[6],f=e[7],h=e[8],l=e[9],d=e[10],y=e[11],p=e[12],b=e[13],g=e[14],m=e[15],v=r[0],w=r[1],O=r[2],T=r[3];return t[0]=v*n+w*a+O*h+T*p,t[1]=v*i+w*u+O*l+T*b,t[2]=v*s+w*c+O*d+T*g,t[3]=v*o+w*f+O*y+T*m,v=r[4],w=r[5],O=r[6],T=r[7],t[4]=v*n+w*a+O*h+T*p,t[5]=v*i+w*u+O*l+T*b,t[6]=v*s+w*c+O*d+T*g,t[7]=v*o+w*f+O*y+T*m,v=r[8],w=r[9],O=r[10],T=r[11],t[8]=v*n+w*a+O*h+T*p,t[9]=v*i+w*u+O*l+T*b,t[10]=v*s+w*c+O*d+T*g,t[11]=v*o+w*f+O*y+T*m,v=r[12],w=r[13],O=r[14],T=r[15],t[12]=v*n+w*a+O*h+T*p,t[13]=v*i+w*u+O*l+T*b,t[14]=v*s+w*c+O*d+T*g,t[15]=v*o+w*f+O*y+T*m,t}function u(t,e,r){var n,i,s,o,a,u,c,f,h,l,d,y,p=r[0],b=r[1],g=r[2];return e===t?(t[12]=e[0]*p+e[4]*b+e[8]*g+e[12],t[13]=e[1]*p+e[5]*b+e[9]*g+e[13],t[14]=e[2]*p+e[6]*b+e[10]*g+e[14],t[15]=e[3]*p+e[7]*b+e[11]*g+e[15]):(n=e[0],i=e[1],s=e[2],o=e[3],a=e[4],u=e[5],c=e[6],f=e[7],h=e[8],l=e[9],d=e[10],y=e[11],t[0]=n,t[1]=i,t[2]=s,t[3]=o,t[4]=a,t[5]=u,t[6]=c,t[7]=f,t[8]=h,t[9]=l,t[10]=d,t[11]=y,t[12]=n*p+a*b+h*g+e[12],t[13]=i*p+u*b+l*g+e[13],t[14]=s*p+c*b+d*g+e[14],t[15]=o*p+f*b+y*g+e[15]),t}function c(t,e,r){var n=r[0],i=r[1],s=r[2];return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*s,t[9]=e[9]*s,t[10]=e[10]*s,t[11]=e[11]*s,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function f(t,e,r,i){var s,o,a,u,c,f,h,l,d,y,p,b,g,m,v,w,O,T,E,A,_,I,k,S,N=i[0],j=i[1],R=i[2],x=Math.hypot(N,j,R);return x<n.b?null:(N*=x=1/x,j*=x,R*=x,s=Math.sin(r),a=1-(o=Math.cos(r)),u=e[0],c=e[1],f=e[2],h=e[3],l=e[4],d=e[5],y=e[6],p=e[7],b=e[8],g=e[9],m=e[10],v=e[11],w=N*N*a+o,O=j*N*a+R*s,T=R*N*a-j*s,E=N*j*a-R*s,A=j*j*a+o,_=R*j*a+N*s,I=N*R*a+j*s,k=j*R*a-N*s,S=R*R*a+o,t[0]=u*w+l*O+b*T,t[1]=c*w+d*O+g*T,t[2]=f*w+y*O+m*T,t[3]=h*w+p*O+v*T,t[4]=u*E+l*A+b*_,t[5]=c*E+d*A+g*_,t[6]=f*E+y*A+m*_,t[7]=h*E+p*A+v*_,t[8]=u*I+l*k+b*S,t[9]=c*I+d*k+g*S,t[10]=f*I+y*k+m*S,t[11]=h*I+p*k+v*S,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function h(t,e,r){var n=Math.sin(r),i=Math.cos(r),s=e[4],o=e[5],a=e[6],u=e[7],c=e[8],f=e[9],h=e[10],l=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=s*i+c*n,t[5]=o*i+f*n,t[6]=a*i+h*n,t[7]=u*i+l*n,t[8]=c*i-s*n,t[9]=f*i-o*n,t[10]=h*i-a*n,t[11]=l*i-u*n,t}function l(t,e,r){var n=Math.sin(r),i=Math.cos(r),s=e[0],o=e[1],a=e[2],u=e[3],c=e[8],f=e[9],h=e[10],l=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=s*i-c*n,t[1]=o*i-f*n,t[2]=a*i-h*n,t[3]=u*i-l*n,t[8]=s*n+c*i,t[9]=o*n+f*i,t[10]=a*n+h*i,t[11]=u*n+l*i,t}function d(t,e,r){var n=Math.sin(r),i=Math.cos(r),s=e[0],o=e[1],a=e[2],u=e[3],c=e[4],f=e[5],h=e[6],l=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=s*i+c*n,t[1]=o*i+f*n,t[2]=a*i+h*n,t[3]=u*i+l*n,t[4]=c*i-s*n,t[5]=f*i-o*n,t[6]=h*i-a*n,t[7]=l*i-u*n,t}function y(t,e){var r=e[0],n=e[1],i=e[2],s=e[3],o=r+r,a=n+n,u=i+i,c=r*o,f=n*o,h=n*a,l=i*o,d=i*a,y=i*u,p=s*o,b=s*a,g=s*u;return t[0]=1-h-y,t[1]=f+g,t[2]=l-b,t[3]=0,t[4]=f-g,t[5]=1-c-y,t[6]=d+p,t[7]=0,t[8]=l+b,t[9]=d-p,t[10]=1-c-h,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function p(t,e,r,n,i,s,o){var a=1/(r-e),u=1/(i-n),c=1/(s-o);return t[0]=2*s*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*s*u,t[6]=0,t[7]=0,t[8]=(r+e)*a,t[9]=(i+n)*u,t[10]=(o+s)*c,t[11]=-1,t[12]=0,t[13]=0,t[14]=o*s*2*c,t[15]=0,t}function b(t,e,r,n,i){var s,o=1/Math.tan(e/2);return t[0]=o/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=i&&i!==1/0?(s=1/(n-i),t[10]=(i+n)*s,t[14]=2*i*n*s):(t[10]=-1,t[14]=-2*n),t}function g(t,e,r,n,i,s,o){var a=1/(e-r),u=1/(n-i),c=1/(s-o);return t[0]=-2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+r)*a,t[13]=(i+n)*u,t[14]=(o+s)*c,t[15]=1,t}function m(t,e,r,i){var s,o,a,u,c,f,h,l,d,y,p=e[0],b=e[1],g=e[2],m=i[0],v=i[1],w=i[2],O=r[0],T=r[1],E=r[2];return Math.abs(p-O)<n.b&&Math.abs(b-T)<n.b&&Math.abs(g-E)<n.b?function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}(t):(h=p-O,l=b-T,d=g-E,s=v*(d*=y=1/Math.hypot(h,l,d))-w*(l*=y),o=w*(h*=y)-m*d,a=m*l-v*h,(y=Math.hypot(s,o,a))?(s*=y=1/y,o*=y,a*=y):(s=0,o=0,a=0),u=l*a-d*o,c=d*s-h*a,f=h*o-l*s,(y=Math.hypot(u,c,f))?(u*=y=1/y,c*=y,f*=y):(u=0,c=0,f=0),t[0]=s,t[1]=u,t[2]=h,t[3]=0,t[4]=o,t[5]=c,t[6]=l,t[7]=0,t[8]=a,t[9]=f,t[10]=d,t[11]=0,t[12]=-(s*p+o*b+a*g),t[13]=-(u*p+c*b+f*g),t[14]=-(h*p+l*b+d*g),t[15]=1,t)}},function(t,e,r){"use strict";(function(t,n){r.d(e,"a",(function(){return s})),r.d(e,"b",(function(){return o})),r.d(e,"c",(function(){return a}));const i={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:void 0!==t&&t,document:"undefined"!=typeof document&&document},s=i.global||i.self||i.window,o="object"!=typeof n||"[object process]"!==String(n)||n.browser,a="function"==typeof importScripts,u=void 0!==n&&n.version&&n.version.match(/v([0-9]*)/);u&&parseFloat(u[1])}).call(this,r(31),r(35))},function(t,e,r){"use strict";r.d(e,"a",(function(){return i}));var n=r(18);function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Object(n.a)(t,e)}},function(t,e,r){"use strict";r.d(e,"a",(function(){return i}));var n=r(22);function i(t,e){return!e||"object"!==Object(n.a)(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}},function(t,e,r){"use strict";r.d(e,"a",(function(){return i})),r.d(e,"i",(function(){return s})),r.d(e,"d",(function(){return o})),r.d(e,"b",(function(){return a})),r.d(e,"e",(function(){return u})),r.d(e,"h",(function(){return c})),r.d(e,"f",(function(){return f})),r.d(e,"g",(function(){return h})),r.d(e,"c",(function(){return l}));var n=r(0);function i(){var t=new n.a(9);return n.a!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function s(t,e){if(t===e){var r=e[1],n=e[2],i=e[5];t[1]=e[3],t[2]=e[6],t[3]=r,t[5]=e[7],t[6]=n,t[7]=i}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t}function o(t,e){var r=e[0],n=e[1],i=e[2],s=e[3],o=e[4],a=e[5],u=e[6],c=e[7],f=e[8],h=f*o-a*c,l=-f*s+a*u,d=c*s-o*u,y=r*h+n*l+i*d;return y?(y=1/y,t[0]=h*y,t[1]=(-f*n+i*c)*y,t[2]=(a*n-i*o)*y,t[3]=l*y,t[4]=(f*r-i*u)*y,t[5]=(-a*r+i*s)*y,t[6]=d*y,t[7]=(-c*r+n*u)*y,t[8]=(o*r-n*s)*y,t):null}function a(t){var e=t[0],r=t[1],n=t[2],i=t[3],s=t[4],o=t[5],a=t[6],u=t[7],c=t[8];return e*(c*s-o*u)+r*(-c*i+o*a)+n*(u*i-s*a)}function u(t,e,r){var n=e[0],i=e[1],s=e[2],o=e[3],a=e[4],u=e[5],c=e[6],f=e[7],h=e[8],l=r[0],d=r[1],y=r[2],p=r[3],b=r[4],g=r[5],m=r[6],v=r[7],w=r[8];return t[0]=l*n+d*o+y*c,t[1]=l*i+d*a+y*f,t[2]=l*s+d*u+y*h,t[3]=p*n+b*o+g*c,t[4]=p*i+b*a+g*f,t[5]=p*s+b*u+g*h,t[6]=m*n+v*o+w*c,t[7]=m*i+v*a+w*f,t[8]=m*s+v*u+w*h,t}function c(t,e,r){var n=e[0],i=e[1],s=e[2],o=e[3],a=e[4],u=e[5],c=e[6],f=e[7],h=e[8],l=r[0],d=r[1];return t[0]=n,t[1]=i,t[2]=s,t[3]=o,t[4]=a,t[5]=u,t[6]=l*n+d*o+c,t[7]=l*i+d*a+f,t[8]=l*s+d*u+h,t}function f(t,e,r){var n=e[0],i=e[1],s=e[2],o=e[3],a=e[4],u=e[5],c=e[6],f=e[7],h=e[8],l=Math.sin(r),d=Math.cos(r);return t[0]=d*n+l*o,t[1]=d*i+l*a,t[2]=d*s+l*u,t[3]=d*o-l*n,t[4]=d*a-l*i,t[5]=d*u-l*s,t[6]=c,t[7]=f,t[8]=h,t}function h(t,e,r){var n=r[0],i=r[1];return t[0]=n*e[0],t[1]=n*e[1],t[2]=n*e[2],t[3]=i*e[3],t[4]=i*e[4],t[5]=i*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function l(t,e){var r=e[0],n=e[1],i=e[2],s=e[3],o=r+r,a=n+n,u=i+i,c=r*o,f=n*o,h=n*a,l=i*o,d=i*a,y=i*u,p=s*o,b=s*a,g=s*u;return t[0]=1-h-y,t[3]=f-g,t[6]=l+b,t[1]=f+g,t[4]=1-c-y,t[7]=d-p,t[2]=l-b,t[5]=d+p,t[8]=1-c-h,t}},function(t,e,r){"use strict";function n(t,e){if(!t)throw new Error("math.gl assertion ".concat(e))}r.d(e,"a",(function(){return n}))},function(t,e,r){"use strict";function n(t,e,r){var n=e[0],i=e[1],s=r[3]*n+r[7]*i||1;return t[0]=(r[0]*n+r[4]*i)/s,t[1]=(r[1]*n+r[5]*i)/s,t}function i(t,e,r){var n=e[0],i=e[1],s=e[2],o=r[3]*n+r[7]*i+r[11]*s||1;return t[0]=(r[0]*n+r[4]*i+r[8]*s)/o,t[1]=(r[1]*n+r[5]*i+r[9]*s)/o,t[2]=(r[2]*n+r[6]*i+r[10]*s)/o,t}function s(t,e,r){var n=e[0],i=e[1];return t[0]=r[0]*n+r[2]*i,t[1]=r[1]*n+r[3]*i,t[2]=e[2],t}function o(t,e,r){var n=e[0],i=e[1],s=e[2];return t[0]=r[0]*n+r[3]*i+r[6]*s,t[1]=r[1]*n+r[4]*i+r[7]*s,t[2]=r[2]*n+r[5]*i+r[8]*s,t[3]=e[3],t}r.d(e,"a",(function(){return n})),r.d(e,"c",(function(){return i})),r.d(e,"b",(function(){return s})),r.d(e,"d",(function(){return o}))},function(t,e,r){"use strict";r.d(e,"a",(function(){return i})),r.d(e,"b",(function(){return s})),r.d(e,"c",(function(){return o})),r.d(e,"d",(function(){return a}));var n=r(0);function i(t,e,r){var n=e[0],i=e[1];return t[0]=r[0]*n+r[2]*i,t[1]=r[1]*n+r[3]*i,t}function s(t,e,r){var n=e[0],i=e[1];return t[0]=r[0]*n+r[2]*i+r[4],t[1]=r[1]*n+r[3]*i+r[5],t}function o(t,e,r){var n=e[0],i=e[1];return t[0]=r[0]*n+r[3]*i+r[6],t[1]=r[1]*n+r[4]*i+r[7],t}function a(t,e,r){var n=e[0],i=e[1];return t[0]=r[0]*n+r[4]*i+r[12],t[1]=r[1]*n+r[5]*i+r[13],t}var u,c;u=new n.a(2),n.a!=Float32Array&&(u[0]=0,u[1]=0),c=u},,,function(t,e,r){"use strict";function n(t,e){return(n=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}r.d(e,"a",(function(){return n}))},function(t,e,r){"use strict";r.d(e,"a",(function(){return y}));var n=r(5),i=r(4),s=r(10),o=r(11),a=r(3),u=r(18);var c=r(29);function f(t){var e="function"==typeof Map?new Map:void 0;return(f=function(t){if(null===t||(r=t,-1===Function.toString.call(r).indexOf("[native code]")))return t;var r;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,n)}function n(){return Object(c.a)(t,arguments,Object(a.a)(this).constructor)}return n.prototype=Object.create(t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),Object(u.a)(n,t)})(t)}var h=r(6),l=r(13);function d(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Object(a.a)(t);if(e){var i=Object(a.a)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Object(o.a)(this,r)}}var y=function(t){Object(s.a)(r,t);var e=d(r);function r(){return Object(n.a)(this,r),e.apply(this,arguments)}return Object(i.a)(r,[{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"from",value:function(t){return Array.isArray(t)?this.copy(t):this.fromObject(t)}},{key:"fromArray",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=0;r<this.ELEMENTS;++r)this[r]=t[r+e];return this.check()}},{key:"to",value:function(t){return t===this?this:Object(h.e)(t)?this.toArray(t):this.toObject(t)}},{key:"toTarget",value:function(t){return t?this.to(t):this}},{key:"toArray",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=0;r<this.ELEMENTS;++r)t[e+r]=this[r];return t}},{key:"toFloat32Array",value:function(){return new Float32Array(this)}},{key:"toString",value:function(){return this.formatString(h.b)}},{key:"formatString",value:function(t){for(var e="",r=0;r<this.ELEMENTS;++r)e+=(r>0?", ":"")+Object(h.d)(this[r],t);return"".concat(t.printTypes?this.constructor.name:"","[").concat(e,"]")}},{key:"equals",value:function(t){if(!t||this.length!==t.length)return!1;for(var e=0;e<this.ELEMENTS;++e)if(!Object(h.c)(this[e],t[e]))return!1;return!0}},{key:"exactEquals",value:function(t){if(!t||this.length!==t.length)return!1;for(var e=0;e<this.ELEMENTS;++e)if(this[e]!==t[e])return!1;return!0}},{key:"negate",value:function(){for(var t=0;t<this.ELEMENTS;++t)this[t]=-this[t];return this.check()}},{key:"lerp",value:function(t,e,r){void 0===r&&(r=e,e=t,t=this);for(var n=0;n<this.ELEMENTS;++n){var i=t[n];this[n]=i+r*(e[n]-i)}return this.check()}},{key:"min",value:function(t){for(var e=0;e<this.ELEMENTS;++e)this[e]=Math.min(t[e],this[e]);return this.check()}},{key:"max",value:function(t){for(var e=0;e<this.ELEMENTS;++e)this[e]=Math.max(t[e],this[e]);return this.check()}},{key:"clamp",value:function(t,e){for(var r=0;r<this.ELEMENTS;++r)this[r]=Math.min(Math.max(this[r],t[r]),e[r]);return this.check()}},{key:"add",value:function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];for(var n=0,i=e;n<i.length;n++)for(var s=i[n],o=0;o<this.ELEMENTS;++o)this[o]+=s[o];return this.check()}},{key:"subtract",value:function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];for(var n=0,i=e;n<i.length;n++)for(var s=i[n],o=0;o<this.ELEMENTS;++o)this[o]-=s[o];return this.check()}},{key:"scale",value:function(t){if(Array.isArray(t))return this.multiply(t);for(var e=0;e<this.ELEMENTS;++e)this[e]*=t;return this.check()}},{key:"sub",value:function(t){return this.subtract(t)}},{key:"setScalar",value:function(t){for(var e=0;e<this.ELEMENTS;++e)this[e]=t;return this.check()}},{key:"addScalar",value:function(t){for(var e=0;e<this.ELEMENTS;++e)this[e]+=t;return this.check()}},{key:"subScalar",value:function(t){return this.addScalar(-t)}},{key:"multiplyScalar",value:function(t){for(var e=0;e<this.ELEMENTS;++e)this[e]*=t;return this.check()}},{key:"divideScalar",value:function(t){return this.scale(1/t)}},{key:"clampScalar",value:function(t,e){for(var r=0;r<this.ELEMENTS;++r)this[r]=Math.min(Math.max(this[r],t),e);return this.check()}},{key:"multiplyByScalar",value:function(t){return this.scale(t)}},{key:"check",value:function(){if(h.b.debug&&!this.validate())throw new Error("math.gl: ".concat(this.constructor.name," some fields set to invalid numbers'"));return this}},{key:"validate",value:function(){for(var t=this.length===this.ELEMENTS,e=0;e<this.ELEMENTS;++e)t=t&&Number.isFinite(this[e]);return t}},{key:"ELEMENTS",get:function(){return Object(l.a)(!1),0}},{key:"RANK",get:function(){return Object(l.a)(!1),0}},{key:"elements",get:function(){return this}}]),r}(f(Array))},function(t,e,r){"use strict";(function(t,n){r.d(e,"a",(function(){return s})),r.d(e,"b",(function(){return o}));const i={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:void 0!==t&&t,document:"undefined"!=typeof document&&document},s=i.global||i.self||i.window,o="object"!=typeof n||"[object process]"!==String(n)||n.browser,a=void 0!==n&&n.version&&n.version.match(/v([0-9]*)/);a&&parseFloat(a[1])}).call(this,r(31),r(35))},function(t,e,r){"use strict";function n(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}r.d(e,"a",(function(){return n}))},function(t,e,r){"use strict";function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}r.d(e,"a",(function(){return n}))},function(t,e){},,function(t,e,r){"use strict";r.d(e,"a",(function(){return i}));var n=r(21);function i(t,e){if(t){if("string"==typeof t)return Object(n.a)(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Object(n.a)(t,e):void 0}}},function(t,e,r){"use strict";r.d(e,"a",(function(){return l}));var n=r(5),i=r(4),s=r(10),o=r(11),a=r(3),u=r(19),c=r(1),f=r(13);function h(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Object(a.a)(t);if(e){var i=Object(a.a)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Object(o.a)(this,r)}}var l=function(t){Object(s.a)(r,t);var e=h(r);function r(){return Object(n.a)(this,r),e.apply(this,arguments)}return Object(i.a)(r,[{key:"copy",value:function(t){return Object(f.a)(!1),this}},{key:"len",value:function(){return Math.sqrt(this.lengthSquared())}},{key:"magnitude",value:function(){return this.len()}},{key:"lengthSquared",value:function(){for(var t=0,e=0;e<this.ELEMENTS;++e)t+=this[e]*this[e];return t}},{key:"magnitudeSquared",value:function(){return this.lengthSquared()}},{key:"distance",value:function(t){return Math.sqrt(this.distanceSquared(t))}},{key:"distanceSquared",value:function(t){for(var e=0,r=0;r<this.ELEMENTS;++r){var n=this[r]-t[r];e+=n*n}return Object(c.a)(e)}},{key:"dot",value:function(t){for(var e=0,r=0;r<this.ELEMENTS;++r)e+=this[r]*t[r];return Object(c.a)(e)}},{key:"normalize",value:function(){var t=this.magnitude();if(0!==t)for(var e=0;e<this.ELEMENTS;++e)this[e]/=t;return this.check()}},{key:"multiply",value:function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];for(var n=0,i=e;n<i.length;n++)for(var s=i[n],o=0;o<this.ELEMENTS;++o)this[o]*=s[o];return this.check()}},{key:"divide",value:function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];for(var n=0,i=e;n<i.length;n++)for(var s=i[n],o=0;o<this.ELEMENTS;++o)this[o]/=s[o];return this.check()}},{key:"lengthSq",value:function(){return this.lengthSquared()}},{key:"distanceTo",value:function(t){return this.distance(t)}},{key:"distanceToSquared",value:function(t){return this.distanceSquared(t)}},{key:"getComponent",value:function(t){return Object(f.a)(t>=0&&t<this.ELEMENTS,"index is out of range"),Object(c.a)(this[t])}},{key:"setComponent",value:function(t,e){return Object(f.a)(t>=0&&t<this.ELEMENTS,"index is out of range"),this[t]=e,this.check()}},{key:"addVectors",value:function(t,e){return this.copy(t).add(e)}},{key:"subVectors",value:function(t,e){return this.copy(t).subtract(e)}},{key:"multiplyVectors",value:function(t,e){return this.copy(t).multiply(e)}},{key:"addScaledVector",value:function(t,e){return this.add(new this.constructor(t).multiplyScalar(e))}},{key:"x",get:function(){return this[0]},set:function(t){this[0]=Object(c.a)(t)}},{key:"y",get:function(){return this[1]},set:function(t){this[1]=Object(c.a)(t)}}]),r}(u.a)},function(t,e,r){"use strict";r.d(e,"a",(function(){return l}));var n=r(5),i=r(4),s=r(10),o=r(11),a=r(3),u=r(19),c=r(1),f=r(6);function h(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Object(a.a)(t);if(e){var i=Object(a.a)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Object(o.a)(this,r)}}var l=function(t){Object(s.a)(r,t);var e=h(r);function r(){return Object(n.a)(this,r),e.apply(this,arguments)}return Object(i.a)(r,[{key:"toString",value:function(){var t="[";if(f.b.printRowMajor){t+="row-major:";for(var e=0;e<this.RANK;++e)for(var r=0;r<this.RANK;++r)t+=" ".concat(this[r*this.RANK+e])}else{t+="column-major:";for(var n=0;n<this.ELEMENTS;++n)t+=" ".concat(this[n])}return t+="]"}},{key:"getElementIndex",value:function(t,e){return e*this.RANK+t}},{key:"getElement",value:function(t,e){return this[e*this.RANK+t]}},{key:"setElement",value:function(t,e,r){return this[e*this.RANK+t]=Object(c.a)(r),this}},{key:"getColumn",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Array(this.RANK).fill(-0),r=t*this.RANK,n=0;n<this.RANK;++n)e[n]=this[r+n];return e}},{key:"setColumn",value:function(t,e){for(var r=t*this.RANK,n=0;n<this.RANK;++n)this[r+n]=e[n];return this}}]),r}(u.a)},function(t,e,r){"use strict";r.d(e,"a",(function(){return i}));var n=r(25);function i(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var r=[],n=!0,i=!1,s=void 0;try{for(var o,a=t[Symbol.iterator]();!(n=(o=a.next()).done)&&(r.push(o.value),!e||r.length!==e);n=!0);}catch(t){i=!0,s=t}finally{try{n||null==a.return||a.return()}finally{if(i)throw s}}return r}}(t,e)||Object(n.a)(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},function(t,e,r){"use strict";r.d(e,"a",(function(){return s}));var n=r(18);function i(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function s(t,e,r){return(s=i()?Reflect.construct:function(t,e,r){var i=[null];i.push.apply(i,e);var s=new(Function.bind.apply(t,i));return r&&Object(n.a)(s,r.prototype),s}).apply(null,arguments)}},,function(t,e){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(t){"object"==typeof window&&(r=window)}t.exports=r},function(t,e){},,,function(t,e){var r,n,i=t.exports={};function s(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function a(t){if(r===setTimeout)return setTimeout(t,0);if((r===s||!r)&&setTimeout)return r=setTimeout,setTimeout(t,0);try{return r(t,0)}catch(e){try{return r.call(null,t,0)}catch(e){return r.call(this,t,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:s}catch(t){r=s}try{n="function"==typeof clearTimeout?clearTimeout:o}catch(t){n=o}}();var u,c=[],f=!1,h=-1;function l(){f&&u&&(f=!1,u.length?c=u.concat(c):h=-1,c.length&&d())}function d(){if(!f){var t=a(l);f=!0;for(var e=c.length;e;){for(u=c,c=[];++h<e;)u&&u[h].run();h=-1,e=c.length}u=null,f=!1,function(t){if(n===clearTimeout)return clearTimeout(t);if((n===o||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(t);try{n(t)}catch(e){try{return n.call(null,t)}catch(e){return n.call(this,t)}}}(t)}}function y(t,e){this.fun=t,this.array=e}function p(){}i.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];c.push(new y(t,e)),1!==c.length||f||a(d)},y.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=p,i.addListener=p,i.once=p,i.off=p,i.removeListener=p,i.removeAllListeners=p,i.emit=p,i.prependListener=p,i.prependOnceListener=p,i.listeners=function(t){return[]},i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(t,e,r){"use strict";r.d(e,"a",(function(){return s}));var n=r(21);var i=r(25);function s(t){return function(t){if(Array.isArray(t))return Object(n.a)(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||Object(i.a)(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},function(t,e,r){(function(e){const n=r(50),i="undefined"==typeof window?e:window;i.loaders=i.loaders||{},t.exports=Object.assign(i.loaders,n)}).call(this,r(31))},,,,,,,,,,,,,function(t,e,r){"use strict";r.r(e),r.d(e,"Tiles3DLoader",(function(){return Ar})),r.d(e,"CesiumIonLoader",(function(){return Dr})),r.d(e,"Tile3DWriter",(function(){return Wr})),r.d(e,"Tile3DFeatureTable",(function(){return D})),r.d(e,"Tile3DBatchTable",(function(){return Y})),r.d(e,"TILE3D_TYPE",(function(){return b})),r.d(e,"_getIonTilesetMetadata",(function(){return Cr}));var n={};r.r(n),r.d(n,"dirname",(function(){return u}));var i={};r.r(i),r.d(i,"decode",(function(){return ae})),r.d(i,"encode",(function(){return ue}));var s={};r.r(s),r.d(s,"decode",(function(){return he})),r.d(s,"encode",(function(){return le}));var o={};r.r(o),r.d(o,"decode",(function(){return de})),r.d(o,"encode",(function(){return ye}));var a={};function u(t){const e=t&&t.lastIndexOf("/");return e>=0?t.substr(0,e):""}r.r(a),r.d(a,"decode",(function(){return pe})),r.d(a,"encode",(function(){return be}));const c=1,f=2,h="empty",l="scenegraph",d="pointcloud",y="TILES3D",p="geometricError",b={COMPOSITE:"cmpt",POINT_CLOUD:"pnts",BATCHED_3D_MODEL:"b3dm",INSTANCED_3D_MODEL:"i3dm",GEOMETRY:"geom",VECTOR:"vect"},g=(Object.keys(b),{BATCHED_MODEL:[98,51,100,109],INSTANCED_MODEL:[105,51,100,109],POINT_CLOUD:[112,110,116,115],COMPOSITE:[99,109,112,116]});function m(t,e){if(!t)throw new Error(e||"loader assertion failed.")}function v(t,e,r){m(t instanceof ArrayBuffer);const n=new TextDecoder("utf8"),i=new Uint8Array(t,e,r);return n.decode(i)}var w=r(9),O=r(23);const T={};async function E(t,e=null,r={}){return e&&(t=function(t,e,r){const n=r.modules||{};if(n[t])return n[t];if(!w.b)return`modules/${e}/dist/libs/${t}`;if(r.CDN)return m(r.CDN.startsWith("http")),`${r.CDN}/${e}@2.3.1/dist/libs/${t}`;if(w.c)return"../src/libs/"+t;return`modules/${e}/src/libs/${t}`}(t,e,r)),T[t]=T[t]||async function(t){if(t.endsWith("wasm")){const e=await fetch(t);return await e.arrayBuffer()}if(!w.b)return O.requireFromFile&&O.requireFromFile(t);if(w.c)return importScripts(t);const e=await fetch(t);return function(t,e){if(!w.b)return O.requireFromString&&O.requireFromString(t,e);if(w.c)return eval.call(w.a,t),null;const r=document.createElement("script");r.id=e;try{r.appendChild(document.createTextNode(t))}catch(e){r.text=t}return document.body.appendChild(r),null}(await e.text(),t)}(t),await T[t]}let A;async function _(t){const e=t.modules||{};return A=e.draco3d?A||new Promise(t=>{const r=e.draco3d.createDecoderModule({onModuleLoaded(){t({draco:r})}})}):A||async function(t){let e,r;switch(t.draco&&t.draco.decoderType){case"js":e=await E("draco_decoder.js","draco",t);break;case"wasm":default:[e,r]=await Promise.all([await E("draco_wasm_wrapper.js","draco",t),await E("draco_decoder.wasm","draco",t)])}return e=e||w.a.DracoDecoderModule,await function(t,e){const r={};e&&(r.wasmBinary=e);return new Promise(e=>{t({...r,onModuleLoaded:t=>e({draco:t})})})}(e,r)}(t),await A}function I(t){if(!t||!t.POSITION)return null;let e=1/0,r=1/0,n=1/0,i=-1/0,s=-1/0,o=-1/0;const a=t.POSITION.value,u=a&&a.length;if(!u)return null;for(let t=0;t<u;t+=3){const u=a[t],c=a[t+1],f=a[t+2];e=u<e?u:e,r=c<r?c:r,n=f<n?f:n,i=u>i?u:i,s=c>s?c:s,o=f>o?f:o}return[[e,r,n],[i,s,o]]}const k=0,S=1,N={POSITION:"POSITION",NORMAL:"NORMAL",COLOR:"COLOR_0",TEX_COORD:"TEXCOORD_0"},j={1:Int8Array,2:Uint8Array,3:Int16Array,4:Uint16Array,5:Int32Array,6:Uint32Array,9:Float32Array};class R{constructor(t){this.draco=t,this.drawMode="TRIANGLE",this.metadataQuerier={}}destroy(){}destroyGeometry(t){t&&this.draco.destroy(t.dracoGeometry)}parseSync(t,e={}){this.metadataQuerier=new this.draco.MetadataQuerier;const r=new this.draco.DecoderBuffer;r.Init(new Int8Array(t),t.byteLength);const n=new this.draco.Decoder,i={};let s,o,a;try{const t=n.GetEncodedGeometryType(r);switch(t){case this.draco.TRIANGULAR_MESH:o=new this.draco.Mesh,s=n.DecodeBufferToMesh(r,o),a={type:k,faceCount:o.num_faces(),attributeCount:o.num_attributes(),vertexCount:o.num_points()};break;case this.draco.POINT_CLOUD:o=new this.draco.PointCloud,s=n.DecodeBufferToPointCloud(r,o),a={type:S,attributeCount:o.num_attributes(),vertexCount:o.num_points()};break;default:throw new Error("Unknown DRACO geometry type.")}if(!s.ok()||!o.ptr){const t="DRACO decompression failed: "+s.error_msg();throw o&&this.draco.destroy(o),new Error(t)}i.loaderData={header:a},this._extractDRACOGeometry(n,o,t,i,e);const u=this._getGeometryMetadata(n,o);i.header={vertexCount:a.vertexCount,boundingBox:I(i.attributes),metadata:u}}finally{this.draco.destroy(n),this.draco.destroy(r),this.draco.destroy(o),this.draco.destroy(this.metadataQuerier)}return i}_extractDRACOGeometry(t,e,r,n,i){const s=this._getAttributes(t,e,i);if(!s.POSITION)throw new Error("DRACO decompressor: No position attribute found.");return r===this.draco.TRIANGULAR_MESH?(s.indices="TRIANGLE_STRIP"===this.drawMode?this._getMeshStripIndices(t,e):this._getMeshFaceIndices(t,e),n.mode="TRIANGLE_STRIP"===this.drawMode?5:4):n.mode=0,s.indices&&(n.indices={value:s.indices,size:1},delete s.indices),n.attributes=s,n}getPositionAttributeMetadata(t){this.metadata=this.metadata||{},this.metadata.attributes=this.metadata.attributes||{};const e=new this.draco.AttributeQuantizationTransform;if(e.InitFromAttribute(t)){this.metadata.attributes.position.isQuantized=!0,this.metadata.attributes.position.maxRange=e.range(),this.metadata.attributes.position.numQuantizationBits=e.quantization_bits(),this.metadata.attributes.position.minValues=new Float32Array(3);for(let t=0;t<3;++t)this.metadata.attributes.position.minValues[t]=e.min_value(t)}this.draco.destroy(e)}_getAttributes(t,e,r){const n={},i=e.num_points();for(let s=0;s<e.num_attributes();s++){const o=t.GetAttribute(e,s),a=this._getAttributeMetadata(t,e,s),u={uniqueId:o.unique_id(),attributeType:o.attribute_type(),dataType:j[o.data_type()],size:o.size(),numComponents:o.num_components(),byteOffset:o.byte_offset(),byteStride:o.byte_stride(),normalized:o.normalized(),metadata:a},c=this._deduceAttributeName(u,r),{typedArray:f}=this._getAttributeTypedArray(t,e,o,c);n[c]={value:f,size:f.length/i,metadata:a}}return n}_getMeshFaceIndices(t,e){const r=e.num_faces(),n=new Uint32Array(3*r),i=new this.draco.DracoInt32Array;for(let s=0;s<r;++s){t.GetFaceFromMesh(e,s,i);const r=3*s;n[r]=i.GetValue(0),n[r+1]=i.GetValue(1),n[r+2]=i.GetValue(2)}return this.draco.destroy(i),n}_getMeshStripIndices(t,e){const r=new this.draco.DracoInt32Array;t.GetTriangleStripsFromMesh(e,r);const n=new Uint32Array(r.size());for(let t=0;t<r.size();++t)n[t]=r.GetValue(t);return this.draco.destroy(r),n}_getAttributeTypedArray(t,e,r,n){if(0===r.ptr){throw new Error("DRACO decode bad attribute "+n)}const i=j[r.data_type()],s=r.num_components(),o=e.num_points()*s;let a,u;switch(i){case Float32Array:a=new this.draco.DracoFloat32Array,t.GetAttributeFloatForAllPoints(e,r,a),u=new Float32Array(o);break;case Int8Array:a=new this.draco.DracoInt8Array,t.GetAttributeInt8ForAllPoints(e,r,a),u=new Int8Array(o);break;case Int16Array:a=new this.draco.DracoInt16Array,t.GetAttributeInt16ForAllPoints(e,r,a),u=new Int16Array(o);break;case Int32Array:a=new this.draco.DracoInt32Array,t.GetAttributeInt32ForAllPoints(e,r,a),u=new Int32Array(o);break;case Uint8Array:a=new this.draco.DracoUInt8Array,t.GetAttributeUInt8ForAllPoints(e,r,a),u=new Uint8Array(o);break;case Uint16Array:a=new this.draco.DracoUInt16Array,t.GetAttributeUInt16ForAllPoints(e,r,a),u=new Uint16Array(o);break;case Uint32Array:a=new this.draco.DracoUInt32Array,t.GetAttributeUInt32ForAllPoints(e,r,a),u=new Uint32Array(o);break;default:throw new Error("DRACO decoder: unexpected attribute type.")}for(let t=0;t<o;t++)u[t]=a.GetValue(t);return this.draco.destroy(a),{typedArray:u,components:s}}_deduceAttributeName(t,e){const{extraAttributes:r={}}=e;if(r&&"object"==typeof r)for(const[e,n]of Object.entries(r))if(n===t.uniqueId)return e;for(const e in N){const r=this.draco[e];if(t.attributeType===r)return N[e]}if(t.metadata){const r=e.attributeNameEntry||"name";if(t.metadata[r])return t.metadata[r].string}return"CUSTOM_ATTRIBUTE_"+t.uniqueId}_getGeometryMetadata(t,e){const r=t.GetMetadata(e);return this._queryDracoMetadata(r)}_getAttributeMetadata(t,e,r){const n=t.GetAttributeMetadata(e,r);return this._queryDracoMetadata(n)}_queryDracoMetadata(t){if(!t||!t.ptr)return{};const e={},r=this.metadataQuerier.NumEntries(t);for(let n=0;n<r;n++){const r=this.metadataQuerier.GetEntryName(t,n);e[r]={int:this.metadataQuerier.GetIntEntry(t,r),string:this.metadataQuerier.GetStringEntry(t,r),double:this.metadataQuerier.GetDoubleEntry(t,r),intArray:this.metadataQuerier.GetIntEntryArray(t,r)}}return e}decode(t,e){return this.parseSync(t,e)}}const x={...{id:"draco",name:"Draco",version:"2.3.1",extensions:["drc"],mimeTypes:["application/octet-stream"],binary:!0,tests:["DRACO"],options:{draco:{decoderType:"object"==typeof WebAssembly?"wasm":"js",libraryPath:"libs/",workerUrl:"https://unpkg.com/@loaders.gl/draco@2.3.1/dist/draco-loader.worker.js",localWorkerUrl:"modules/draco/dist/draco-loader.worker.dev.js",extraAttributes:{}}}},parse:async function(t,e,r,n){const{draco:i}=await _(e),s=new R(i);try{return s.parseSync(t,{extraAttributes:e.draco&&e.draco.extraAttributes||null,...e.parseOptions||{}})}finally{s.destroy()}}};const M={BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,DOUBLE:5130},L={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,...M};var P=r(53);const U={[M.DOUBLE]:Float64Array,[M.FLOAT]:Float32Array,[M.UNSIGNED_SHORT]:Uint16Array,[M.UNSIGNED_INT]:Uint32Array,[M.UNSIGNED_BYTE]:Uint8Array,[M.BYTE]:Int8Array,[M.SHORT]:Int16Array,[M.INT]:Int32Array},C={DOUBLE:M.DOUBLE,FLOAT:M.FLOAT,UNSIGNED_SHORT:M.UNSIGNED_SHORT,UNSIGNED_INT:M.UNSIGNED_INT,UNSIGNED_BYTE:M.UNSIGNED_BYTE,BYTE:M.BYTE,SHORT:M.SHORT,INT:M.INT};class B{static fromTypedArray(t){t=ArrayBuffer.isView(t)?t.constructor:t;for(const e in U){if(U[e]===t)return e}throw new Error("Failed to convert GL type")}static fromName(t){const e=C[t];if(!e)throw new Error("Failed to convert GL type");return e}static getArrayType(t,e=!1){switch(t){case M.UNSIGNED_SHORT_5_6_5:case M.UNSIGNED_SHORT_4_4_4_4:case M.UNSIGNED_SHORT_5_5_5_1:return Uint16Array;default:const e=U[t];if(!e)throw new Error("Failed to convert GL type");return e}}static getByteSize(t){return B.getArrayType(t).BYTES_PER_ELEMENT}static validate(t){return Boolean(B.getArrayType(t))}static createTypedArray(t,e,r=0,n){void 0===n&&(n=(e.byteLength-r)/B.getByteSize(t));return new(B.getArrayType(t))(e,r,n)}}class D{constructor(t,e){this.json=t,this.buffer=e,this.featuresLength=0,this._cachedTypedArrays={}}getExtension(t){return this.json.extensions&&this.json.extensions[t]}hasProperty(t){return Boolean(this.json[t])}getGlobalProperty(t,e=L.UNSIGNED_INT,r=1){const n=this.json[t];return n&&Number.isFinite(n.byteOffset)?this._getTypedArrayFromBinary(t,e,r,1,n.byteOffset):n}getPropertyArray(t,e,r){const n=this.json[t];return n&&Number.isFinite(n.byteOffset)?("componentType"in n&&(e=B.fromName(n.componentType)),this._getTypedArrayFromBinary(t,e,r,this.featuresLength,n.byteOffset)):this._getTypedArrayFromArray(t,e,n)}getProperty(t,e,r,n,i){const s=this.json[t];if(!s)return s;const o=this.getPropertyArray(t,e,r);if(1===r)return o[n];for(let t=0;t<r;++t)i[t]=o[r*n+t];return i}_getTypedArrayFromBinary(t,e,r,n,i){const s=this._cachedTypedArrays;let o=s[t];return o||(o=B.createTypedArray(e,this.buffer.buffer,this.buffer.byteOffset+i,n*r),s[t]=o),o}_getTypedArrayFromArray(t,e,r){const n=this._cachedTypedArrays;let i=n[t];return i||(i=B.createTypedArray(e,r),n[t]=i),i}}const F={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},V={SCALAR:(t,e)=>t[e],VEC2:(t,e)=>[t[2*e+0],t[2*e+1]],VEC3:(t,e)=>[t[3*e+0],t[3*e+1],t[3*e+2]],VEC4:(t,e)=>[t[4*e+0],t[4*e+1],t[4*e+2],t[4*e+3]],MAT2:(t,e)=>[t[4*e+0],t[4*e+1],t[4*e+2],t[4*e+3]],MAT3:(t,e)=>[t[9*e+0],t[9*e+1],t[9*e+2],t[9*e+3],t[9*e+4],t[9*e+5],t[9*e+6],t[9*e+7],t[9*e+8]],MAT4:(t,e)=>[t[16*e+0],t[16*e+1],t[16*e+2],t[16*e+3],t[16*e+4],t[16*e+5],t[16*e+6],t[16*e+7],t[16*e+8],t[16*e+9],t[16*e+10],t[16*e+11],t[16*e+12],t[16*e+13],t[16*e+14],t[16*e+15]]},G={SCALAR:(t,e,r)=>{e[r]=t},VEC2:(t,e,r)=>{e[2*r+0]=t[0],e[2*r+1]=t[1]},VEC3:(t,e,r)=>{e[3*r+0]=t[0],e[3*r+1]=t[1],e[3*r+2]=t[2]},VEC4:(t,e,r)=>{e[4*r+0]=t[0],e[4*r+1]=t[1],e[4*r+2]=t[2],e[4*r+3]=t[3]},MAT2:(t,e,r)=>{e[4*r+0]=t[0],e[4*r+1]=t[1],e[4*r+2]=t[2],e[4*r+3]=t[3]},MAT3:(t,e,r)=>{e[9*r+0]=t[0],e[9*r+1]=t[1],e[9*r+2]=t[2],e[9*r+3]=t[3],e[9*r+4]=t[4],e[9*r+5]=t[5],e[9*r+6]=t[6],e[9*r+7]=t[7],e[9*r+8]=t[8],e[9*r+9]=t[9]},MAT4:(t,e,r)=>{e[16*r+0]=t[0],e[16*r+1]=t[1],e[16*r+2]=t[2],e[16*r+3]=t[3],e[16*r+4]=t[4],e[16*r+5]=t[5],e[16*r+6]=t[6],e[16*r+7]=t[7],e[16*r+8]=t[8],e[16*r+9]=t[9],e[16*r+10]=t[10],e[16*r+11]=t[11],e[16*r+12]=t[12],e[16*r+13]=t[13],e[16*r+14]=t[14],e[16*r+15]=t[15]}};const z=t=>void 0!==t;function q(t,e,r){if(!e)return null;let n=t.getExtension("3DTILES_batch_table_hierarchy");const i=e.HIERARCHY;return i&&(console.warn("3D Tile Parser: HIERARCHY is deprecated. Use 3DTILES_batch_table_hierarchy."),e.extensions=e.extensions||{},e.extensions["3DTILES_batch_table_hierarchy"]=i,n=i),n?function(t,e){let r,n,i;const s=t.instancesLength,o=t.classes,a=t.classIds,u=t.parentCounts,c=t.parentIds,f=s;z(a.byteOffset)&&(a.componentType=defaultValue(a.componentType,GL.UNSIGNED_SHORT),a.type=AttributeType.SCALAR,i=getBinaryAccessor(a),a=i.createArrayBufferView(e.buffer,e.byteOffset+a.byteOffset,s));let h;if(z(u))for(z(u.byteOffset)&&(u.componentType=defaultValue(u.componentType,GL.UNSIGNED_SHORT),u.type=AttributeType.SCALAR,i=getBinaryAccessor(u),u=i.createArrayBufferView(e.buffer,e.byteOffset+u.byteOffset,s)),h=new Uint16Array(s),f=0,r=0;r<s;++r)h[r]=f,f+=u[r];z(c)&&z(c.byteOffset)&&(c.componentType=defaultValue(c.componentType,GL.UNSIGNED_SHORT),c.type=AttributeType.SCALAR,i=getBinaryAccessor(c),c=i.createArrayBufferView(e.buffer,e.byteOffset+c.byteOffset,f));const l=o.length;for(r=0;r<l;++r){const t=o[r].length,n=o[r].instances,i=getBinaryProperties(t,n,e);o[r].instances=combine(i,n)}const d=new Array(l).fill(0),y=new Uint16Array(s);for(r=0;r<s;++r)n=a[r],y[r]=d[n],++d[n];const p={classes:o,classIds:a,classIndexes:y,parentCounts:u,parentIndexes:h,parentIds:c};return function(t){const e=t.classIds.length;for(let r=0;r<e;++r)W(t,r,stack)}(p),p}(n,r):null}function H(t,e,r){if(!t)return;const n=t.parentCounts;return t.parentIds?r(t,e):n>0?function(t,e,r){const n=t.classIds,i=t.parentCounts,s=t.parentIds,o=t.parentIndexes,a=n.length,u=scratchVisited;u.length=Math.max(u.length,a);const c=++marker,f=scratchStack;f.length=0,f.push(e);for(;f.length>0;){if(e=f.pop(),u[e]===c)continue;u[e]=c;const n=r(t,e);if(z(n))return n;const a=i[e],h=o[e];for(let t=0;t<a;++t){const r=s[h+t];r!==e&&f.push(r)}}return null}(t,e,r):function(t,e,r){let n=!0;for(;n;){const i=r(t,e);if(z(i))return i;const s=t.parentIds[e];n=s!==e,e=s}throw new Error("traverseHierarchySingleParent")}(t,e,r)}function W(t,e,r){const n=t.parentCounts,i=t.parentIds,s=t.parentIndexes,o=t.classIds.length;if(!z(i))return;assert(e<o,`Parent index ${e} exceeds the total number of instances: ${o}`),assert(-1===r.indexOf(e),"Circular dependency detected in the batch table hierarchy."),r.push(e);const a=z(n)?n[e]:1,u=z(n)?s[e]:e;for(let n=0;n<a;++n){const s=i[u+n];s!==e&&W(t,s,r)}r.pop(e)}function $(t){return null!=t}const K=(t,e)=>t,Q={HIERARCHY:!0,extensions:!0,extras:!0};class Y{constructor(t,e,r,n={}){m(r>=0),this.json=t||{},this.binary=e,this.featureCount=r,this._extensions=this.json&&this.json.extensions||{},this._properties={};for(const t in this.json)Q[t]||(this._properties[t]=this.json[t]);this._binaryProperties=this._initializeBinaryProperties(),n["3DTILES_batch_table_hierarchy"]&&(this._hierarchy=q(this,this.json,this.binary))}getExtension(t){return this.json&&this.json.extensions&&this.json.extensions[t]}memorySizeInBytes(){return 0}isClass(t,e){if(this._checkBatchId(t),m("string"==typeof e,e),this._hierarchy){return $(H(this._hierarchy,t,(t,r)=>{const n=t.classIds[r];return t.classes[n].name===e}))}return!1}isExactClass(t,e){return m("string"==typeof e,e),this.getExactClassName(t)===e}getExactClassName(t){if(this._checkBatchId(t),this._hierarchy){const e=this._hierarchy.classIds[t];return this._hierarchy.classes[e].name}}hasProperty(t,e){return this._checkBatchId(t),m("string"==typeof e,e),$(this._properties[e])||this._hasPropertyInHierarchy(t,e)}getPropertyNames(t,e){this._checkBatchId(t),(e=$(e)?e:[]).length=0;const r=Object.keys(this._properties);return e.push(...r),this._hierarchy&&this._getPropertyNamesInHierarchy(t,e),e}getProperty(t,e){if(this._checkBatchId(t),m("string"==typeof e,e),this._binaryProperties){const r=this._binaryProperties[e];if($(r))return this._getBinaryProperty(r,t)}const r=this._properties[e];if($(r))return K(r[t]);if(this._hierarchy){const r=this._getHierarchyProperty(t,e);if($(r))return r}}setProperty(t,e,r){const n=this.featureCount;if(this._checkBatchId(t),m("string"==typeof e,e),this._binaryProperties){const n=this._binaryProperties[e];if(n)return void this._setBinaryProperty(n,t,r)}if(this._hierarchy&&this._setHierarchyProperty(this,t,e,r))return;let i=this._properties[e];$(i)||(this._properties[e]=new Array(n),i=this._properties[e]),i[t]=K(r)}_checkBatchId(t){if(!(t>=0&&t<this.featureCount))throw new Error("batchId not in range [0, featureCount - 1].")}_getBinaryProperty(t,e){return t.unpack(t.typedArray,e)}_setBinaryProperty(t,e,r){t.pack(r,t.typedArray,e)}_initializeBinaryProperties(){let t=null;for(const e in this._properties){const r=this._properties[e],n=this._initializeBinaryProperty(e,r);n&&(t=t||{},t[e]=n)}return t}_initializeBinaryProperty(t,e){if("byteOffset"in e){const r=e;m(this.binary,`Property ${t} requires a batch table binary.`),m(r.type,`Property ${t} requires a type.`);const n=function(t,e,r,n){const{componentType:i}=t;m(t.componentType);const s="string"==typeof i?B.fromName(i):i,o=F[t.type],a=V[t.type],u=G[t.type];return r+=t.byteOffset,{values:B.createTypedArray(s,e,r,o*n),type:s,size:o,unpacker:a,packer:u}}(r,this.binary.buffer,0|this.binary.byteOffset,this.featureCount);return{typedArray:n.values,componentCount:n.size,unpack:n.unpacker,pack:n.packer}}return null}_hasPropertyInHierarchy(t,e){if(!this._hierarchy)return!1;const r=H(this._hierarchy,t,(t,r)=>{const n=t.classIds[r];return $(t.classes[n].instances[e])});return $(r)}_getPropertyNamesInHierarchy(t,e){H(this._hierarchy,t,(t,r)=>{const n=t.classIds[r],i=t.classes[n].instances;for(const t in i)i.hasOwnProperty(t)&&-1===e.indexOf(t)&&e.push(t)})}_getHierarchyProperty(t,e){return H(this._hierarchy,t,(t,r)=>{const n=t.classIds[r],i=t.classes[n],s=t.classIndexes[r],o=i.instances[e];return $(o)?$(o.typedArray)?this._getBinaryProperty(o,s):K(o[s]):null})}_setHierarchyProperty(t,e,r,n){const i=H(this._hierarchy,e,(t,i)=>{const s=t.classIds[i],o=t.classes[s],a=t.classIndexes[i],u=o.instances[r];return!!$(u)&&(m(i===e,`Inherited property "${r}" is read-only.`),$(u.typedArray)?this._setBinaryProperty(u,a,n):u[a]=K(n),!0)});return $(i)}}function Z(t,e,r=0){const n=new DataView(e);if(t.magic=n.getUint32(r,!0),r+=4,t.version=n.getUint32(r,!0),r+=4,t.byteLength=n.getUint32(r,!0),r+=4,1!==t.version)throw new Error(`3D Tile Version ${t.version} not supported`);return r}function J(t,e,r){const n=new DataView(e);return t.header=t.header||{},t.header.featureTableJsonByteLength=n.getUint32(r,!0),r+=4,t.header.featureTableBinaryByteLength=n.getUint32(r,!0),r+=4,t.header.batchTableJsonByteLength=n.getUint32(r,!0),r+=4,t.header.batchTableBinaryByteLength=n.getUint32(r,!0),r+=4}function X(t,e,r,n){return r=function(t,e,r,n){const{featureTableJsonByteLength:i,featureTableBinaryByteLength:s}=t.header;if(t.featureTableJson={BATCH_LENGTH:0},i>0){const n=v(e,r,i);t.featureTableJson=JSON.parse(n)}return r+=i,t.featureTableBinary=new Uint8Array(e,r,s),r+=s}(t,e,r),r=function(t,e,r,n){const{batchTableJsonByteLength:i,batchTableBinaryByteLength:s}=t.header;if(i>0){const n=v(e,r,i);t.batchTableJson=JSON.parse(n),r+=i,s>0&&(t.batchTableBinary=new Uint8Array(e,r,s),t.batchTableBinary=new Uint8Array(t.batchTableBinary),r+=s)}return r}(t,e,r)}function tt(t,e=[0,0,0]){const r=t>>11&31,n=t>>5&63,i=31&t;return e[0]=r<<3,e[1]=n<<2,e[2]=i<<3,e}function et(t,e,r){if(!(e||t&&t.batchIds&&r))return null;const{batchIds:n,isRGB565:i,pointCount:s}=t;if(n&&r){const t=new Uint8ClampedArray(3*s);for(let e=0;e<s;e++){const i=n[e],s=r.getProperty(i,"dimensions").map(t=>255*t);t[3*e]=s[0],t[3*e+1]=s[1],t[3*e+2]=s[2]}return{type:L.UNSIGNED_BYTE,value:t,size:3,normalized:!0}}if(i){const t=new Uint8ClampedArray(3*s);for(let r=0;r<s;r++){const n=tt(e[r]);t[3*r]=n[0],t[3*r+1]=n[1],t[3*r+2]=n[2]}return{type:L.UNSIGNED_BYTE,value:t,size:3,normalized:!0}}return e&&e.length===3*s?{type:L.UNSIGNED_BYTE,value:e,size:3,normalized:!0}:{type:L.UNSIGNED_BYTE,value:e,size:4,normalized:!0}}var rt=r(5),nt=r(4),it=r(10),st=r(11),ot=r(3),at=r(26),ut=r(6),ct=r(1),ft=r(15),ht=r(14);function lt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Object(ot.a)(t);if(e){var i=Object(ot.a)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Object(st.a)(this,r)}}var dt=function(t){Object(it.a)(r,t);var e=lt(r);function r(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return Object(rt.a)(this,r),t=e.call(this,2),Object(ut.e)(n)&&1===arguments.length?t.copy(n):(ut.b.debug&&(Object(ct.a)(n),Object(ct.a)(i)),t[0]=n,t[1]=i),t}return Object(nt.a)(r,[{key:"set",value:function(t,e){return this[0]=t,this[1]=e,this.check()}},{key:"copy",value:function(t){return this[0]=t[0],this[1]=t[1],this.check()}},{key:"fromObject",value:function(t){return ut.b.debug&&(Object(ct.a)(t.x),Object(ct.a)(t.y)),this[0]=t.x,this[1]=t.y,this.check()}},{key:"toObject",value:function(t){return t.x=this[0],t.y=this[1],t}},{key:"horizontalAngle",value:function(){return Math.atan2(this.y,this.x)}},{key:"verticalAngle",value:function(){return Math.atan2(this.x,this.y)}},{key:"transform",value:function(t){return this.transformAsPoint(t)}},{key:"transformAsPoint",value:function(t){return ft.d(this,this,t),this.check()}},{key:"transformAsVector",value:function(t){return Object(ht.a)(this,this,t),this.check()}},{key:"transformByMatrix3",value:function(t){return ft.c(this,this,t),this.check()}},{key:"transformByMatrix2x3",value:function(t){return ft.b(this,this,t),this.check()}},{key:"transformByMatrix2",value:function(t){return ft.a(this,this,t),this.check()}},{key:"ELEMENTS",get:function(){return 2}}]),r}(at.a),yt=r(54);function pt(t,e){if(!t)throw new Error("math.gl assertion failed. "+e)}new dt,new P.a,new dt,new dt,new Uint8Array(1);function bt(t,e=255){return Object(ut.a)(t,0,e)/e*2-1}function gt(t){return t<0?-1:1}function mt(t,e,r,n){if(pt(n),t<0||t>r||e<0||e>r)throw new Error("x and y must be unsigned normalized integers between 0 and "+r);if(n.x=bt(t,r),n.y=bt(e,r),n.z=1-(Math.abs(n.x)+Math.abs(n.y)),n.z<0){const t=n.x;n.x=(1-Math.abs(n.y))*gt(t),n.y=(1-Math.abs(t))*gt(n.y)}return n.normalize()}function vt(t,e,r){return mt(t,e,255,r)}const wt=new P.a;function Ot(t,e,r){return t.isQuantized?r["3d-tiles"]&&r["3d-tiles"].decodeQuantizedPositions?(t.isQuantized=!1,function(t,e){const r=new P.a,n=new Float32Array(3*t.pointCount);for(let i=0;i<t.pointCount;i++)r.set(e[3*i],e[3*i+1],e[3*i+2]).scale(1/t.quantizedRange).multiply(t.quantizedVolumeScale).add(t.quantizedVolumeOffset).toArray(n,3*i);return n}(t,e)):{type:L.UNSIGNED_SHORT,value:e,size:3,normalized:!0}:e}async function Tt(t,e,r,n,i){r=X(t,e,r=J(t,e,r=Z(t,e,r))),function(t){t.attributes={positions:null,colors:null,normals:null,batchIds:null},t.isQuantized=!1,t.isTranslucent=!1,t.isRGB565=!1,t.isOctEncoded16P=!1}(t);const{featureTable:s,batchTable:o}=function(t){const e=new D(t.featureTableJson,t.featureTableBinary),r=e.getGlobalProperty("POINTS_LENGTH");if(!Number.isFinite(r))throw new Error("POINTS_LENGTH must be defined");e.featuresLength=r,t.featuresLength=r,t.pointsLength=r,t.pointCount=r,t.rtcCenter=e.getGlobalProperty("RTC_CENTER",L.FLOAT,3);const n=function(t,e){let r=null;if(!t.batchIds&&e.hasProperty("BATCH_ID")&&(t.batchIds=e.getPropertyArray("BATCH_ID",L.UNSIGNED_SHORT,1),t.batchIds)){const n=e.getGlobalProperty("BATCH_LENGTH");if(!n)throw new Error("Global property: BATCH_LENGTH must be defined when BATCH_ID is defined.");const{batchTableJson:i,batchTableBinary:s}=t;r=new Y(i,s,n)}return r}(t,e);return{featureTable:e,batchTable:n}}(t);return await async function(t,e,r,n,i){let s,o,a;const u=t.batchTableJson&&t.batchTableJson.extensions&&t.batchTableJson.extensions["3DTILES_draco_point_compression"];u&&(a=u.properties);const c=e.getExtension("3DTILES_draco_point_compression");if(c){o=c.properties;const e=c.byteOffset,r=c.byteLength;if(!o||!Number.isFinite(e)||!r)throw new Error("Draco properties, byteOffset, and byteLength must be defined");s=t.featureTableBinary.slice(e,e+r),t.hasPositions=Number.isFinite(o.POSITION),t.hasColors=Number.isFinite(o.RGB)||Number.isFinite(o.RGBA),t.hasNormals=Number.isFinite(o.NORMAL),t.hasBatchIds=Number.isFinite(o.BATCH_ID),t.isTranslucent=Number.isFinite(o.RGBA)}if(!s)return!0;const f={buffer:s,properties:{...o,...a},featureTableProperties:o,batchTableProperties:a,dequantizeInShader:!1};return await async function(t,e,r,n){const{parse:i}=n,s=await i(e.buffer,x,{draco:{extraAttributes:e.batchTableProperties||{}}}),o=s.attributes.POSITION&&s.attributes.POSITION.value,a=s.attributes.COLOR_0&&s.attributes.COLOR_0.value,u=s.attributes.NORMAL&&s.attributes.NORMAL.value,c=s.attributes.BATCH_ID&&s.attributes.BATCH_ID.value,f=o&&s.attributes.POSITION.value.quantization,h=u&&s.attributes.NORMAL.value.quantization;if(f){const e=s.POSITION.data.quantization,r=e.range;t.quantizedVolumeScale=new P.a(r,r,r),t.quantizedVolumeOffset=new P.a(e.minValues),t.quantizedRange=(1<<e.quantizationBits)-1,t.isQuantizedDraco=!0}h&&(t.octEncodedRange=(1<<s.NORMAL.data.quantization.quantizationBits)-1,t.isOctEncodedDraco=!0);const l={};if(e.batchTableProperties)for(const t of Object.keys(e.batchTableProperties))s.attributes[t]&&s.attributes[t].value&&(l[t.toLowerCase()]=s.attributes[t].value);t.attributes={positions:o,colors:et(t,a),normals:u,batchIds:c,...l}}(t,f,0,i)}(t,s,0,0,i),function(t,e,r){if(!t.attributes.positions)if(e.hasProperty("POSITION"))t.attributes.positions=e.getPropertyArray("POSITION",L.FLOAT,3);else if(e.hasProperty("POSITION_QUANTIZED")){const n=e.getPropertyArray("POSITION_QUANTIZED",L.UNSIGNED_SHORT,3);if(t.isQuantized=!0,t.quantizedRange=65535,t.quantizedVolumeScale=e.getGlobalProperty("QUANTIZED_VOLUME_SCALE",L.FLOAT,3),!t.quantizedVolumeScale)throw new Error("QUANTIZED_VOLUME_SCALE must be defined for quantized positions.");if(t.quantizedVolumeOffset=e.getGlobalProperty("QUANTIZED_VOLUME_OFFSET",L.FLOAT,3),!t.quantizedVolumeOffset)throw new Error("QUANTIZED_VOLUME_OFFSET must be defined for quantized positions.");t.attributes.positions=Ot(t,n,r)}if(!t.attributes.positions)throw new Error("Either POSITION or POSITION_QUANTIZED must be defined.")}(t,s,n),function(t,e,r){if(!t.attributes.colors){let n=null;e.hasProperty("RGBA")?(n=e.getPropertyArray("RGBA",L.UNSIGNED_BYTE,4),t.isTranslucent=!0):e.hasProperty("RGB")?n=e.getPropertyArray("RGB",L.UNSIGNED_BYTE,3):e.hasProperty("RGB565")&&(n=e.getPropertyArray("RGB565",L.UNSIGNED_SHORT,1),t.isRGB565=!0),t.attributes.colors=et(t,n,r)}e.hasProperty("CONSTANT_RGBA")&&(t.constantRGBA=e.getGlobalProperty("CONSTANT_RGBA",L.UNSIGNED_BYTE,4))}(t,s,o),function(t,e){if(!t.attributes.normals){let r=null;e.hasProperty("NORMAL")?r=e.getPropertyArray("NORMAL",L.FLOAT,3):e.hasProperty("NORMAL_OCT16P")&&(r=e.getPropertyArray("NORMAL_OCT16P",L.UNSIGNED_BYTE,2),t.isOctEncoded16P=!0),t.attributes.normals=function(t,e){if(!e)return null;if(t.isOctEncoded16P){const r=new Float32Array(3*t.pointsLength);for(let n=0;n<t.pointsLength;n++)vt(e[2*n],e[2*n+1],wt),wt.toArray(r,3*n);return{type:L.FLOAT,size:2,value:r}}return{type:L.FLOAT,size:2,value:e}}(t,r)}}(t,s),r}function Et(t,e){if(!t)throw new Error(e)}var At=r(20);const{_parseImageNode:_t}=At.a,It="undefined"!=typeof Image,kt="undefined"!=typeof ImageBitmap,St=Boolean(_t),Nt=!!At.b||St;function jt(t){const e=Rt(t);if(!e)throw new Error("Not an image");return e}function Rt(t){return"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap?"imagebitmap":"undefined"!=typeof Image&&t instanceof Image?"image":t&&"object"==typeof t&&t.data&&t.width&&t.height?"data":null}const xt=/^data:image\/svg\+xml/,Mt=/\.svg((\?|#).*)?$/;function Lt(t){return t&&(xt.test(t)||Mt.test(t))}function Pt(t,e){if(Lt(e))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(t)])}async function Ut(t,e,r){const n=function(t,e){if(Lt(e)){const e=(new TextDecoder).decode(t);return"data:image/svg+xml;base64,"+btoa(e)}return Pt(t,e)}(t,r),i=self.URL||self.webkitURL,s="string"!=typeof n&&i.createObjectURL(n);try{return await async function(t,e){const r=new Image;if(r.src=t,e.image&&e.image.decode&&r.decode)return await r.decode(),r;return await new Promise((e,n)=>{try{r.onload=()=>e(r),r.onerror=e=>n(new Error(`Could not load image ${t}: ${e}`))}catch(t){n(t)}})}(s||n,e)}finally{s&&i.revokeObjectURL(s)}}const Ct={};let Bt=!0;async function Dt(t,e,r){let n;if(Lt(r)){n=await Ut(t,e,r)}else n=Pt(t,r);const i=e&&e.imagebitmap;return await async function(t,e=null){!function(t){for(const e in t||Ct)return!1;return!0}(e)&&Bt||(e=null);if(e)try{return await createImageBitmap(t,e)}catch(t){console.warn(t),Bt=!1}return await createImageBitmap(t)}(n,i)}function Ft(t){const e=Vt(t);return function(t){const e=Vt(t);if(!(e.byteLength>=24&&2303741511===e.getUint32(0,!1)))return null;return{mimeType:"image/png",width:e.getUint32(16,!1),height:e.getUint32(20,!1)}}(e)||function(t){const e=Vt(t);if(!(e.byteLength>=3&&65496===e.getUint16(0,!1)&&255===e.getUint8(2)))return null;const{tableMarkers:r,sofMarkers:n}=function(){const t=new Set([65499,65476,65484,65501,65534]);for(let e=65504;e<65520;++e)t.add(e);const e=new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502]);return{tableMarkers:t,sofMarkers:e}}();let i=2;for(;i+9<e.byteLength;){const t=e.getUint16(i,!1);if(n.has(t))return{mimeType:"image/jpeg",height:e.getUint16(i+5,!1),width:e.getUint16(i+7,!1)};if(!r.has(t))return null;i+=2,i+=e.getUint16(i,!1)}return null}(e)||function(t){const e=Vt(t);if(!(e.byteLength>=10&&1195984440===e.getUint32(0,!1)))return null;return{mimeType:"image/gif",width:e.getUint16(6,!0),height:e.getUint16(8,!0)}}(e)||function(t){const e=Vt(t);if(!(e.byteLength>=14&&16973===e.getUint16(0,!1)&&e.getUint32(2,!0)===e.byteLength))return null;return{mimeType:"image/bmp",width:e.getUint32(18,!0),height:e.getUint32(22,!0)}}(e)}function Vt(t){if(t instanceof DataView)return t;if(ArrayBuffer.isView(t))return new DataView(t.buffer);if(t instanceof ArrayBuffer)return new DataView(t);throw new Error("toDataView")}var Gt={id:"image",name:"Images",version:"2.3.1",mimeTypes:["image/png","image/jpeg","image/gif","image/webp","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],extensions:["png","jpg","jpeg","gif","webp","bmp","ico","svg"],parse:async function(t,e,r){const n=((e=e||{}).image||{}).type||"auto",{url:i}=r||{};let s;switch(function(t){switch(t){case"auto":case"data":return function(){if(kt)return"imagebitmap";if(It)return"image";if(Nt)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}();default:return function(t){switch(t){case"auto":return kt||It||Nt;case"imagebitmap":return kt;case"image":return It;case"data":return Nt;case"html":return It;case"ndarray":return Nt;default:throw new Error(`@loaders.gl/images: image ${t} not supported in this environment`)}}(t),t}}(n)){case"imagebitmap":s=await Dt(t,e,i);break;case"image":s=await Ut(t,e,i);break;case"data":s=await function(t,e){const{mimeType:r}=Ft(t)||{},{_parseImageNode:n}=At.a;return Et(n),n(t,r,e)}(t,e);break;default:Et(!1)}return"data"===n&&(s=function(t){switch(jt(t)){case"data":return t;case"image":case"imagebitmap":const e=document.createElement("canvas"),r=e.getContext("2d");if(r)return e.width=t.width,e.height=t.height,r.drawImage(t,0,0),r.getImageData(0,0,t.width,t.height);default:return Et(!1)}}(s)),s},tests:[t=>Boolean(Ft(new DataView(t)))],options:{image:{type:"auto",decode:!0}}};function zt(t,e,r){if(t.byteLength<=e+r)return"";const n=new DataView(t);let i="";for(let t=0;t<r;t++)i+=String.fromCharCode(n.getUint8(e+t));return i}function qt(t){try{return JSON.parse(t)}catch(e){throw new Error(`Failed to parse JSON from data starting with "${function(t,e=5){if("string"==typeof t)return t.slice(0,e);if(ArrayBuffer.isView(t))return zt(t.buffer,t.byteOffset,e);if(t instanceof ArrayBuffer){return zt(t,0,e)}return""}(t)}"`)}}r(32);function Ht(t){return t+3&-4}function Wt(t,e,r){return function(t,e,r){const n=void 0!==r?new Uint8Array(t).subarray(e,e+r):new Uint8Array(t).subarray(e);return new Uint8Array(n).buffer}(t,e,r)}function $t(t,e,r){let n;if(t instanceof ArrayBuffer)n=new Uint8Array(t);else{const e=t.byteOffset,r=t.byteLength;n=new Uint8Array(t.buffer,e,r)}return e.set(n,r),r+Ht(n.byteLength)}function Kt(t,e){if(!t)throw new Error(e||"assert failed: gltf")}function Qt(t,e){if(t.startsWith("data:")||t.startsWith("http:")||t.startsWith("https:"))return t;const r=e.baseUri||e.uri;if(!r)throw new Error("'baseUri' must be provided to resolve relative url "+t);return r.substr(0,r.lastIndexOf("/")+1)+t}function Yt(t,e,r){const n=t.bufferViews[r];Kt(n);const i=e[n.buffer];Kt(i);const s=(n.byteOffset||0)+i.byteOffset;return new Uint8Array(i.arrayBuffer,s,n.byteLength)}const Zt=["SCALAR","VEC2","VEC3","VEC4"],Jt=new Map([[Int8Array,5120],[Uint8Array,5121],[Int16Array,5122],[Uint16Array,5123],[Uint32Array,5125],[Float32Array,5126]]),Xt={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},te={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},ee={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array};function re(t){return Zt[t-1]||Zt[0]}function ne(t){const e=Jt.get(t.constructor);if(!e)throw new Error("Illegal typed array");return e}function ie(t,e){const r=ee[t.componentType],n=Xt[t.type],i=te[t.componentType],s=t.count*n,o=t.count*n*i;return Kt(o>=0&&o<=e.byteLength),{ArrayType:r,length:s,byteLength:o}}class se{constructor(t){if(t instanceof se)return t;t||(t={json:{asset:{version:"2.0",generator:"loaders.gl"},buffers:[]},buffers:[]}),this.byteLength=0,this.gltf=t,Kt(this.gltf.json)}get json(){return this.gltf.json}getApplicationData(t){return this.json[t]}getExtraData(t){return(this.json.extras||{})[t]}getExtension(t){const e=this.getUsedExtensions().find(e=>e===t),r=this.json.extensions||{};return e?r[t]||!0:null}getRequiredExtension(t){return this.getRequiredExtensions().find(e=>e===t)?this.getExtension(t):null}getRequiredExtensions(){return this.json.extensionsRequired||[]}getUsedExtensions(){return this.json.extensionsUsed||[]}getObjectExtension(t,e){return(t.extensions||{})[e]}getScene(t){return this.getObject("scenes",t)}getNode(t){return this.getObject("nodes",t)}getSkin(t){return this.getObject("skins",t)}getMesh(t){return this.getObject("meshes",t)}getMaterial(t){return this.getObject("materials",t)}getAccessor(t){return this.getObject("accessors",t)}getCamera(t){return null}getTexture(t){return this.getObject("textures",t)}getSampler(t){return this.getObject("samplers",t)}getImage(t){return this.getObject("images",t)}getBufferView(t){return this.getObject("bufferViews",t)}getBuffer(t){return this.getObject("buffers",t)}getObject(t,e){if("object"==typeof e)return e;const r=this.json[t]&&this.json[t][e];if(!r)throw new Error(`glTF file error: Could not find ${t}[${e}]`);return r}getTypedArrayForBufferView(t){const e=(t=this.getBufferView(t)).buffer,r=this.gltf.buffers[e];Kt(r);const n=(t.byteOffset||0)+r.byteOffset;return new Uint8Array(r.arrayBuffer,n,t.byteLength)}getTypedArrayForAccessor(t){t=this.getAccessor(t);const e=this.getBufferView(t.bufferView),r=this.getBuffer(e.buffer).data,{ArrayType:n,length:i}=ie(t,e);return new n(r,e.byteOffset+t.byteOffset,i)}getTypedArrayForImageData(t){t=this.getAccessor(t);const e=this.getBufferView(t.bufferView),r=this.getBuffer(e.buffer).data,n=e.byteOffset||0;return new Uint8Array(r,n,e.byteLength)}addApplicationData(t,e){return this.json[t]=e,this}addExtraData(t,e){return this.json.extras=this.json.extras||{},this.json.extras[t]=e,this}addObjectExtension(t,e,r){return Kt(r),t.extensions=t.extensions||{},t.extensions[e]=r,this.registerUsedExtension(e),this}setObjectExtension(t,e,r){(t.extensions||{})[e]=r}removeObjectExtension(t,e){const r=t.extensions||{},n=r[e];return delete r[e],n}addExtension(t,e={}){return Kt(e),this.json.extensions=this.json.extensions||{},this.json.extensions[t]=e,this.registerUsedExtension(t),e}addRequiredExtension(t,e={}){return Kt(e),this.addExtension(t,e),this.registerRequiredExtension(t),e}registerUsedExtension(t){this.json.extensionsUsed=this.json.extensionsUsed||[],this.json.extensionsUsed.find(e=>e===t)||this.json.extensionsUsed.push(t)}registerRequiredExtension(t){this.registerUsedExtension(t),this.json.extensionsRequired=this.json.extensionsRequired||[],this.json.extensionsRequired.find(e=>e===t)||this.json.extensionsRequired.push(t)}removeExtension(t){this.json.extensionsRequired&&this._removeStringFromArray(this.json.extensionsRequired,t),this.json.extensionsUsed&&this._removeStringFromArray(this.json.extensionsUsed,t),this.json.extensions&&delete this.json.extensions[t]}addMesh(t,e,r=4){const n={primitives:[{attributes:this._addAttributes(t),indices:e,mode:r}]};return this.json.meshes=this.json.meshes||[],this.json.meshes.push(n),this.json.meshes.length-1}addPointCloud(t){const e={primitives:[{attributes:this._addAttributes(t),mode:0}]};return this.json.meshes=this.json.meshes||[],this.json.meshes.push(e),this.json.meshes.length-1}addImage(t,e){e=e||function(t){const e=Ft(t);return e?e.mimeType:null}(t);const r={bufferView:this.addBufferView(t),mimeType:e};return this.json.images=this.json.images||[],this.json.images.push(r),this.json.images.length-1}addBufferView(t){const e=t.byteLength;Kt(Number.isFinite(e)),this.sourceBuffers=this.sourceBuffers||[],this.sourceBuffers.push(t);const r={buffer:0,byteOffset:this.byteLength,byteLength:e};return this.byteLength+=Ht(e),this.json.bufferViews=this.json.bufferViews||[],this.json.bufferViews.push(r),this.json.bufferViews.length-1}addAccessor(t,e){const r={bufferView:t,type:re(e.size),componentType:e.componentType,count:e.count};return this.json.accessors=this.json.accessors||[],this.json.accessors.push(r),this.json.accessors.length-1}addBinaryBuffer(t,e={size:3}){const r=this.addBufferView(t),n={size:e.size,componentType:ne(t),count:Math.round(t.length/e.size)};return this.addAccessor(r,Object.assign(n,e))}createBinaryChunk(){if(this.arrayBuffer)return;const t=this.byteLength,e=new ArrayBuffer(t),r=new Uint8Array(e);let n=0;for(let t=0;t<this.sourceBuffers.length;t++){n=$t(this.sourceBuffers[t],r,n)}this.json.buffers[0].byteLength=t,this.arrayBuffer=e,this.sourceBuffers=[]}_removeStringFromArray(t,e){let r=!0;for(;r;){const n=t.indexOf(e);n>-1?t.splice(n,1):r=!1}}}function oe(t,e){const{buffer:r,size:n,count:i}=function(t,e){let r=t,n=1,i=0;t&&t.value&&(r=t.value,n=t.size||1);r&&(ArrayBuffer.isView(r)||(r=function(t,e,r=!1){if(!t)return null;if(Array.isArray(t))return new e(t);if(r&&!(t instanceof e))return new e(t);return t}(r,Float32Array)),i=r.length/n);return{buffer:r,size:n,count:i}}(t);return{value:r,size:n,bufferView:null,byteOffset:0,count:i,type:re(n),componentType:ne(r)}}async function ae(t,e,r){if(!e.gltf.decompressMeshes)return;const n=new se(t),i=[];for(const t of function*(t){for(const e of t.json.meshes||[])for(const t of e.primitives)yield t}(n))n.getObjectExtension(t,"KHR_draco_mesh_compression")&&i.push(ce(t,n,e,r));await Promise.all(i),n.removeExtension("KHR_draco_mesh_compression")}function ue(t,e={}){const r=new se(t);for(const t of r.json.meshes||[])fe(t,e),r.addRequiredExtension("KHR_draco_mesh_compression")}async function ce(t,e,r,n){const i=e.getObjectExtension(t,"KHR_draco_mesh_compression"),s=e.getTypedArrayForBufferView(i.bufferView),o=Wt(s.buffer,s.byteOffset),{parse:a}=n,u=await a(o,x,r,n);t.attributes=function(t){const e={};for(const r in t){const n=t[r];if("indices"!==r){const t=oe(n);e[r]=t}}return e}(u.attributes),u.indices&&(t.indices=oe(u.indices)),function(t){if(!t.attributes&&Object.keys(t.attributes).length>0)throw new Error("Empty glTF primitive detected: Draco decompression failure?")}(t)}function fe(t,e,r=4,n,i){if(!n.DracoWriter||!n.DracoLoader)throw new Error("DracoWriter/DracoLoader not available");const s=n.DracoWriter.encodeSync({attributes:t}),{parseSync:o}=i,a=o({attributes:t}),u=n._addFauxAttributes(a.attributes);return{primitives:[{attributes:u,mode:r,extensions:{KHR_draco_mesh_compression:{bufferView:n.addBufferView(s),attributes:u}}}]}}function he(t,e){const r=new se(t),{json:n}=r,i=r.getExtension("KHR_lights_punctual");i&&(r.json.lights=i.lights,r.removeExtension("KHR_lights_punctual"));for(const t of n.nodes||[]){const e=r.getObjectExtension(t,"KHR_lights_punctual");e&&(t.light=e.light),r.removeObjectExtension(t,"KHR_lights_punctual")}}function le(t,e){const r=new se(t),{json:n}=r;if(n.lights){const t=r.addExtension("KHR_lights_punctual");Kt(!t.lights),t.lights=n.lights,delete n.lights}if(r.json.lights){for(const t of r.json.lights){const e=t.node;r.addObjectExtension(e,"KHR_lights_punctual",t)}delete r.json.lights}}function de(t,e){const r=new se(t),{json:n}=r;r.removeExtension("KHR_materials_unlit");for(const t of n.materials||[]){t.extensions&&t.extensions.KHR_materials_unlit&&(t.unlit=!0),r.removeObjectExtension(t,"KHR_materials_unlit")}}function ye(t,e){const r=new se(t),{json:n}=r;if(r.materials)for(const t of n.materials)t.unlit&&(delete t.unlit,r.addObjectExtension(t,"KHR_materials_unlit",{}),r.addExtension("KHR_materials_unlit"))}function pe(t,e){const r=new se(t),{json:n}=r,i=r.getExtension("KHR_techniques_webgl");if(i){const t=function({programs:t=[],shaders:e=[],techniques:r=[]},n){const i=new TextDecoder;return e.forEach(t=>{if(!Number.isFinite(t.bufferView))throw new Error("KHR_techniques_webgl: no shader code");t.code=i.decode(n.getTypedArrayForBufferView(t.bufferView))}),t.forEach(t=>{t.fragmentShader=e[t.fragmentShader],t.vertexShader=e[t.vertexShader]}),r.forEach(e=>{e.program=t[e.program]}),r}(i,r);for(const e of n.materials||[]){const n=r.getObjectExtension(e,"KHR_techniques_webgl");n&&(e.technique=Object.assign({},n,t[n.technique]),e.technique.values=ge(e.technique,r)),r.removeObjectExtension(e,"KHR_techniques_webgl")}r.removeExtension("KHR_techniques_webgl")}}function be(t,e){}function ge(t,e){const r=Object.assign({},t.values);return Object.keys(t.uniforms||{}).forEach(e=>{t.uniforms[e].value&&!(e in r)&&(r[e]=t.uniforms[e].value)}),Object.keys(r).forEach(t=>{"object"==typeof r[t]&&void 0!==r[t].index&&(r[t].texture=e.getTexture(r[t].index))}),r}const me={KHR_draco_mesh_compression:i,KHR_lights_punctual:s,KHR_materials_unlit:o,KHR_techniques_webgl:a};const ve=1735152710;function we(t,e=0,r={}){const n=new DataView(t),{magic:i=ve}=r,s=n.getUint32(e,!1);return s===i||s===ve}function Oe(t,e,r=0,n={}){const i=new DataView(e);t.type=function(t,e=0){return`${String.fromCharCode(t.getUint8(e+0))}${String.fromCharCode(t.getUint8(e+1))}${String.fromCharCode(t.getUint8(e+2))}${String.fromCharCode(t.getUint8(e+3))}`}(i,r+0),t.version=i.getUint32(r+4,!0);const s=i.getUint32(r+8,!0);switch(t.header={byteOffset:r,byteLength:s},t.json={},t.binChunks=[],r+=12,t.version){case 1:return function(t,e,r,n){m(t.header.byteLength>20);const i=e.getUint32(r+0,!0),s=e.getUint32(r+4,!0);return r+=8,m(0===s),Te(t,e,r,i,n),r+=i,r+=Ee(t,e,r,t.header.byteLength,n)}(t,i,r,{});case 2:return function(t,e,r,n){return m(t.header.byteLength>20),function(t,e,r,n){for(;r+8<=t.header.byteLength;){const i=e.getUint32(r+0,!0),s=e.getUint32(r+4,!0);switch(r+=8,s){case 1313821514:Te(t,e,r,i,n);break;case 5130562:Ee(t,e,r,i,n);break;case 0:n.glb.strict||Te(t,e,r,i,n);break;case 1:n.glb.strict||Ee(t,e,r,i,n)}r+=Ht(i)}}(t,e,r,n),r+t.header.byteLength}(t,i,r,{});default:throw new Error(`Invalid GLB version ${t.version}. Only supports v1 and v2.`)}}function Te(t,e,r,n,i){const s=new Uint8Array(e.buffer,r,n),o=new TextDecoder("utf8").decode(s);return t.json=JSON.parse(o),Ht(n)}function Ee(t,e,r,n,i){return t.header.hasBinChunk=!0,t.binChunks.push({byteOffset:r,byteLength:n,arrayBuffer:e.buffer}),Ht(n)}const Ae={accessors:"accessor",animations:"animation",buffers:"buffer",bufferViews:"bufferView",images:"image",materials:"material",meshes:"mesh",nodes:"node",samplers:"sampler",scenes:"scene",skins:"skin",textures:"texture"},_e={accessor:"accessors",animations:"animation",buffer:"buffers",bufferView:"bufferViews",image:"images",material:"materials",mesh:"meshes",node:"nodes",sampler:"samplers",scene:"scenes",skin:"skins",texture:"textures"};class Ie{constructor(t){this.idToIndexMap={animations:{},accessors:{},buffers:{},bufferViews:{},images:{},materials:{},meshes:{},nodes:{},samplers:{},scenes:{},skins:{},textures:{}}}normalize(t,e){this.json=t.json;const r=t.json;switch(r.asset&&r.asset.version){case"2.0":return;case void 0:case"1.0":break;default:return void console.warn("glTF: Unknown version "+r.asset.version)}if(!e.normalize)throw new Error("glTF v1 is not supported.");console.warn("Converting glTF v1 to glTF v2 format. This is experimental and may fail."),this._addAsset(r),this._convertTopLevelObjectsToArrays(r),function(t,e){const r=new se(t),{json:n}=r;for(const t of n.images||[]){const e=r.removeObjectExtension(t,"KHR_binary_glTF");e&&Object.assign(t,e)}n.buffers&&n.buffers[0]&&delete n.buffers[0].uri,r.removeExtension("KHR_binary_glTF")}(t),this._convertObjectIdsToArrayIndices(r),this._updateObjects(r)}_addAsset(t){t.asset=t.asset||{},t.asset.version="2.0",t.asset.generator=t.asset.generator||"Normalized to glTF 2.0 by loaders.gl"}_convertTopLevelObjectsToArrays(t){for(const e in Ae)this._convertTopLevelObjectToArray(t,e)}_convertTopLevelObjectToArray(t,e){const r=t[e];if(r&&!Array.isArray(r)){t[e]=[];for(const n in r){const i=r[n];i.id=i.id||n;const s=t[e].length;t[e].push(i),this.idToIndexMap[e][n]=s}}}_convertObjectIdsToArrayIndices(t){for(const e in Ae)this._convertIdsToIndices(t,e);"scene"in t&&(t.scene=this._convertIdToIndex(t.scene,"scene"));for(const e of t.textures)this._convertTextureIds(e);for(const e of t.meshes)this._convertMeshIds(e);for(const e of t.nodes)this._convertNodeIds(e);for(const e of t.scenes)this._convertSceneIds(e)}_convertTextureIds(t){t.source&&(t.source=this._convertIdToIndex(t.source,"image"))}_convertMeshIds(t){for(const e of t.primitives){const{attributes:t,indices:r,material:n}=e;for(const e in t)t[e]=this._convertIdToIndex(t[e],"accessor");r&&(e.indices=this._convertIdToIndex(r,"accessor")),n&&(e.material=this._convertIdToIndex(n,"material"))}}_convertNodeIds(t){t.children&&(t.children=t.children.map(t=>this._convertIdToIndex(t,"node")))}_convertSceneIds(t){t.nodes&&(t.nodes=t.nodes.map(t=>this._convertIdToIndex(t,"node")))}_convertIdsToIndices(t,e){for(const r of t[e])for(const t in r){const e=r[t],n=this._convertIdToIndex(e,t);r[t]=n}}_convertIdToIndex(t,e){const r=_e[e];if(r in this.idToIndexMap){const n=this.idToIndexMap[r][t];if(!Number.isFinite(n))throw new Error(`gltf v1: failed to resolve ${e} with id ${t}`);return n}return t}_updateObjects(t){for(const t of this.json.buffers)delete t.type}}const ke={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Se={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},Ne={TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,REPEAT:10497,LINEAR:9729,NEAREST_MIPMAP_LINEAR:9986},je={magFilter:Ne.TEXTURE_MAG_FILTER,minFilter:Ne.TEXTURE_MIN_FILTER,wrapS:Ne.TEXTURE_WRAP_S,wrapT:Ne.TEXTURE_WRAP_T},Re={[Ne.TEXTURE_MAG_FILTER]:Ne.LINEAR,[Ne.TEXTURE_MIN_FILTER]:Ne.NEAREST_MIPMAP_LINEAR,[Ne.TEXTURE_WRAP_S]:Ne.REPEAT,[Ne.TEXTURE_WRAP_]:Ne.REPEAT};class xe{postProcess(t,e={}){const{json:r,buffers:n=[],images:i=[],baseUri:s=""}=t;return Kt(r),this.baseUri=s,this.json=r,this.buffers=n,this.images=i,this._resolveTree(this.json,e),this.json}_resolveTree(t,e={}){t.bufferViews&&(t.bufferViews=t.bufferViews.map((t,e)=>this._resolveBufferView(t,e))),t.images&&(t.images=t.images.map((t,e)=>this._resolveImage(t,e))),t.samplers&&(t.samplers=t.samplers.map((t,e)=>this._resolveSampler(t,e))),t.textures&&(t.textures=t.textures.map((t,e)=>this._resolveTexture(t,e))),t.accessors&&(t.accessors=t.accessors.map((t,e)=>this._resolveAccessor(t,e))),t.materials&&(t.materials=t.materials.map((t,e)=>this._resolveMaterial(t,e))),t.meshes&&(t.meshes=t.meshes.map((t,e)=>this._resolveMesh(t,e))),t.nodes&&(t.nodes=t.nodes.map((t,e)=>this._resolveNode(t,e))),t.skins&&(t.skins=t.skins.map((t,e)=>this._resolveSkin(t,e))),t.scenes&&(t.scenes=t.scenes.map((t,e)=>this._resolveScene(t,e))),void 0!==t.scene&&(t.scene=t.scenes[this.json.scene])}getScene(t){return this._get("scenes",t)}getNode(t){return this._get("nodes",t)}getSkin(t){return this._get("skins",t)}getMesh(t){return this._get("meshes",t)}getMaterial(t){return this._get("materials",t)}getAccessor(t){return this._get("accessors",t)}getCamera(t){return null}getTexture(t){return this._get("textures",t)}getSampler(t){return this._get("samplers",t)}getImage(t){return this._get("images",t)}getBufferView(t){return this._get("bufferViews",t)}getBuffer(t){return this._get("buffers",t)}_get(t,e){if("object"==typeof e)return e;const r=this.json[t]&&this.json[t][e];return r||console.warn(`glTF file error: Could not find ${t}[${e}]`),r}_resolveScene(t,e){return t.id=t.id||"scene-"+e,t.nodes=(t.nodes||[]).map(t=>this.getNode(t)),t}_resolveNode(t,e){return t.id=t.id||"node-"+e,t.children&&(t.children=t.children.map(t=>this.getNode(t))),void 0!==t.mesh&&(t.mesh=this.getMesh(t.mesh)),void 0!==t.camera&&(t.camera=this.getCamera(t.camera)),void 0!==t.skin&&(t.skin=this.getSkin(t.skin)),t}_resolveSkin(t,e){return t.id=t.id||"skin-"+e,t.inverseBindMatrices=this.getAccessor(t.inverseBindMatrices),t}_resolveMesh(t,e){return t.id=t.id||"mesh-"+e,t.primitives&&(t.primitives=t.primitives.map(t=>{const e=(t={...t}).attributes;t.attributes={};for(const r in e)t.attributes[r]=this.getAccessor(e[r]);return void 0!==t.indices&&(t.indices=this.getAccessor(t.indices)),void 0!==t.material&&(t.material=this.getMaterial(t.material)),t})),t}_resolveMaterial(t,e){if(t.id=t.id||"material-"+e,t.normalTexture&&(t.normalTexture={...t.normalTexture},t.normalTexture.texture=this.getTexture(t.normalTexture.index)),t.occlusionTexture&&(t.occlustionTexture={...t.occlustionTexture},t.occlusionTexture.texture=this.getTexture(t.occlusionTexture.index)),t.emissiveTexture&&(t.emmisiveTexture={...t.emmisiveTexture},t.emissiveTexture.texture=this.getTexture(t.emissiveTexture.index)),t.pbrMetallicRoughness){t.pbrMetallicRoughness={...t.pbrMetallicRoughness};const e=t.pbrMetallicRoughness;e.baseColorTexture&&(e.baseColorTexture={...e.baseColorTexture},e.baseColorTexture.texture=this.getTexture(e.baseColorTexture.index)),e.metallicRoughnessTexture&&(e.metallicRoughnessTexture={...e.metallicRoughnessTexture},e.metallicRoughnessTexture.texture=this.getTexture(e.metallicRoughnessTexture.index))}return t}_resolveAccessor(t,e){var r,n;if(t.id=t.id||"accessor-"+e,void 0!==t.bufferView&&(t.bufferView=this.getBufferView(t.bufferView)),t.bytesPerComponent=(r=t.componentType,Se[r]),t.components=(n=t.type,ke[n]),t.bytesPerElement=t.bytesPerComponent*t.components,t.bufferView){const e=t.bufferView.buffer,{ArrayType:r,length:n}=ie(t,t.bufferView),i=(t.bufferView.byteOffset||0)+e.byteOffset;t.value=new r(e.arrayBuffer,i,n)}return t}_resolveTexture(t,e){return t.id=t.id||"texture-"+e,t.sampler="sampler"in t?this.getSampler(t.sampler):Re,t.source=this.getImage(t.source),t}_resolveSampler(t,e){t.id=t.id||"sampler-"+e,t.parameters={};for(const e in t){const r=this._enumSamplerParameter(e);void 0!==r&&(t.parameters[r]=t[e])}return t}_enumSamplerParameter(t){return je[t]}_resolveImage(t,e){t.id=t.id||"image-"+e,void 0!==t.bufferView&&(t.bufferView=this.getBufferView(t.bufferView));const r=this.images[e];return r&&(t.image=r),t}_resolveBufferView(t,e){t.id=t.id||"bufferView-"+e;const r=t.buffer;t.buffer=this.buffers[r];const n=this.buffers[r].arrayBuffer;let i=this.buffers[r].byteOffset||0;return"byteOffset"in t&&(i+=t.byteOffset),t.data=new Uint8Array(n,i,t.byteLength),t}_resolveCamera(t,e){return t.id=t.id||"camera-"+e,t.perspective,t.orthographic,t}}async function Me(t,e,r=0,n,i){!function(t,e,r,n){n.uri&&(t.baseUri=n.uri);if(e instanceof ArrayBuffer&&!we(e,r,n)){const t=new TextDecoder;e=t.decode(e)}if("string"==typeof e)t.json=qt(e);else if(e instanceof ArrayBuffer){const i={};r=Oe(i,e,r,n),Kt("glTF"===i.type,"Invalid GLB magic string "+i.type),t._glb=i,t.json=i.json}else Kt(!1,"GLTF: must be ArrayBuffer or string");const i=t.json.buffers||[];if(t.buffers=new Array(i.length).fill(null),t._glb&&t._glb.header.hasBinChunk){const{binChunks:e}=t._glb;t.buffers[0]={arrayBuffer:e[0].arrayBuffer,byteOffset:e[0].byteOffset,byteLength:e[0].byteLength}}const s=t.json.images||[];t.images=new Array(s.length).fill({})}(t,e,r,n),function(t,e={}){(new Ie).normalize(t,e)}(t,{normalize:n.gltf.normalize});const s=[];if(n.gltf.loadImages){const e=async function(t,e,r){const n=t.json.images||[],i=[];for(let s=0;s<n.length;++s)i.push(Le(t,n[s],s,e,r));return await Promise.all(i)}(t,n,i);s.push(e)}n.gltf.loadBuffers&&await async function(t,e,r){for(let n=0;n<t.json.buffers.length;++n){const i=t.json.buffers[n];if(i.uri){const{fetch:s}=r;Kt(s);const o=Qt(i.uri,e),a=await s(o),u=await a.arrayBuffer();t.buffers[n]={arrayBuffer:u,byteOffset:0,byteLength:u.byteLength},delete i.uri}}}(t,n,i);const o=async function(t,e={},r){e.gltf=e.gltf||{};for(const n in me){const i=e.gltf.excludeExtensions||{};if(!(n in i&&!i[n])){const i=me[n];await i.decode(t,e,r)}}}(t,n,i);return s.push(o),await Promise.all(s),n.gltf.postProcess?function(t,e){return(new xe).postProcess(t,e)}(t,n):t}async function Le(t,e,r,n,i){const{fetch:s,parse:o}=i;let a;if(e.uri){const t=Qt(e.uri,n),r=await s(t);a=await r.arrayBuffer()}if(Number.isFinite(e.bufferView)){const r=Yt(t.json,t.buffers,e.bufferView);a=Wt(r.buffer,r.byteOffset,r.byteLength)}Kt(a,"glTF image has no data");const u=await o(a,Gt,{},i);t.images[r]=u}const Pe={id:"gltf",name:"glTF",version:"2.3.1",extensions:["gltf","glb"],mimeTypes:["model/gltf+json","model/gltf-binary"],text:!0,binary:!0,tests:["glTF"],parse:async function(t,e={},r){(e={...Pe.options,...e}).gltf={...Pe.options.gltf,...e.gltf},function(t){"fetchImages"in t&&(t.gltf.loadImages=t.fetchImages);"createImages"in t&&(t.gltf.loadImages=t.createImages);"fetchLinkedResources"in t&&(t.gltf.fetchBuffers=t.fetchLinkedResources);"decompress"in t&&(t.gltf.decompressMeshes=t.decompress);"decompress"in t.gltf&&(t.gltf.decompressMeshes=t.gltf.decompress);"postProcess"in t&&(t.gltf.postProcess=t.postProcess)}(e);const{byteOffset:n=0}=e;return await Me({},t,n,e,r)},options:{gltf:{normalize:!1,loadBuffers:!0,loadImages:!0,decompressMeshes:!0,postProcess:!0},uri:"",log:console},deprecatedOptions:{fetchImages:"gltf.loadImages",createImages:"gltf.loadImages",decompress:"gltf.decompressMeshes",postProcess:"gltf.postProcess",gltf:{decompress:"gltf.decompressMeshes"}}};var Ue=Pe;const Ce=0,Be=1;function De(t,e,r,n){t.rotateYtoZ=!0;const i=t.byteOffset+t.byteLength-r;if(0===i)throw new Error("glTF byte length must be greater than 0.");return t.gltfUpAxis=n["3d-tiles"]&&n["3d-tiles"].assetGltfUpAxis?n["3d-tiles"].assetGltfUpAxis:"Y",t.gltfArrayBuffer=Wt(e,r,i),t.gltfByteOffset=0,t.gltfByteLength=i,r%4==0||console.warn(t.type+": embedded glb is not aligned to a 4-byte boundary."),t.byteOffset+t.byteLength}async function Fe(t,e,r,n){const i=r["3d-tiles"]||{};if(function(t,e,r){switch(e){case Ce:const e=new Uint8Array(t.gltfArrayBuffer,t.gltfByteOffset),r=(new TextDecoder).decode(e);t.gltfUrl=r.replace(/[\s\0]+$/,""),delete t.gltfArrayBuffer,delete t.gltfByteOffset,delete t.gltfByteLength;break;case Be:break;default:throw new Error("b3dm: Illegal glTF format field")}}(t,e),i.loadGLTF){const{parse:e,fetch:i}=n;t.gltfUrl&&(t.gltfArrayBuffer=await i(t.gltfUrl,r),t.gltfByteOffset=0),t.gltfArrayBuffer&&(t.gltf=await e(t.gltfArrayBuffer,Ue,r,n),delete t.gltfArrayBuffer,delete t.gltfByteOffset,delete t.gltfByteLength)}}async function Ve(t,e,r,n,i){r=function(t,e,r,n,i){r=Z(t,e,r),r=J(t,e,r),r=X(t,e,r),r=De(t,e,r,n);const s=new D(t.featureTableJson,t.featureTableBinary);return t.rtcCenter=s.getGlobalProperty("RTC_CENTER",L.FLOAT,3),r}(t,e,r,n),await Fe(t,Be,n,i);const{extensions:s}=t.gltf||{};return s&&s.CESIUM_RTC&&(t.rtcCenter=s.CESIUM_RTC.center),r}var Ge=r(56),ze=r(57),qe=r(55),He=r(28),We=r(13),$e=r(2),Ke=(Math.max(6378137,6378137,6356752.314245179),function(t){return t}),Qe=new P.a;function Ye(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ke;return Object(ut.e)(t)?(e[0]=r(t[0]),e[1]=r(t[1]),e[2]=t[2]):"longitude"in t?(e[0]=r(t.longitude),e[1]=r(t.latitude),e[2]=t.height):(e[0]=r(t.x),e[1]=r(t.y),e[2]=t.z),e}function Ze(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Qe;return Ye(t,e,ut.b._cartographicRadians?Ke:ut.g)}function Je(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ke;return Object(ut.e)(e)?(e[0]=r(t[0]),e[1]=r(t[1]),e[2]=t[2]):"longitude"in e?(e.longitude=r(t[0]),e.latitude=r(t[1]),e.height=t[2]):(e.x=r(t[0]),e.y=r(t[1]),e.z=t[2]),e}function Xe(t,e){return Je(t,e,ut.b._cartographicRadians?Ke:ut.f)}var tr=new P.a,er=new P.a,rr=new P.a;var nr=new P.a,ir={up:{south:"east",north:"west",west:"south",east:"north"},down:{south:"west",north:"east",west:"north",east:"south"},south:{up:"west",down:"east",west:"down",east:"up"},north:{up:"east",down:"west",west:"up",east:"down"},west:{up:"north",down:"south",north:"down",south:"up"},east:{up:"south",down:"north",north:"up",south:"down"}},sr={north:[-1,0,0],east:[0,1,0],up:[0,0,1],south:[1,0,0],west:[0,-1,0],down:[0,0,-1]},or={east:new P.a,north:new P.a,up:new P.a,west:new P.a,south:new P.a,down:new P.a},ar=new P.a,ur=new P.a,cr=new P.a;function fr(t,e,r,n,i,s){var o,a,u,c=ir[e]&&ir[e][r];Object(We.a)(c&&(!n||n===c));var f=nr.copy(i);if(Object(ut.c)(f.x,0,1e-14)&&Object(ut.c)(f.y,0,1e-14)){var h=Math.sign(f.z);o=ar.fromArray(sr[e]),"east"!==e&&"west"!==e&&o.scale(h),a=ur.fromArray(sr[r]),"east"!==r&&"west"!==r&&a.scale(h),u=cr.fromArray(sr[n]),"east"!==n&&"west"!==n&&u.scale(h)}else{var l=or.up,d=or.east,y=or.north;d.set(-f.y,f.x,0).normalize(),t.geodeticSurfaceNormal(f,l),y.copy(l).cross(d);var p=or.west,b=or.south;or.down.copy(l).scale(-1),p.copy(d).scale(-1),b.copy(y).scale(-1),o=or[e],a=or[r],u=or[n]}return s[0]=o.x,s[1]=o.y,s[2]=o.z,s[3]=0,s[4]=a.x,s[5]=a.y,s[6]=a.z,s[7]=0,s[8]=u.x,s[9]=u.y,s[10]=u.z,s[11]=0,s[12]=f.x,s[13]=f.y,s[14]=f.z,s[15]=1,s}var hr,lr=new P.a,dr=new P.a,yr=new P.a,pr=new P.a,br=new P.a,gr=new P.a,mr=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;Object(rt.a)(this,t),Object(We.a)(e>=0),Object(We.a)(r>=0),Object(We.a)(n>=0),this.radii=new P.a(e,r,n),this.radiiSquared=new P.a(e*e,r*r,n*n),this.radiiToTheFourth=new P.a(e*e*e*e,r*r*r*r,n*n*n*n),this.oneOverRadii=new P.a(0===e?0:1/e,0===r?0:1/r,0===n?0:1/n),this.oneOverRadiiSquared=new P.a(0===e?0:1/(e*e),0===r?0:1/(r*r),0===n?0:1/(n*n)),this.minimumRadius=Math.min(e,r,n),this.maximumRadius=Math.max(e,r,n),this.centerToleranceSquared=yt.a.EPSILON1,0!==this.radiiSquared.z&&(this.squaredXOverSquaredZ=this.radiiSquared.x/this.radiiSquared.z),Object.freeze(this)}return Object(nt.a)(t,null,[{key:"WGS84",get:function(){return hr=hr||new t(6378137,6378137,6356752.314245179)}}]),Object(nt.a)(t,[{key:"equals",value:function(t){return this===t||Boolean(t&&this.radii.equals(t.radii))}},{key:"toString",value:function(){return this.radii.toString()}},{key:"cartographicToCartesian",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0],r=dr,n=yr,i=Object(He.a)(t,3),s=i[2];this.geodeticSurfaceNormalCartographic(t,r),n.copy(this.radiiSquared).scale(r);var o=Math.sqrt(r.dot(n));return n.scale(1/o),r.scale(s),n.add(r),n.to(e)}},{key:"cartesianToCartographic",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];gr.from(t);var r=this.scaleToGeodeticSurface(gr,pr);if(r){var n=this.geodeticSurfaceNormal(r,dr),i=br;i.copy(gr).subtract(r);var s=Math.atan2(n.y,n.x),o=Math.asin(n.z),a=Math.sign($e.d(i,gr))*$e.g(i);return Xe([s,o,a],e)}}},{key:"eastNorthUpToFixedFrame",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new qe.a;return fr(this,"east","north","up",t,e)}},{key:"localFrameToFixedFrame",value:function(t,e,r,n){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:new qe.a;return fr(this,t,e,r,n,i)}},{key:"geocentricSurfaceNormal",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];return lr.from(t).normalize().to(e)}},{key:"geodeticSurfaceNormalCartographic",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0],r=Ze(t),n=r[0],i=r[1],s=Math.cos(i);return lr.set(s*Math.cos(n),s*Math.sin(n),Math.sin(i)).normalize(),lr.to(e)}},{key:"geodeticSurfaceNormal",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];return lr.from(t).scale(this.oneOverRadiiSquared).normalize().to(e)}},{key:"scaleToGeodeticSurface",value:function(t,e){return function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new P.a,n=e.oneOverRadii,i=e.oneOverRadiiSquared,s=e.centerToleranceSquared;tr.from(t);var o=t.x,a=t.y,u=t.z,c=n.x,f=n.y,h=n.z,l=o*o*c*c,d=a*a*f*f,y=u*u*h*h,p=l+d+y,b=Math.sqrt(1/p);if(Number.isFinite(b)){var g=er;if(g.copy(t).scale(b),p<s)return g.to(r);var m=i.x,v=i.y,w=i.z,O=rr;O.set(g.x*m*2,g.y*v*2,g.z*w*2);var T,E,A,_,I=(1-b)*t.len()/(.5*O.len()),k=0;do{var S=(T=1/(1+(I-=k)*m))*T,N=(E=1/(1+I*v))*E,j=(A=1/(1+I*w))*A,R=S*T,x=N*E,M=j*A,L=l*R*m+d*x*v+y*M*w,U=-2*L;k=(_=l*S+d*N+y*j-1)/U}while(Math.abs(_)>yt.a.EPSILON12);return tr.scale([T,E,A]).to(r)}}(t,this,e)}},{key:"scaleToGeocentricSurface",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];pr.from(t);var r=pr.x,n=pr.y,i=pr.z,s=this.oneOverRadiiSquared,o=1/Math.sqrt(r*r*s.x+n*n*s.y+i*i*s.z);return pr.multiplyScalar(o).to(e)}},{key:"transformPositionToScaledSpace",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];return pr.from(t).scale(this.oneOverRadii).to(e)}},{key:"transformPositionFromScaledSpace",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];return pr.from(t).scale(this.radii).to(e)}},{key:"getSurfaceNormalIntersectionWithZAxis",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[0,0,0];Object(We.a)(Object(ut.c)(this.radii.x,this.radii.y,yt.a.EPSILON15)),Object(We.a)(this.radii.z>0),pr.from(t);var n=pr.z*(1-this.squaredXOverSquaredZ);if(!(Math.abs(n)>=this.radii.z-e))return pr.set(0,0,n).to(r)}}]),t}();async function vr(t,e,r,n,i){return r=function(t,e,r,n,i){if(r=Z(t,e,r),1!==t.version)throw new Error(`Instanced 3D Model version ${t.version} is not supported`);r=J(t,e,r);const s=new DataView(e);if(t.gltfFormat=s.getUint32(r,!0),r=X(t,e,r+=4),r=De(t,e,r,n),0===t.featureTableJsonByteLength)throw new Error("i3dm parser: featureTableJsonByteLength is zero.");const o=new D(t.featureTableJson,t.featureTableBinary),a=o.getGlobalProperty("INSTANCES_LENGTH");if(o.featuresLength=a,!Number.isFinite(a))throw new Error("i3dm parser: INSTANCES_LENGTH must be defined");t.eastNorthUp=o.getGlobalProperty("EAST_NORTH_UP"),t.rtcCenter=o.getGlobalProperty("RTC_CENTER",L.FLOAT,3);new Y(t.batchTableJson,t.batchTableBinary,a);return function(t,e,r,n){const i=[new Array(n),t._batchTable][0],s=new P.a,o=new P.a,a=new P.a,u=new P.a,c=new Ge.a,f=new ze.a,h=new P.a,l={},d=new qe.a,y=[],p=[],b=new P.a,g=new P.a;for(let r=0;r<n;r++){let n;if(e.hasProperty("POSITION"))n=e.getProperty("POSITION",L.FLOAT,3,r,s);else if(e.hasProperty("POSITION_QUANTIZED")){n=e.getProperty("POSITION_QUANTIZED",L.UNSIGNED_SHORT,3,r,s);const t=e.getGlobalProperty("QUANTIZED_VOLUME_OFFSET",L.FLOAT,3,b);if(!t)throw new Error("i3dm parser: QUANTIZED_VOLUME_OFFSET must be defined for quantized positions.");const i=e.getGlobalProperty("QUANTIZED_VOLUME_SCALE",L.FLOAT,3,g);if(!i)throw new Error("i3dm parser: QUANTIZED_VOLUME_SCALE must be defined for quantized positions.");const o=65535;for(let e=0;e<3;e++)n[e]=n[e]/o*i[e]+t[e]}if(!n)throw new Error("i3dm: POSITION or POSITION_QUANTIZED must be defined for each instance.");s.copy(n),l.translation=s,t.normalUp=e.getProperty("NORMAL_UP",L.FLOAT,3,r,y),t.normalRight=e.getProperty("NORMAL_RIGHT",L.FLOAT,3,r,p);const m=!1;if(t.normalUp){if(!t.normalRight)throw new Error("i3dm: Custom orientation requires both NORMAL_UP and NORMAL_RIGHT.");t.hasCustomOrientation=!0}else{if(t.octNormalUp=e.getProperty("NORMAL_UP_OCT32P",L.UNSIGNED_SHORT,2,y),t.octNormalRight=e.getProperty("NORMAL_RIGHT_OCT32P",L.UNSIGNED_SHORT,2,p),t.octNormalUp){if(!t.octNormalRight)throw new Error("i3dm: oct-encoded orientation requires NORMAL_UP_OCT32P and NORMAL_RIGHT_OCT32P");throw new Error("i3dm: oct-encoded orientation not implemented")}t.eastNorthUp?(mr.WGS84.eastNorthUpToFixedFrame(s,d),d.getRotationMatrix3(c)):c.identity()}m&&(u.copy(o).cross(a).normalize(),c.setColumn(0,o),c.setColumn(1,a),c.setColumn(2,u)),f.fromMatrix3(c),l.rotation=f,h.set(1,1,1);const v=e.getProperty("SCALE",L.FLOAT,1,r);Number.isFinite(v)&&h.multiplyByScalar(v);const w=e.getProperty("SCALE_NON_UNIFORM",L.FLOAT,3,r,y);w&&h.scale(w),l.scale=h;let O=e.getProperty("BATCH_ID",L.UNSIGNED_SHORT,1,r);void 0===O&&(O=r);const T=(new qe.a).fromQuaternion(l.rotation);d.identity(),d.translate(l.translation),d.multiplyRight(T),d.scale(l.scale);const E=d.clone();i[r]={modelMatrix:E,batchId:O}}t.instances=i}(t,o,0,a),r}(t,e,r,n),await Fe(t,t.gltfFormat,n,i),r}async function wr(t,e=0,r,n,i={}){switch(i.byteOffset=e,i.type=function(t,e=0){const r=new DataView(t);return`${String.fromCharCode(r.getUint8(e+0))}${String.fromCharCode(r.getUint8(e+1))}${String.fromCharCode(r.getUint8(e+2))}${String.fromCharCode(r.getUint8(e+3))}`}(t,e),i.type){case b.COMPOSITE:return await async function(t,e,r,n,i,s){r=Z(t,e,r);const o=new DataView(e);for(t.tilesLength=o.getUint32(r,!0),r+=4,t.tiles=[];t.tiles.length<t.tilesLength&&t.byteLength-r>12;){const o={};t.tiles.push(o),r=await s(e,r,n,i,o)}return r}(i,t,e,r,n,wr);case b.BATCHED_3D_MODEL:return await Ve(i,t,e,r,n);case b.INSTANCED_3D_MODEL:return await vr(i,t,e,r,n);case b.POINT_CLOUD:return await Tt(i,t,e,r,n);default:throw new Error("3DTileLoader: unknown type "+i.type)}}function Or(t,e){if(t.content){const r=t.content.uri||t.content.url;t.contentUrl=`${e.basePath}/${r}`}return t.id=t.contentUrl,t.lodMetricType=p,t.lodMetricValue=t.geometricError,t.transformMatrix=t.transform,t.type=function(t){if(!t.contentUrl)return h;const e=t.contentUrl.split(".").pop();switch(e){case"pnts":return d;case"i3dm":case"b3dm":return l;default:return e}}(t),t.refine=function(t){switch(t){case"REPLACE":case"replace":return f;case"ADD":case"add":return c;default:return t}}(t.refine),t}async function Tr(t,e,r){const i=JSON.parse((new TextDecoder).decode(t));var s;return i.loader=e.loader||Er,i.url=r.url,i.basePath=(s=i,n.dirname(s.url)),i.root=function(t){const e=t.basePath,r=Or(t.root,t),n=[];for(n.push(r);n.length>0;){const t=n.pop().children||[];for(const r of t)Or(r,{basePath:e}),n.push(r)}return r}(i),i.type=y,i.lodMetricType=p,i.lodMetricValue=i.root.lodMetricValue,i}const Er={id:"3d-tiles",name:"3D Tiles",version:"2.3.1",extensions:["cmpt","pnts","b3dm","i3dm"],mimeTypes:["application/octet-stream"],tests:["cmpt","pnts","b3dm","i3dm"],parse:async function(t,e,r,n){const i=e["3d-tiles"]||{};let s;return s="auto"===i.isTileset?r.url&&-1!==r.url.indexOf(".json"):i.isTileset,t=s?await Tr(t,e,r):await async function(t,e,r){const n={};return n.content=n.content||{},await wr(t,0,e,r,n.content),n.content}(t,e,r)},options:{"3d-tiles":{loadGLTF:!0,decodeQuantizedPositions:!1,isTileset:"auto",tile:null,tileset:null,assetGltfUpAxis:null}}};var Ar=Er;let _r="";const Ir={};const kr=t=>"undefined"!=typeof Response&&t instanceof Response||t&&t.arrayBuffer&&t.text&&t.json,Sr=t=>"undefined"!=typeof Blob&&t instanceof Blob,Nr=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,jr=/^([-\w.]+\/[-\w.+]+)/;function Rr(t){if("string"!=typeof t)return"";const e=t.match(Nr);return e?e[1]:""}const xr=/\?.*/;function Mr(t){if(kr(t)){const e=function(t){if("string"!=typeof t)return"";const e=t.match(jr);return e?e[1]:t}(t.headers.get("content-type")),r=Rr(t.url);return{url:Lr(t.url||""),type:e||r||null}}return Sr(t)?{url:Lr(t.name||""),type:t.type||""}:"string"==typeof t?{url:Lr(t),type:Rr(t)}:{url:"",type:""}}function Lr(t){return t.replace(xr,"")}async function Pr(t){if(kr(t))return t;const e={},r=function(t){return kr(t)?t.headers["content-length"]||-1:Sr(t)?t.size:"string"==typeof t?t.length:t instanceof ArrayBuffer||ArrayBuffer.isView(t)?t.byteLength:-1}(t);r>=0&&(e["content-length"]=String(r));const{url:n,type:i}=Mr(t);i&&(e["content-type"]=i);const s=await async function(t){if("string"==typeof t)return"data:,"+t.slice(0,5);if(t instanceof Blob){const e=t.slice(0,5);return await new Promise(t=>{const r=new FileReader;r.onload=e=>t(e.target&&e.target.result),r.readAsDataURL(e)})}if(t instanceof ArrayBuffer){const e=t.slice(0,5);return"data:base64,"+function(t){let e="";const r=new Uint8Array(t);for(let t=0;t<r.byteLength;t++)e+=String.fromCharCode(r[t]);return btoa(e)}(e)}return null}(t);s&&(e["x-first-bytes"]=s),"string"==typeof t&&(t=(new TextEncoder).encode(t));const o=new Response(t,{headers:e});return Object.defineProperty(o,"url",{value:n}),o}async function Ur(t,e={}){if("string"!=typeof t)return await Pr(t);t=function(t){for(const e in Ir)if(t.startsWith(e)){const r=Ir[e];t=t.replace(e,r)}return t.startsWith("http://")||t.startsWith("https://")||(t=`${_r}${t}`),t}(t);const r=await fetch(t,e);if(!r.ok&&e.throws)throw new Error(await async function(t){let e=`Failed to fetch resource ${t.url} (${t.status}): `;try{t.headers.get("Content-Type").includes("application/json")?e+=await t.text():e+=t.statusText}catch(t){return e}return e}(r));return r}async function Cr(t,e){if(!e){const r=await async function(t){m(t);const e={Authorization:"Bearer "+t},r=await Ur("https://api.cesium.com/v1/assets",{headers:e,throws:!0});return await r.json()}(t);for(const t of r.items)"3DTILES"===t.type&&(e=t.id)}const r=await async function(t,e){m(t,e);const r={Authorization:"Bearer "+t},n="https://api.cesium.com/v1/assets/"+e;let i=await Ur(""+n,{headers:r,throws:!0}),s=await i.json();i=await Ur(n+"/endpoint",{headers:r,throws:!0});const o=await i.json();return s={...s,...o},s}(t,e),{type:n,url:i}=r;return m("3DTILES"===n&&i),r.headers={Authorization:"Bearer "+r.accessToken},r}const Br={...Ar,id:"cesium-ion",name:"Cesium Ion",preload:async function(t,e={}){e=e["cesium-ion"]||{};const{accessToken:r}=e;let n=e.assetId;if(!Number.isFinite(n)){const e=t.match(/\/([0-9]+)\/tileset.json/);n=e&&e[1]}return Cr(r,n)},parse:async(t,e,r,n)=>(e["3d-tiles"]=e["cesium-ion"],e.loader=Br,Ar.parse(t,e,r)),options:{"cesium-ion":{...Ar.options["3d-tiles"],accessToken:null}}};var Dr=Br;function Fr(t,e,r){if(!e)return r+12;const{magic:n,version:i=1,byteLength:s=12}=t;return m(Array.isArray(n)&&Number.isFinite(i)&&Number.isFinite(s)),e.setUint8(r+0,n[0]),e.setUint8(r+1,n[1]),e.setUint8(r+2,n[2]),e.setUint8(r+3,n[3]),e.setUint32(r+4,i,!0),e.setUint32(r+8,s,!0),r+=12}function Vr(t,e,r){t&&t.setUint32(e+8,r,!0)}function Gr(t,e,r,n){if(t)for(let i=0;i<n;i++)t.setUint8(e+i,r.charCodeAt(i));return e+n}const zr={POINTS_LENGTH:1,POSITIONS:{byteOffset:0}};function qr(t,e,r,n){const{featureTableJson:i=zr}=t;let s=JSON.stringify(i);s=function(t,e){const r=t.length,n=Math.ceil(r/e)*e-r;let i="";for(let t=0;t<n;++t)i+=" ";return t+i}(s,4);const{featureTableJsonByteLength:o=s.length}=t,a=new ArrayBuffer(12),u=a.byteLength,c=r;return r+=Fr(t={magic:g.POINT_CLOUD,...t},e,0),e&&(e.setUint32(r+0,o,!0),e.setUint32(r+4,u,!0),e.setUint32(r+8,0,!0),e.setUint32(r+12,0,!0)),r+=16,r+=Gr(e,r,s,o),r+=function(t,e,r,n){if(t)for(let i=0;i<n;i++)t.setUint8(e+i,r[i]),e++;return e+n}(e,r,a,u),Vr(e,c,r-c),r}function Hr(t,e,r,n){switch(m("string"==typeof t.type),t.type){case b.COMPOSITE:return function(t,e,r,n,i){const s=r;r+=Fr(t={magic:g.COMPOSITE,tiles:[],...t},e,r),e&&e.setUint32(r,t.tiles.length,!0),r+=4;for(let s=0;s<t.tiles.length;++s)r+=i(t.tiles[s],e,r,n);return Vr(e,s,r-s),r}(t,e,r,n,Hr);case b.POINT_CLOUD:return qr(t,e,r);case b.BATCHED_3D_MODEL:return function(t,e,r,n){const{featuresLength:i=1}=t,s={BATCH_LENGTH:i},o=JSON.stringify(s),a=o.length,u=r;return r=Fr(t={magic:g.BATCHED_MODEL,...t},e,r),e&&(e.setUint32(12,a,!0),e.setUint32(16,0,!0),e.setUint32(20,0,!0),e.setUint32(24,0,!0)),r+=16,Vr(e,u,(r+=Gr(e,r,o,a))-u),r}(t,e,r);case b.INSTANCED_3D_MODEL:return function(t,e,r,n){const{featuresLength:i=1,gltfFormat:s=1,gltfUri:o=""}=t,a=o.length,u={INSTANCES_LENGTH:i,POSITION:new Array(3*i).fill(0)},c=JSON.stringify(u),f=c.length,h=r;return r=Fr(t={magic:g.INSTANCED_MODEL,...t},e,0),e&&(e.setUint32(12,f,!0),e.setUint32(16,0,!0),e.setUint32(20,0,!0),e.setUint32(24,0,!0),e.setUint32(28,s,!0)),r+=20,r+=Gr(e,r,c,f),Vr(e,h,(r+=Gr(e,r,o,a))-h),r}(t,e,r);default:throw new Error("3D Tiles: unknown tile type")}}var Wr={name:"3D Tile",extensions:["cmpt","pnts","b3dm","i3dm"],mimeTypes:["application/octet-stream"],encodeSync:function(t,e){return function(t,e){const r=Hr(t,null,0,e),n=new ArrayBuffer(r);return Hr(t,new DataView(n),0,e),n}(t,e)},binary:!0}},,,function(t,e,r){"use strict";r.d(e,"a",(function(){return b}));var n=r(5),i=r(4),s=r(10),o=r(11),a=r(3),u=r(26),c=r(6),f=r(1),h=r(2),l=r(14);function d(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Object(a.a)(t);if(e){var i=Object(a.a)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Object(o.a)(this,r)}}var y=[0,0,0],p={},b=function(t){Object(s.a)(r,t);var e=d(r);function r(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Object(n.a)(this,r),t=e.call(this,-0,-0,-0),1===arguments.length&&Object(c.e)(i)?t.copy(i):(c.b.debug&&(Object(f.a)(i),Object(f.a)(s),Object(f.a)(o)),t[0]=i,t[1]=s,t[2]=o),t}return Object(i.a)(r,null,[{key:"ZERO",get:function(){return p.ZERO=p.ZERO||Object.freeze(new r(0,0,0,0))}}]),Object(i.a)(r,[{key:"set",value:function(t,e,r){return this[0]=t,this[1]=e,this[2]=r,this.check()}},{key:"copy",value:function(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this.check()}},{key:"fromObject",value:function(t){return c.b.debug&&(Object(f.a)(t.x),Object(f.a)(t.y),Object(f.a)(t.z)),this[0]=t.x,this[1]=t.y,this[2]=t.z,this.check()}},{key:"toObject",value:function(t){return t.x=this[0],t.y=this[1],t.z=this[2],t}},{key:"angle",value:function(t){return h.a(this,t)}},{key:"cross",value:function(t){return h.c(this,this,t),this.check()}},{key:"rotateX",value:function(t){var e=t.radians,r=t.origin,n=void 0===r?y:r;return h.i(this,this,n,e),this.check()}},{key:"rotateY",value:function(t){var e=t.radians,r=t.origin,n=void 0===r?y:r;return h.j(this,this,n,e),this.check()}},{key:"rotateZ",value:function(t){var e=t.radians,r=t.origin,n=void 0===r?y:r;return h.k(this,this,n,e),this.check()}},{key:"transform",value:function(t){return this.transformAsPoint(t)}},{key:"transformAsPoint",value:function(t){return h.m(this,this,t),this.check()}},{key:"transformAsVector",value:function(t){return Object(l.c)(this,this,t),this.check()}},{key:"transformByMatrix3",value:function(t){return h.l(this,this,t),this.check()}},{key:"transformByMatrix2",value:function(t){return Object(l.b)(this,this,t),this.check()}},{key:"transformByQuaternion",value:function(t){return h.n(this,this,t),this.check()}},{key:"ELEMENTS",get:function(){return 3}},{key:"z",get:function(){return this[2]},set:function(t){this[2]=Object(f.a)(t)}}]),r}(u.a)},function(t,e,r){"use strict";e.a={EPSILON1:.1,EPSILON2:.01,EPSILON3:.001,EPSILON4:1e-4,EPSILON5:1e-5,EPSILON6:1e-6,EPSILON7:1e-7,EPSILON8:1e-8,EPSILON9:1e-9,EPSILON10:1e-10,EPSILON11:1e-11,EPSILON12:1e-12,EPSILON13:1e-13,EPSILON14:1e-14,EPSILON15:1e-15,EPSILON16:1e-16,EPSILON17:1e-17,EPSILON18:1e-18,EPSILON19:1e-19,EPSILON20:1e-20,PI_OVER_TWO:Math.PI/2,PI_OVER_FOUR:Math.PI/4,PI_OVER_SIX:Math.PI/6,TWO_PI:2*Math.PI}},function(t,e,r){"use strict";r.d(e,"a",(function(){return O}));var n=r(28),i=r(5),s=r(4),o=r(10),a=r(11),u=r(3),c=r(1),f=r(27),h=r(14),l=r(8),d=r(15),y=r(2),p=r(7);function b(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Object(u.a)(t);if(e){var i=Object(u.a)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Object(a.a)(this,r)}}var g=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),m=Object.freeze([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),v=Object.freeze({COL0ROW0:0,COL0ROW1:1,COL0ROW2:2,COL0ROW3:3,COL1ROW0:4,COL1ROW1:5,COL1ROW2:6,COL1ROW3:7,COL2ROW0:8,COL2ROW1:9,COL2ROW2:10,COL2ROW3:11,COL3ROW0:12,COL3ROW1:13,COL3ROW2:14,COL3ROW3:15}),w={},O=function(t){Object(o.a)(r,t);var e=b(r);function r(t){var n;return Object(i.a)(this,r),n=e.call(this,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),1===arguments.length&&Array.isArray(t)?n.copy(t):n.identity(),n}return Object(s.a)(r,[{key:"INDICES",get:function(){return v}},{key:"ELEMENTS",get:function(){return 16}},{key:"RANK",get:function(){return 4}}],[{key:"IDENTITY",get:function(){return w.IDENTITY=w.IDENTITY||Object.freeze(new r(g)),w.IDENTITY}},{key:"ZERO",get:function(){return w.ZERO=w.ZERO||Object.freeze(new r(m)),w.ZERO}}]),Object(s.a)(r,[{key:"copy",value:function(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this[4]=t[4],this[5]=t[5],this[6]=t[6],this[7]=t[7],this[8]=t[8],this[9]=t[9],this[10]=t[10],this[11]=t[11],this[12]=t[12],this[13]=t[13],this[14]=t[14],this[15]=t[15],this.check()}},{key:"set",value:function(t,e,r,n,i,s,o,a,u,c,f,h,l,d,y,p){return this[0]=t,this[1]=e,this[2]=r,this[3]=n,this[4]=i,this[5]=s,this[6]=o,this[7]=a,this[8]=u,this[9]=c,this[10]=f,this[11]=h,this[12]=l,this[13]=d,this[14]=y,this[15]=p,this.check()}},{key:"setRowMajor",value:function(t,e,r,n,i,s,o,a,u,c,f,h,l,d,y,p){return this[0]=t,this[1]=i,this[2]=u,this[3]=l,this[4]=e,this[5]=s,this[6]=c,this[7]=d,this[8]=r,this[9]=o,this[10]=f,this[11]=y,this[12]=n,this[13]=a,this[14]=h,this[15]=p,this.check()}},{key:"toRowMajor",value:function(t){return t[0]=this[0],t[1]=this[4],t[2]=this[8],t[3]=this[12],t[4]=this[1],t[5]=this[5],t[6]=this[9],t[7]=this[13],t[8]=this[2],t[9]=this[6],t[10]=this[10],t[11]=this[14],t[12]=this[3],t[13]=this[7],t[14]=this[11],t[15]=this[15],t}},{key:"identity",value:function(){return this.copy(g)}},{key:"fromQuaternion",value:function(t){return l.b(this,t),this.check()}},{key:"frustum",value:function(t){var e=t.left,n=t.right,i=t.bottom,s=t.top,o=t.near,a=t.far;return a===1/0?r._computeInfinitePerspectiveOffCenter(this,e,n,i,s,o):l.c(this,e,n,i,s,o,a),this.check()}},{key:"lookAt",value:function(t,e,r){if(1===arguments.length){var n=t;t=n.eye,e=n.center,r=n.up}return e=e||[0,0,0],r=r||[0,1,0],l.e(this,t,e,r),this.check()}},{key:"ortho",value:function(t){var e=t.left,r=t.right,n=t.bottom,i=t.top,s=t.near,o=void 0===s?.1:s,a=t.far,u=void 0===a?500:a;return l.g(this,e,r,n,i,o,u),this.check()}},{key:"orthographic",value:function(t){var e=t.fovy,n=void 0===e?45*Math.PI/180:e,i=t.aspect,s=void 0===i?1:i,o=t.focalDistance,a=void 0===o?1:o,u=t.near,c=void 0===u?.1:u,f=t.far,h=void 0===f?500:f;if(n>2*Math.PI)throw Error("radians");var l=n/2,d=a*Math.tan(l),y=d*s;return(new r).ortho({left:-y,right:y,bottom:-d,top:d,near:c,far:h})}},{key:"perspective",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.fovy,r=void 0===e?void 0:e,n=t.fov,i=void 0===n?45*Math.PI/180:n,s=t.aspect,o=void 0===s?1:s,a=t.near,u=void 0===a?.1:a,c=t.far,f=void 0===c?500:c;if((r=r||i)>2*Math.PI)throw Error("radians");return l.h(this,r,o,u,f),this.check()}},{key:"determinant",value:function(){return l.a(this)}},{key:"getScale",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[-0,-0,-0];return t[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),t[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),t[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),t}},{key:"getTranslation",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[-0,-0,-0];return t[0]=this[12],t[1]=this[13],t[2]=this[14],t}},{key:"getRotation",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=this.getScale(e||[-0,-0,-0]),n=1/r[0],i=1/r[1],s=1/r[2];return t[0]=this[0]*n,t[1]=this[1]*i,t[2]=this[2]*s,t[3]=0,t[4]=this[4]*n,t[5]=this[5]*i,t[6]=this[6]*s,t[7]=0,t[8]=this[8]*n,t[9]=this[9]*i,t[10]=this[10]*s,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}},{key:"getRotationMatrix3",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[-0,-0,-0,-0,-0,-0,-0,-0,-0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=this.getScale(e||[-0,-0,-0]),n=1/r[0],i=1/r[1],s=1/r[2];return t[0]=this[0]*n,t[1]=this[1]*i,t[2]=this[2]*s,t[3]=this[4]*n,t[4]=this[5]*i,t[5]=this[6]*s,t[6]=this[8]*n,t[7]=this[9]*i,t[8]=this[10]*s,t}},{key:"transpose",value:function(){return l.o(this,this),this.check()}},{key:"invert",value:function(){return l.d(this,this),this.check()}},{key:"multiplyLeft",value:function(t){return l.f(this,t,this),this.check()}},{key:"multiplyRight",value:function(t){return l.f(this,this,t),this.check()}},{key:"rotateX",value:function(t){return l.j(this,this,t),this.check()}},{key:"rotateY",value:function(t){return l.k(this,this,t),this.check()}},{key:"rotateZ",value:function(t){return l.l(this,this,t),this.check()}},{key:"rotateXYZ",value:function(t){var e=Object(n.a)(t,3),r=e[0],i=e[1],s=e[2];return this.rotateX(r).rotateY(i).rotateZ(s)}},{key:"rotateAxis",value:function(t,e){return l.i(this,this,t,e),this.check()}},{key:"scale",value:function(t){return Array.isArray(t)?l.m(this,this,t):l.m(this,this,[t,t,t]),this.check()}},{key:"translate",value:function(t){return l.n(this,this,t),this.check()}},{key:"transform",value:function(t,e){return 4===t.length?(e=p.n(e||[-0,-0,-0,-0],t,this),Object(c.b)(e,4),e):this.transformAsPoint(t,e)}},{key:"transformAsPoint",value:function(t,e){switch(t.length){case 2:e=d.d(e||[-0,-0],t,this);break;case 3:e=y.m(e||[-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return Object(c.b)(e,t.length),e}},{key:"transformAsVector",value:function(t,e){switch(t.length){case 2:e=Object(h.a)(e||[-0,-0],t,this);break;case 3:e=Object(h.c)(e||[-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return Object(c.b)(e,t.length),e}},{key:"makeRotationX",value:function(t){return this.identity().rotateX(t)}},{key:"makeTranslation",value:function(t,e,r){return this.identity().translate([t,e,r])}},{key:"transformPoint",value:function(t,e){return Object(c.c)("Matrix4.transformPoint","3.0"),this.transformAsPoint(t,e)}},{key:"transformVector",value:function(t,e){return Object(c.c)("Matrix4.transformVector","3.0"),this.transformAsPoint(t,e)}},{key:"transformDirection",value:function(t,e){return Object(c.c)("Matrix4.transformDirection","3.0"),this.transformAsVector(t,e)}}],[{key:"_computeInfinitePerspectiveOffCenter",value:function(t,e,r,n,i,s){var o=2*s/(r-e),a=2*s/(i-n),u=(r+e)/(r-e),c=(i+n)/(i-n),f=-2*s;return t[0]=o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=u,t[9]=c,t[10]=-1,t[11]=-1,t[12]=0,t[13]=0,t[14]=f,t[15]=0,t}}]),r}(f.a)},function(t,e,r){"use strict";r.d(e,"a",(function(){return v}));var n=r(5),i=r(4),s=r(10),o=r(11),a=r(3),u=r(27),c=r(1),f=r(14),h=r(12),l=r(15),d=r(2);function y(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Object(a.a)(t);if(e){var i=Object(a.a)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Object(o.a)(this,r)}}var p=Object.freeze([1,0,0,0,1,0,0,0,1]),b=Object.freeze([0,0,0,0,0,0,0,0,0]),g=Object.freeze({COL0ROW0:0,COL0ROW1:1,COL0ROW2:2,COL1ROW0:3,COL1ROW1:4,COL1ROW2:5,COL2ROW0:6,COL2ROW1:7,COL2ROW2:8}),m={},v=function(t){Object(s.a)(r,t);var e=y(r);function r(t){var i;return Object(n.a)(this,r),i=e.call(this,-0,-0,-0,-0,-0,-0,-0,-0,-0),1===arguments.length&&Array.isArray(t)?i.copy(t):i.identity(),i}return Object(i.a)(r,[{key:"ELEMENTS",get:function(){return 9}},{key:"RANK",get:function(){return 3}},{key:"INDICES",get:function(){return g}}],[{key:"IDENTITY",get:function(){return m.IDENTITY=m.IDENTITY||Object.freeze(new r(p)),m.IDENTITY}},{key:"ZERO",get:function(){return m.ZERO=m.ZERO||Object.freeze(new r(b)),m.ZERO}}]),Object(i.a)(r,[{key:"copy",value:function(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this[4]=t[4],this[5]=t[5],this[6]=t[6],this[7]=t[7],this[8]=t[8],this.check()}},{key:"set",value:function(t,e,r,n,i,s,o,a,u){return this[0]=t,this[1]=e,this[2]=r,this[3]=n,this[4]=i,this[5]=s,this[6]=o,this[7]=a,this[8]=u,this.check()}},{key:"setRowMajor",value:function(t,e,r,n,i,s,o,a,u){return this[0]=t,this[1]=n,this[2]=o,this[3]=e,this[4]=i,this[5]=a,this[6]=r,this[7]=s,this[8]=u,this.check()}},{key:"determinant",value:function(){return h.b(this)}},{key:"identity",value:function(){return this.copy(p)}},{key:"fromQuaternion",value:function(t){return h.c(this,t),this.check()}},{key:"transpose",value:function(){return h.i(this,this),this.check()}},{key:"invert",value:function(){return h.d(this,this),this.check()}},{key:"multiplyLeft",value:function(t){return h.e(this,t,this),this.check()}},{key:"multiplyRight",value:function(t){return h.e(this,this,t),this.check()}},{key:"rotate",value:function(t){return h.f(this,this,t),this.check()}},{key:"scale",value:function(t){return Array.isArray(t)?h.g(this,this,t):h.g(this,this,[t,t,t]),this.check()}},{key:"translate",value:function(t){return h.h(this,this,t),this.check()}},{key:"transform",value:function(t,e){switch(t.length){case 2:e=l.c(e||[-0,-0],t,this);break;case 3:e=d.l(e||[-0,-0,-0],t,this);break;case 4:e=Object(f.d)(e||[-0,-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return Object(c.b)(e,t.length),e}},{key:"transformVector",value:function(t,e){return Object(c.c)("Matrix3.transformVector"),this.transform(t,e)}},{key:"transformVector2",value:function(t,e){return Object(c.c)("Matrix3.transformVector"),this.transform(t,e)}},{key:"transformVector3",value:function(t,e){return Object(c.c)("Matrix3.transformVector"),this.transform(t,e)}}]),r}(u.a)},function(t,e,r){"use strict";r.d(e,"a",(function(){return U}));var n=r(5),i=r(4),s=r(10),o=r(11),a=r(3),u=r(19),c=r(1),f=r(13),h=r(0),l=r(12),d=r(2),y=r(7);function p(){var t=new h.a(4);return h.a!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function b(t,e,r){r*=.5;var n=Math.sin(r);return t[0]=n*e[0],t[1]=n*e[1],t[2]=n*e[2],t[3]=Math.cos(r),t}function g(t,e,r){var n=e[0],i=e[1],s=e[2],o=e[3],a=r[0],u=r[1],c=r[2],f=r[3];return t[0]=n*f+o*a+i*c-s*u,t[1]=i*f+o*u+s*a-n*c,t[2]=s*f+o*c+n*u-i*a,t[3]=o*f-n*a-i*u-s*c,t}function m(t,e,r,n){var i,s,o,a,u,c=e[0],f=e[1],l=e[2],d=e[3],y=r[0],p=r[1],b=r[2],g=r[3];return(s=c*y+f*p+l*b+d*g)<0&&(s=-s,y=-y,p=-p,b=-b,g=-g),1-s>h.b?(i=Math.acos(s),o=Math.sin(i),a=Math.sin((1-n)*i)/o,u=Math.sin(n*i)/o):(a=1-n,u=n),t[0]=a*c+u*y,t[1]=a*f+u*p,t[2]=a*l+u*b,t[3]=a*d+u*g,t}function v(t,e){var r,n=e[0]+e[4]+e[8];if(n>0)r=Math.sqrt(n+1),t[3]=.5*r,r=.5/r,t[0]=(e[5]-e[7])*r,t[1]=(e[6]-e[2])*r,t[2]=(e[1]-e[3])*r;else{var i=0;e[4]>e[0]&&(i=1),e[8]>e[3*i+i]&&(i=2);var s=(i+1)%3,o=(i+2)%3;r=Math.sqrt(e[3*i+i]-e[3*s+s]-e[3*o+o]+1),t[i]=.5*r,r=.5/r,t[3]=(e[3*s+o]-e[3*o+s])*r,t[s]=(e[3*s+i]+e[3*i+s])*r,t[o]=(e[3*o+i]+e[3*i+o])*r}return t}y.b,y.g,y.c,y.l;var w,O,T,E,A,_,I=y.a,k=y.k,S=y.d,N=y.i,j=y.h,R=y.m,x=y.j,M=(y.f,y.e,w=d.b(),O=d.e(1,0,0),T=d.e(0,1,0),function(t,e,r){var n=d.d(e,r);return n<-.999999?(d.c(w,O,e),d.f(w)<1e-6&&d.c(w,T,e),d.h(w,w),b(t,w,Math.PI),t):n>.999999?(t[0]=0,t[1]=0,t[2]=0,t[3]=1,t):(d.c(w,e,r),t[0]=w[0],t[1]=w[1],t[2]=w[2],t[3]=1+n,x(t,t))});E=p(),A=p(),_=l.a();function L(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Object(a.a)(t);if(e){var i=Object(a.a)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Object(o.a)(this,r)}}var P=[0,0,0,1],U=function(t){Object(s.a)(r,t);var e=L(r);function r(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return Object(n.a)(this,r),t=e.call(this,-0,-0,-0,-0),Array.isArray(i)&&1===arguments.length?t.copy(i):t.set(i,s,o,a),t}return Object(i.a)(r,[{key:"copy",value:function(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this.check()}},{key:"set",value:function(t,e,r,n){return this[0]=t,this[1]=e,this[2]=r,this[3]=n,this.check()}},{key:"fromMatrix3",value:function(t){return v(this,t),this.check()}},{key:"identity",value:function(){var t;return(t=this)[0]=0,t[1]=0,t[2]=0,t[3]=1,this.check()}},{key:"fromAxisRotation",value:function(t,e){return b(this,t,e),this.check()}},{key:"setAxisAngle",value:function(t,e){return this.fromAxisRotation(t,e)}},{key:"len",value:function(){return j(this)}},{key:"lengthSquared",value:function(){return R(this)}},{key:"dot",value:function(t,e){if(void 0!==e)throw new Error("Quaternion.dot only takes one argument");return S(this,t)}},{key:"rotationTo",value:function(t,e){return M(this,t,e),this.check()}},{key:"add",value:function(t,e){if(void 0!==e)throw new Error("Quaternion.add only takes one argument");return I(this,this,t),this.check()}},{key:"calculateW",value:function(){var t,e,r,n,i;return t=this,r=(e=this)[0],n=e[1],i=e[2],t[0]=r,t[1]=n,t[2]=i,t[3]=Math.sqrt(Math.abs(1-r*r-n*n-i*i)),this.check()}},{key:"conjugate",value:function(){var t,e;return e=this,(t=this)[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],this.check()}},{key:"invert",value:function(){var t,e,r,n,i,s,o,a;return t=this,r=(e=this)[0],n=e[1],i=e[2],s=e[3],a=(o=r*r+n*n+i*i+s*s)?1/o:0,t[0]=-r*a,t[1]=-n*a,t[2]=-i*a,t[3]=s*a,this.check()}},{key:"lerp",value:function(t,e,r){return N(this,t,e,r),this.check()}},{key:"multiplyRight",value:function(t,e){return Object(f.a)(!e),g(this,this,t),this.check()}},{key:"multiplyLeft",value:function(t,e){return Object(f.a)(!e),g(this,t,this),this.check()}},{key:"normalize",value:function(){var t=this.len(),e=t>0?1/t:0;return this[0]=this[0]*e,this[1]=this[1]*e,this[2]=this[2]*e,this[3]=this[3]*e,0===t&&(this[3]=1),this.check()}},{key:"rotateX",value:function(t){return function(t,e,r){r*=.5;var n=e[0],i=e[1],s=e[2],o=e[3],a=Math.sin(r),u=Math.cos(r);t[0]=n*u+o*a,t[1]=i*u+s*a,t[2]=s*u-i*a,t[3]=o*u-n*a}(this,this,t),this.check()}},{key:"rotateY",value:function(t){return function(t,e,r){r*=.5;var n=e[0],i=e[1],s=e[2],o=e[3],a=Math.sin(r),u=Math.cos(r);t[0]=n*u-s*a,t[1]=i*u+o*a,t[2]=s*u+n*a,t[3]=o*u-i*a}(this,this,t),this.check()}},{key:"rotateZ",value:function(t){return function(t,e,r){r*=.5;var n=e[0],i=e[1],s=e[2],o=e[3],a=Math.sin(r),u=Math.cos(r);t[0]=n*u+i*a,t[1]=i*u-n*a,t[2]=s*u+o*a,t[3]=o*u-s*a}(this,this,t),this.check()}},{key:"scale",value:function(t){return k(this,this,t),this.check()}},{key:"slerp",value:function(t,e,r){switch(arguments.length){case 1:var n=arguments[0],i=n.start;t=void 0===i?P:i,e=n.target,r=n.ratio;break;case 2:var s=Array.prototype.slice.call(arguments);e=s[0],r=s[1],t=this}return m(this,t,e,r),this.check()}},{key:"transformVector4",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;return y.o(e,t,this),Object(c.b)(e,4)}},{key:"lengthSq",value:function(){return this.lengthSquared()}},{key:"setFromAxisAngle",value:function(t,e){return this.setAxisAngle(t,e)}},{key:"premultiply",value:function(t,e){return this.multiplyLeft(t,e)}},{key:"multiply",value:function(t,e){return this.multiplyRight(t,e)}},{key:"ELEMENTS",get:function(){return 4}},{key:"x",get:function(){return this[0]},set:function(t){this[0]=Object(c.a)(t)}},{key:"y",get:function(){return this[1]},set:function(t){this[1]=Object(c.a)(t)}},{key:"z",get:function(){return this[2]},set:function(t){this[2]=Object(c.a)(t)}},{key:"w",get:function(){return this[3]},set:function(t){this[3]=Object(c.a)(t)}}]),r}(u.a)}])}));