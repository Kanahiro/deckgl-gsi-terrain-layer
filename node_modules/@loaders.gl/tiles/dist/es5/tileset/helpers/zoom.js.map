{"version":3,"sources":["../../../../src/tileset/helpers/zoom.js"],"names":["WGS84_RADIUS_X","WGS84_RADIUS_Y","WGS84_RADIUS_Z","scratchVector","Vector3","getZoomFromBoundingVolume","boundingVolume","halfAxes","radius","width","height","getColumn","x","len","y","z","halfX","halfY","halfZ","zoomX","Math","log2","zoomY","zoomZ"],"mappings":";;;;;;;AAAA;;AAEA,IAAMA,cAAc,GAAG,SAAvB;AACA,IAAMC,cAAc,GAAG,SAAvB;AACA,IAAMC,cAAc,GAAG,kBAAvB;AAEA,IAAMC,aAAa,GAAG,IAAIC,aAAJ,EAAtB;;AAEO,SAASC,yBAAT,CAAmCC,cAAnC,EAAmD;AAAA,MACjDC,QADiD,GACdD,cADc,CACjDC,QADiD;AAAA,MACvCC,MADuC,GACdF,cADc,CACvCE,MADuC;AAAA,MAC/BC,KAD+B,GACdH,cADc,CAC/BG,KAD+B;AAAA,MACxBC,MADwB,GACdJ,cADc,CACxBI,MADwB;;AAGxD,MAAIH,QAAJ,EAAc;AAEZA,IAAAA,QAAQ,CAACI,SAAT,CAAmB,CAAnB,EAAsBR,aAAtB;AACA,QAAMS,CAAC,GAAGT,aAAa,CAACU,GAAd,EAAV;AACAN,IAAAA,QAAQ,CAACI,SAAT,CAAmB,CAAnB,EAAsBR,aAAtB;AACA,QAAMW,CAAC,GAAGX,aAAa,CAACU,GAAd,EAAV;AACAN,IAAAA,QAAQ,CAACI,SAAT,CAAmB,CAAnB,EAAsBR,aAAtB;AACA,QAAMY,CAAC,GAAGZ,aAAa,CAACU,GAAd,EAAV;AAEA,QAAMG,KAAK,GAAGJ,CAAC,GAAG,CAAlB;AACA,QAAMK,KAAK,GAAGH,CAAC,GAAG,CAAlB;AACA,QAAMI,KAAK,GAAGH,CAAC,GAAG,CAAlB;AAEA,QAAMI,KAAK,GAAGC,IAAI,CAACC,IAAL,CAAUrB,cAAc,GAAGgB,KAA3B,CAAd;AACA,QAAMM,KAAK,GAAGF,IAAI,CAACC,IAAL,CAAUpB,cAAc,GAAGgB,KAA3B,CAAd;AACA,QAAMM,KAAK,GAAGH,IAAI,CAACC,IAAL,CAAUnB,cAAc,GAAGgB,KAA3B,CAAd;AACA,WAAO,CAACC,KAAK,GAAGG,KAAR,GAAgBC,KAAjB,IAA0B,CAAjC;AACD,GAjBD,MAiBO,IAAIf,MAAJ,EAAY;AAEjB,WAAOY,IAAI,CAACC,IAAL,CAAUnB,cAAc,GAAGM,MAA3B,CAAP;AACD,GAHM,MAGA,IAAIE,MAAM,IAAID,KAAd,EAAqB;AAE1B,QAAMU,MAAK,GAAGC,IAAI,CAACC,IAAL,CAAUrB,cAAc,GAAGS,KAA3B,CAAd;;AACA,QAAMa,MAAK,GAAGF,IAAI,CAACC,IAAL,CAAUpB,cAAc,GAAGS,MAA3B,CAAd;;AAEA,WAAO,CAACS,MAAK,GAAGG,MAAT,IAAkB,CAAzB;AACD;;AAED,SAAO,CAAP;AACD","sourcesContent":["import {Vector3} from '@math.gl/core';\n\nconst WGS84_RADIUS_X = 6378137.0;\nconst WGS84_RADIUS_Y = 6378137.0;\nconst WGS84_RADIUS_Z = 6356752.3142451793;\n\nconst scratchVector = new Vector3();\n\nexport function getZoomFromBoundingVolume(boundingVolume) {\n  const {halfAxes, radius, width, height} = boundingVolume;\n\n  if (halfAxes) {\n    // OrientedBoundingBox\n    halfAxes.getColumn(0, scratchVector);\n    const x = scratchVector.len();\n    halfAxes.getColumn(1, scratchVector);\n    const y = scratchVector.len();\n    halfAxes.getColumn(2, scratchVector);\n    const z = scratchVector.len();\n\n    const halfX = x / 2;\n    const halfY = y / 2;\n    const halfZ = z / 2;\n\n    const zoomX = Math.log2(WGS84_RADIUS_X / halfX);\n    const zoomY = Math.log2(WGS84_RADIUS_Y / halfY);\n    const zoomZ = Math.log2(WGS84_RADIUS_Z / halfZ);\n    return (zoomX + zoomY + zoomZ) / 3;\n  } else if (radius) {\n    // BoundingSphere\n    return Math.log2(WGS84_RADIUS_Z / radius);\n  } else if (height && width) {\n    // BoundingRectangle\n    const zoomX = Math.log2(WGS84_RADIUS_X / width);\n    const zoomY = Math.log2(WGS84_RADIUS_Y / height);\n\n    return (zoomX + zoomY) / 2;\n  }\n\n  return 1;\n}\n"],"file":"zoom.js"}