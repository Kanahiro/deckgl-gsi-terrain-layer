!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var i=e();for(var n in i)("object"==typeof exports?exports:t)[n]=i[n]}}(window,(function(){return function(t){var e={};function i(n){if(e[n])return e[n].exports;var r=e[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}return i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(n,r,function(e){return t[e]}.bind(null,r));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=2)}([function(t,e,i){"use strict";t.exports=r;var n=i(4);function r(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}r.Varint=0,r.Fixed64=1,r.Bytes=2,r.Fixed32=5;var o="undefined"==typeof TextDecoder?null:new TextDecoder("utf8");function s(t){return t.type===r.Bytes?t.readVarint()+t.pos:t.pos+1}function a(t,e,i){return i?4294967296*e+(t>>>0):4294967296*(e>>>0)+(t>>>0)}function u(t,e,i){var n=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));i.realloc(n);for(var r=i.pos-1;r>=t;r--)i.buf[r+n]=i.buf[r]}function h(t,e){for(var i=0;i<t.length;i++)e.writeVarint(t[i])}function f(t,e){for(var i=0;i<t.length;i++)e.writeSVarint(t[i])}function l(t,e){for(var i=0;i<t.length;i++)e.writeFloat(t[i])}function c(t,e){for(var i=0;i<t.length;i++)e.writeDouble(t[i])}function p(t,e){for(var i=0;i<t.length;i++)e.writeBoolean(t[i])}function d(t,e){for(var i=0;i<t.length;i++)e.writeFixed32(t[i])}function y(t,e){for(var i=0;i<t.length;i++)e.writeSFixed32(t[i])}function g(t,e){for(var i=0;i<t.length;i++)e.writeFixed64(t[i])}function w(t,e){for(var i=0;i<t.length;i++)e.writeSFixed64(t[i])}function b(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+16777216*t[e+3]}function x(t,e,i){t[i]=e,t[i+1]=e>>>8,t[i+2]=e>>>16,t[i+3]=e>>>24}function v(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+(t[e+3]<<24)}r.prototype={destroy:function(){this.buf=null},readFields:function(t,e,i){for(i=i||this.length;this.pos<i;){var n=this.readVarint(),r=n>>3,o=this.pos;this.type=7&n,t(r,e,this),this.pos===o&&this.skip(n)}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=b(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=v(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=b(this.buf,this.pos)+4294967296*b(this.buf,this.pos+4);return this.pos+=8,t},readSFixed64:function(){var t=b(this.buf,this.pos)+4294967296*v(this.buf,this.pos+4);return this.pos+=8,t},readFloat:function(){var t=n.read(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=n.read(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var e,i,n=this.buf;return e=127&(i=n[this.pos++]),i<128?e:(e|=(127&(i=n[this.pos++]))<<7,i<128?e:(e|=(127&(i=n[this.pos++]))<<14,i<128?e:(e|=(127&(i=n[this.pos++]))<<21,i<128?e:function(t,e,i){var n,r,o=i.buf;if(r=o[i.pos++],n=(112&r)>>4,r<128)return a(t,n,e);if(r=o[i.pos++],n|=(127&r)<<3,r<128)return a(t,n,e);if(r=o[i.pos++],n|=(127&r)<<10,r<128)return a(t,n,e);if(r=o[i.pos++],n|=(127&r)<<17,r<128)return a(t,n,e);if(r=o[i.pos++],n|=(127&r)<<24,r<128)return a(t,n,e);if(r=o[i.pos++],n|=(1&r)<<31,r<128)return a(t,n,e);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(i=n[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,e=this.pos;return this.pos=t,t-e>=12&&o?function(t,e,i){return o.decode(t.subarray(e,i))}(this.buf,e,t):function(t,e,i){var n="",r=e;for(;r<i;){var o,s,a,u=t[r],h=null,f=u>239?4:u>223?3:u>191?2:1;if(r+f>i)break;1===f?u<128&&(h=u):2===f?128==(192&(o=t[r+1]))&&(h=(31&u)<<6|63&o)<=127&&(h=null):3===f?(o=t[r+1],s=t[r+2],128==(192&o)&&128==(192&s)&&((h=(15&u)<<12|(63&o)<<6|63&s)<=2047||h>=55296&&h<=57343)&&(h=null)):4===f&&(o=t[r+1],s=t[r+2],a=t[r+3],128==(192&o)&&128==(192&s)&&128==(192&a)&&((h=(15&u)<<18|(63&o)<<12|(63&s)<<6|63&a)<=65535||h>=1114112)&&(h=null)),null===h?(h=65533,f=1):h>65535&&(h-=65536,n+=String.fromCharCode(h>>>10&1023|55296),h=56320|1023&h),n+=String.fromCharCode(h),r+=f}return n}(this.buf,e,t)},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e},readPackedVarint:function(t,e){if(this.type!==r.Bytes)return t.push(this.readVarint(e));var i=s(this);for(t=t||[];this.pos<i;)t.push(this.readVarint(e));return t},readPackedSVarint:function(t){if(this.type!==r.Bytes)return t.push(this.readSVarint());var e=s(this);for(t=t||[];this.pos<e;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){if(this.type!==r.Bytes)return t.push(this.readBoolean());var e=s(this);for(t=t||[];this.pos<e;)t.push(this.readBoolean());return t},readPackedFloat:function(t){if(this.type!==r.Bytes)return t.push(this.readFloat());var e=s(this);for(t=t||[];this.pos<e;)t.push(this.readFloat());return t},readPackedDouble:function(t){if(this.type!==r.Bytes)return t.push(this.readDouble());var e=s(this);for(t=t||[];this.pos<e;)t.push(this.readDouble());return t},readPackedFixed32:function(t){if(this.type!==r.Bytes)return t.push(this.readFixed32());var e=s(this);for(t=t||[];this.pos<e;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){if(this.type!==r.Bytes)return t.push(this.readSFixed32());var e=s(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){if(this.type!==r.Bytes)return t.push(this.readFixed64());var e=s(this);for(t=t||[];this.pos<e;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){if(this.type!==r.Bytes)return t.push(this.readSFixed64());var e=s(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed64());return t},skip:function(t){var e=7&t;if(e===r.Varint)for(;this.buf[this.pos++]>127;);else if(e===r.Bytes)this.pos=this.readVarint()+this.pos;else if(e===r.Fixed32)this.pos+=4;else{if(e!==r.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(t,e){this.writeVarint(t<<3|e)},realloc:function(t){for(var e=this.length||16;e<this.pos+t;)e*=2;if(e!==this.length){var i=new Uint8Array(e);i.set(this.buf),this.buf=i,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),x(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),x(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),x(this.buf,-1&t,this.pos),x(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),x(this.buf,-1&t,this.pos),x(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(t){(t=+t||0)>268435455||t<0?function(t,e){var i,n;t>=0?(i=t%4294967296|0,n=t/4294967296|0):(n=~(-t/4294967296),4294967295^(i=~(-t%4294967296))?i=i+1|0:(i=0,n=n+1|0));if(t>=0x10000000000000000||t<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");e.realloc(10),function(t,e,i){i.buf[i.pos++]=127&t|128,t>>>=7,i.buf[i.pos++]=127&t|128,t>>>=7,i.buf[i.pos++]=127&t|128,t>>>=7,i.buf[i.pos++]=127&t|128,t>>>=7,i.buf[i.pos]=127&t}(i,0,e),function(t,e){var i=(7&t)<<4;if(e.buf[e.pos++]|=i|((t>>>=3)?128:0),!t)return;if(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),!t)return;if(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),!t)return;if(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),!t)return;if(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),!t)return;e.buf[e.pos++]=127&t}(n,e)}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var e=this.pos;this.pos=function(t,e,i){for(var n,r,o=0;o<e.length;o++){if((n=e.charCodeAt(o))>55295&&n<57344){if(!r){n>56319||o+1===e.length?(t[i++]=239,t[i++]=191,t[i++]=189):r=n;continue}if(n<56320){t[i++]=239,t[i++]=191,t[i++]=189,r=n;continue}n=r-55296<<10|n-56320|65536,r=null}else r&&(t[i++]=239,t[i++]=191,t[i++]=189,r=null);n<128?t[i++]=n:(n<2048?t[i++]=n>>6|192:(n<65536?t[i++]=n>>12|224:(t[i++]=n>>18|240,t[i++]=n>>12&63|128),t[i++]=n>>6&63|128),t[i++]=63&n|128)}return i}(this.buf,t,this.pos);var i=this.pos-e;i>=128&&u(e,i,this),this.pos=e-1,this.writeVarint(i),this.pos+=i},writeFloat:function(t){this.realloc(4),n.write(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),n.write(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var i=0;i<e;i++)this.buf[this.pos++]=t[i]},writeRawMessage:function(t,e){this.pos++;var i=this.pos;t(e,this);var n=this.pos-i;n>=128&&u(i,n,this),this.pos=i-1,this.writeVarint(n),this.pos+=n},writeMessage:function(t,e,i){this.writeTag(t,r.Bytes),this.writeRawMessage(e,i)},writePackedVarint:function(t,e){e.length&&this.writeMessage(t,h,e)},writePackedSVarint:function(t,e){e.length&&this.writeMessage(t,f,e)},writePackedBoolean:function(t,e){e.length&&this.writeMessage(t,p,e)},writePackedFloat:function(t,e){e.length&&this.writeMessage(t,l,e)},writePackedDouble:function(t,e){e.length&&this.writeMessage(t,c,e)},writePackedFixed32:function(t,e){e.length&&this.writeMessage(t,d,e)},writePackedSFixed32:function(t,e){e.length&&this.writeMessage(t,y,e)},writePackedFixed64:function(t,e){e.length&&this.writeMessage(t,g,e)},writePackedSFixed64:function(t,e){e.length&&this.writeMessage(t,w,e)},writeBytesField:function(t,e){this.writeTag(t,r.Bytes),this.writeBytes(e)},writeFixed32Field:function(t,e){this.writeTag(t,r.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(t,e){this.writeTag(t,r.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(t,e){this.writeTag(t,r.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(t,e){this.writeTag(t,r.Fixed64),this.writeSFixed64(e)},writeVarintField:function(t,e){this.writeTag(t,r.Varint),this.writeVarint(e)},writeSVarintField:function(t,e){this.writeTag(t,r.Varint),this.writeSVarint(e)},writeStringField:function(t,e){this.writeTag(t,r.Bytes),this.writeString(e)},writeFloatField:function(t,e){this.writeTag(t,r.Fixed32),this.writeFloat(e)},writeDoubleField:function(t,e){this.writeTag(t,r.Fixed64),this.writeDouble(e)},writeBooleanField:function(t,e){this.writeVarintField(t,Boolean(e))}}},function(t,e,i){"use strict";function n(t,e){this.x=t,this.y=e}t.exports=n,n.prototype={clone:function(){return new n(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,e){return this.clone()._rotateAround(t,e)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var e=t.x-this.x,i=t.y-this.y;return e*e+i*i},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,e){return Math.atan2(this.x*e-this.y*t,this.x*t+this.y*e)},_matMult:function(t){var e=t[0]*this.x+t[1]*this.y,i=t[2]*this.x+t[3]*this.y;return this.x=e,this.y=i,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var e=Math.cos(t),i=Math.sin(t),n=e*this.x-i*this.y,r=i*this.x+e*this.y;return this.x=n,this.y=r,this},_rotateAround:function(t,e){var i=Math.cos(t),n=Math.sin(t),r=e.x+i*(this.x-e.x)-n*(this.y-e.y),o=e.y+n*(this.x-e.x)+i*(this.y-e.y);return this.x=r,this.y=o,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},n.convert=function(t){return t instanceof n?t:Array.isArray(t)?new n(t[0],t[1]):t}},function(t,e,i){(function(e){const n=i(5),r="undefined"==typeof window?e:window;r.loaders=r.loaders||{},t.exports=Object.assign(r.loaders,n)}).call(this,i(3))},function(t,e){var i;i=function(){return this}();try{i=i||new Function("return this")()}catch(t){"object"==typeof window&&(i=window)}t.exports=i},function(t,e){e.read=function(t,e,i,n,r){var o,s,a=8*r-n-1,u=(1<<a)-1,h=u>>1,f=-7,l=i?r-1:0,c=i?-1:1,p=t[e+l];for(l+=c,o=p&(1<<-f)-1,p>>=-f,f+=a;f>0;o=256*o+t[e+l],l+=c,f-=8);for(s=o&(1<<-f)-1,o>>=-f,f+=n;f>0;s=256*s+t[e+l],l+=c,f-=8);if(0===o)o=1-h;else{if(o===u)return s?NaN:1/0*(p?-1:1);s+=Math.pow(2,n),o-=h}return(p?-1:1)*s*Math.pow(2,o-n)},e.write=function(t,e,i,n,r,o){var s,a,u,h=8*o-r-1,f=(1<<h)-1,l=f>>1,c=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,p=n?0:o-1,d=n?1:-1,y=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=f):(s=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-s))<1&&(s--,u*=2),(e+=s+l>=1?c/u:c*Math.pow(2,1-l))*u>=2&&(s++,u/=2),s+l>=f?(a=0,s=f):s+l>=1?(a=(e*u-1)*Math.pow(2,r),s+=l):(a=e*Math.pow(2,l-1)*Math.pow(2,r),s=0));r>=8;t[i+p]=255&a,p+=d,a/=256,r-=8);for(s=s<<r|a,h+=r;h>0;t[i+p]=255&s,p+=d,s/=256,h-=8);t[i+p-d]|=128*y}},function(t,e,i){"use strict";i.r(e),i.d(e,"MVTLoader",(function(){return U}));var n=i(1),r=i.n(n);class o{static get types(){return["Unknown","Point","LineString","Polygon"]}constructor(t,e,i,n,r){this.properties={},this.extent=i,this.type=0,this._pbf=t,this._geometry=-1,this._keys=n,this._values=r,t.readFields(a,this,e)}loadGeometry(){const t=this._pbf;t.pos=this._geometry;const e=t.readVarint()+t.pos;let i=1,n=0,o=0,s=0;const a=[];let u;for(;t.pos<e;){if(n<=0){const e=t.readVarint();i=7&e,n=e>>3}if(n--,1===i||2===i)o+=t.readSVarint(),s+=t.readSVarint(),1===i&&(u&&a.push(u),u=[]),u.push(new r.a(o,s));else{if(7!==i)throw new Error("unknown command "+i);u&&u.push(u[0].clone())}}return u&&a.push(u),a}bbox(){const t=this._pbf;t.pos=this._geometry;const e=t.readVarint()+t.pos;let i=1,n=0,r=0,o=0,s=1/0,a=-1/0,u=1/0,h=-1/0;for(;t.pos<e;){if(n<=0){const e=t.readVarint();i=7&e,n=e>>3}if(n--,1===i||2===i)r+=t.readSVarint(),o+=t.readSVarint(),r<s&&(s=r),r>a&&(a=r),o<u&&(u=o),o>h&&(h=o);else if(7!==i)throw new Error("unknown command "+i)}return[s,u,a,h]}toGeoJSON(t,e,i){const n=this.extent*Math.pow(2,i),r=this.extent*t,a=this.extent*e;let u,h,f=this.loadGeometry(),l=o.types[this.type];function c(t){for(let e=0;e<t.length;e++){const i=t[e],o=180-360*(i.y+a)/n;t[e]=[360*(i.x+r)/n-180,360/Math.PI*Math.atan(Math.exp(o*Math.PI/180))-90]}}switch(this.type){case 1:var p=[];for(u=0;u<f.length;u++)p[u]=f[u][0];f=p,c(f);break;case 2:for(u=0;u<f.length;u++)c(f[u]);break;case 3:for(f=function(t){const e=t.length;if(e<=1)return[t];const i=[];let n,r;for(let o=0;o<e;o++){const e=s(t[o]);0!==e&&(void 0===r&&(r=e<0),r===e<0?(n&&i.push(n),n=[t[o]]):n.push(t[o]))}n&&i.push(n);return i}(f),u=0;u<f.length;u++)for(h=0;h<f[u].length;h++)c(f[u][h])}1===f.length?f=f[0]:l="Multi"+l;return{type:"Feature",geometry:{type:l,coordinates:f},properties:this.properties}}}function s(t){let e=0;for(let i,n,r=0,o=t.length-1;r<t.length;o=r++)i=t[r],n=t[o],e+=(n.x-i.x)*(i.y+n.y);return e}function a(t,e,i){1===t?e.id=i.readVarint():2===t?function(t,e){const i=t.readVarint()+t.pos;for(;t.pos<i;){const i=e._keys[t.readVarint()],n=e._values[t.readVarint()];e.properties[i]=n}}(i,e):3===t?e.type=i.readVarint():4===t&&(e._geometry=i.pos)}class u{constructor(t,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(h,this,e),this.length=this._features.length}feature(t){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];const e=this._pbf.readVarint()+this._pbf.pos;return new o(this._pbf,e,this.extent,this._keys,this._values)}}function h(t,e,i){15===t?e.version=i.readVarint():1===t?e.name=i.readString():5===t?e.extent=i.readVarint():2===t?e._features.push(i.pos):3===t?e._keys.push(i.readString()):4===t&&e._values.push(function(t){let e=null;const i=t.readVarint()+t.pos;for(;t.pos<i;){const i=t.readVarint()>>3;e=1===i?t.readString():2===i?t.readFloat():3===i?t.readDouble():4===i?t.readVarint64():5===i?t.readVarint():6===i?t.readSVarint():7===i?t.readBoolean():null}return e}(i))}class f{constructor(t,e){this.layers=t.readFields(l,{},e)}}function l(t,e,i){if(3===t){const t=new u(i,i.readVarint()+i.pos);t.length&&(e[t.name]=t)}}function c(t){let e=0,i=0,n=0,r=0,o=0,s=0,a=0,u=0,h=0;const f=new Set,l={};for(const p of t){const t=p.geometry;switch(t.type){case"Point":i++,e++,f.add(t.coordinates.length);break;case"MultiPoint":i++,e+=t.coordinates.length;for(const e of t.coordinates)f.add(e.length);break;case"LineString":o++,n+=t.coordinates.length,r++;for(const e of t.coordinates)f.add(e.length);break;case"MultiLineString":o++;for(const e of t.coordinates){n+=e.length,r++;for(const t of e)f.add(t.length)}break;case"Polygon":h++,a++,u+=t.coordinates.length,s+=m(t.coordinates).length;for(const e of m(t.coordinates))f.add(e.length);break;case"MultiPolygon":h++;for(const e of t.coordinates){a++,u+=e.length,s+=m(e).length;for(const t of m(e))f.add(t.length)}break;default:throw new Error("Unsupported geometry type: "+t.type)}if(p.properties)for(const t in p.properties){const e=p.properties[t];l[t]=l[t]||void 0===l[t]?(c=e,Number.isFinite(c)):l[t]}}var c;return{pointPositionsCount:e,pointFeaturesCount:i,linePositionsCount:n,linePathsCount:r,lineFeaturesCount:o,coordLength:Math.max(...f),polygonPositionsCount:s,polygonObjectsCount:a,polygonRingsCount:u,polygonFeaturesCount:h,numericPropKeys:Object.keys(l).filter(t=>l[t])}}function p(t,e={},i={}){const{pointPositionsCount:n,pointFeaturesCount:r,linePositionsCount:o,linePathsCount:s,lineFeaturesCount:a,polygonPositionsCount:u,polygonObjectsCount:h,polygonRingsCount:f,polygonFeaturesCount:l}=e,{coordLength:c,numericPropKeys:p,PositionDataType:v=Float32Array}=i,P=t.length>65535?Uint32Array:Uint16Array,m={positions:new v(n*c),globalFeatureIds:new P(n),featureIds:r>65535?new Uint32Array(n):new Uint16Array(n),numericProps:{},properties:[]},M={pathIndices:o>65535?new Uint32Array(s+1):new Uint16Array(s+1),positions:new v(o*c),globalFeatureIds:new P(o),featureIds:a>65535?new Uint32Array(o):new Uint16Array(o),numericProps:{},properties:[]},V={polygonIndices:u>65535?new Uint32Array(h+1):new Uint16Array(h+1),primitivePolygonIndices:u>65535?new Uint32Array(f+1):new Uint16Array(f+1),positions:new v(u*c),globalFeatureIds:new P(u),featureIds:l>65535?new Uint32Array(u):new Uint16Array(u),numericProps:{},properties:[]};for(const t of[m,M,V])for(const e of p)t.numericProps[e]=new Float32Array(t.positions.length/c);M.pathIndices[s]=o,V.polygonIndices[h]=u,V.primitivePolygonIndices[f]=u;const S={pointPosition:0,pointFeature:0,linePosition:0,linePath:0,lineFeature:0,polygonPosition:0,polygonObject:0,polygonRing:0,polygonFeature:0,feature:0};for(const e of t){const t=e.geometry,i=e.properties;switch(t.type){case"Point":d(t.coordinates,m,S,c,i),m.properties.push(F(i,p)),S.pointFeature++;break;case"MultiPoint":y(t.coordinates,m,S,c,i),m.properties.push(F(i,p)),S.pointFeature++;break;case"LineString":g(t.coordinates,M,S,c,i),M.properties.push(F(i,p)),S.lineFeature++;break;case"MultiLineString":w(t.coordinates,M,S,c,i),M.properties.push(F(i,p)),S.lineFeature++;break;case"Polygon":b(t.coordinates,V,S,c,i),V.properties.push(F(i,p)),S.polygonFeature++;break;case"MultiPolygon":x(t.coordinates,V,S,c,i),V.properties.push(F(i,p)),S.polygonFeature++;break;default:throw new Error("Invalid geometry type")}S.feature++}return function(t,e,i,n){const r={points:{positions:{value:t.positions,size:n},globalFeatureIds:{value:t.globalFeatureIds,size:1},featureIds:{value:t.featureIds,size:1},numericProps:t.numericProps,properties:t.properties},lines:{pathIndices:{value:e.pathIndices,size:1},positions:{value:e.positions,size:n},globalFeatureIds:{value:e.globalFeatureIds,size:1},featureIds:{value:e.featureIds,size:1},numericProps:e.numericProps,properties:e.properties},polygons:{polygonIndices:{value:i.polygonIndices,size:1},primitivePolygonIndices:{value:i.primitivePolygonIndices,size:1},positions:{value:i.positions,size:n},globalFeatureIds:{value:i.globalFeatureIds,size:1},featureIds:{value:i.featureIds,size:1},numericProps:i.numericProps,properties:i.properties}};for(const t in r)for(const e in r[t].numericProps)r[t].numericProps[e]={value:r[t].numericProps[e],size:1};return r}(m,M,V,c)}function d(t,e,i,n,r){e.positions.set(t,i.pointPosition*n),e.globalFeatureIds[i.pointPosition]=i.feature,e.featureIds[i.pointPosition]=i.pointFeature,v(e,r,i.pointPosition,1),i.pointPosition++}function y(t,e,i,n,r){for(const o of t)d(o,e,i,n,r)}function g(t,e,i,n,r){e.pathIndices[i.linePath]=i.linePosition,i.linePath++,P(e.positions,t,i.linePosition,n);const o=t.length;v(e,r,i.linePosition,o),e.globalFeatureIds.set(new Uint32Array(o).fill(i.feature),i.linePosition),e.featureIds.set(new Uint32Array(o).fill(i.lineFeature),i.linePosition),i.linePosition+=o}function w(t,e,i,n,r){for(const o of t)g(o,e,i,n,r)}function b(t,e,i,n,r){e.polygonIndices[i.polygonObject]=i.polygonPosition,i.polygonObject++;for(const o of t){e.primitivePolygonIndices[i.polygonRing]=i.polygonPosition,i.polygonRing++,P(e.positions,o,i.polygonPosition,n);const t=o.length;v(e,r,i.polygonPosition,t),e.globalFeatureIds.set(new Uint32Array(t).fill(i.feature),i.polygonPosition),e.featureIds.set(new Uint32Array(t).fill(i.polygonFeature),i.polygonPosition),i.polygonPosition+=t}}function x(t,e,i,n,r){for(const o of t)b(o,e,i,n,r)}function v(t,e,i,n){for(const r in t.numericProps)r in e&&t.numericProps[r].set(new Array(n).fill(e[r]),i)}function F(t,e){for(const i in t)e.includes(i)&&delete t[i];return t}function P(t,e,i,n){let r=i*n;for(const i of e)t.set(i,r),r+=n}function m(t){return[].concat(...t)}var M=i(0),V=i.n(M);const S=["Unknown","Point","LineString","Polygon"];function _(t,e){for(let i=0;i<t.length;i++){const n=t[i];t[i]=[n.x/e.extent,n.y/e.extent]}}function k(t,e=((t,e)=>t)){const i=S[t.type];let n=t.loadGeometry();switch(t.type){case 1:const i=[];for(let t=0;t<n.length;t++)i[t]=n[t][0];n=i,e(n,t);break;case 2:for(let i=0;i<n.length;i++)e(n[i],t);break;case 3:n=function(t){const e=t.length;if(e<=1)return[t];const i=[];let n,r;for(let o=0;o<e;o++){const e=I(t[o]);0!==e&&(void 0===r&&(r=e<0),r===e<0?(n&&i.push(n),n=[t[o]]):n&&n.push(t[o]))}n&&i.push(n);return i}(n);for(let i=0;i<n.length;i++)for(let r=0;r<n[i].length;r++)e(n[i][r],t)}return function(t,e,i){let n=t;1===i.length?i=i[0]:n="Multi"+t;const r={type:"Feature",geometry:{type:n,coordinates:i},properties:e.properties||{}};"id"in e&&(r.id=e.id);return r}(i,t,n)}function I(t){const e=t.length;let i,n,r=0;for(let o=0,s=e-1;o<e;s=o++)i=t[o],n=t[s],r+=(n.x-i.x)*(i.y+n.y);return r}function B(t,e){if((e=e||{}).mvt=e.mvt||{},e.gis=e.gis||{},0===t.byteLength)return[];const i=new f(new V.a(t)),n=e.mvt,r=[];if((Array.isArray(n.layers)?n.layers:Object.keys(i.layers)).forEach(t=>{const e=i.layers[t],o={...n,layerName:t};if(e)for(let t=0;t<e.length;t++){const i=A(e.feature(t),o);r.push(i)}}),"binary"===e.gis.format){const e=function(t,e={}){const i=c(t);return p(t,i,{coordLength:e.coordLength||i.coordLength,numericPropKeys:e.numericPropKeys||i.numericPropKeys,PositionDataType:e.PositionDataType||Float32Array})}(r);return e.byteLength=t.byteLength,e}return r}function A(t,e={}){const i="wgs84"===e.coordinates,n=e.tileIndex&&Number.isFinite(e.tileIndex.x)&&Number.isFinite(e.tileIndex.y)&&Number.isFinite(e.tileIndex.z);if(i&&!n)throw new Error("MVT Loader: WGS84 coordinates need tileIndex property. Check documentation.");const r=i&&n?t.toGeoJSON(e.tileIndex.x,e.tileIndex.y,e.tileIndex.z):k(t,_);return e.layerProperty&&(r.properties[e.layerProperty]=e.layerName),r}const U={...{id:"mvt",name:"Mapbox Vector Tile",version:"2.3.1",extensions:["mvt"],mimeTypes:["application/x-protobuf"],category:"geometry",options:{mvt:{coordinates:"local",layerProperty:"layerName",layers:null,tileIndex:null,_format:"geojson",workerUrl:"https://unpkg.com/@loaders.gl/mvt@2.3.1/dist/mvt-loader.worker.js"}}},parse:async(t,e)=>B(t,e),parseSync:B,binary:!0}}])}));