{"version":3,"sources":["../../src/draco-writer.js"],"names":["loadDracoEncoderModule","DRACOBuilder","name","extensions","encode","options","draco","pointcloud","data","dracoOptions","dracoBuilder","encodeSync","destroy"],"mappings":"AAAA,SAAQA,sBAAR,QAAqC,2BAArC;AACA,OAAOC,YAAP,MAAyB,qBAAzB;AAEA,eAAe;AACbC,EAAAA,IAAI,EAAE,OADO;AAEbC,EAAAA,UAAU,EAAE,CAAC,KAAD,CAFC;AAGbC,EAAAA,MAHa;AAIbC,EAAAA,OAAO,EAAE;AACPC,IAAAA,KAAK,EAAE;AACLC,MAAAA,UAAU,EAAE;AADP;AADA;AAJI,CAAf;;AAiBA,eAAeH,MAAf,CAAsBI,IAAtB,EAA4BH,OAA5B,EAAqC;AAEnC,QAAMI,YAAY,GAAIJ,OAAO,IAAIA,OAAO,CAACC,KAApB,IAA8BD,OAA9B,IAAyC,EAA9D;AAGA,QAAM;AAACC,IAAAA;AAAD,MAAU,MAAMN,sBAAsB,CAACK,OAAO,IAAI,EAAZ,CAA5C;AACA,QAAMK,YAAY,GAAG,IAAIT,YAAJ,CAAiBK,KAAjB,CAArB;;AAEA,MAAI;AACF,WAAOI,YAAY,CAACC,UAAb,CAAwBH,IAAxB,EAA8BC,YAA9B,CAAP;AACD,GAFD,SAEU;AACRC,IAAAA,YAAY,CAACE,OAAb;AACD;AACF","sourcesContent":["import {loadDracoEncoderModule} from './lib/draco-module-loader';\nimport DRACOBuilder from './lib/draco-builder';\n\nexport default {\n  name: 'DRACO',\n  extensions: ['drc'],\n  encode,\n  options: {\n    draco: {\n      pointcloud: false // Set to true if pointcloud (mode: 0, no indices)\n      // Draco Compression Parameters\n      // method: 'MESH_EDGEBREAKER_ENCODING',\n      // speed: [5, 5],\n      // quantization: {\n      //   POSITION: 10\n      // }\n    }\n  }\n};\n\nasync function encode(data, options) {\n  // DEPRECATED - remove support for options\n  const dracoOptions = (options && options.draco) || options || {};\n\n  // Dynamically load draco\n  const {draco} = await loadDracoEncoderModule(options || {});\n  const dracoBuilder = new DRACOBuilder(draco);\n\n  try {\n    return dracoBuilder.encodeSync(data, dracoOptions);\n  } finally {\n    dracoBuilder.destroy();\n  }\n}\n"],"file":"draco-writer.js"}